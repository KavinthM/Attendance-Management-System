{"ast":null,"code":"import React,{useEffect,useState,useMemo}from\"react\";import Layout from\"../components/Layout\";import{getAllAttendance,deleteAttendance,updateAttendance,notifyParentsForAbsents}from\"../api/client\";import{STATUS_OPTIONS}from\"../utils/statusOptions\";import dayjs from\"dayjs\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const AttendanceRecords=()=>{const[records,setRecords]=useState([]);const[loading,setLoading]=useState(true);const[editingId,setEditingId]=useState(null);const[editStatus,setEditStatus]=useState(\"\");const[saving,setSaving]=useState(false);// Search and filter states\nconst[searchTerm,setSearchTerm]=useState(\"\");const[dateFilter,setDateFilter]=useState(\"\");const[monthFilter,setMonthFilter]=useState(\"\");const[statusFilter,setStatusFilter]=useState(\"\");const[sectionFilter,setSectionFilter]=useState(\"\");// Notification states\nconst[notifying,setNotifying]=useState(false);const[notifiedRecords,setNotifiedRecords]=useState(new Set());const load=async()=>{setLoading(true);try{const{data}=await getAllAttendance();setRecords(data.records||[]);}finally{setLoading(false);}};useEffect(()=>{load();},[]);// Filter records based on search criteria\nconst filteredRecords=useMemo(()=>{let filtered=[...records];// Filter by search term (name or index)\nif(searchTerm.trim()){const term=searchTerm.toLowerCase().trim();filtered=filtered.filter(record=>{var _record$student,_record$student$name,_record$student2,_record$student2$std_;return((_record$student=record.student)===null||_record$student===void 0?void 0:(_record$student$name=_record$student.name)===null||_record$student$name===void 0?void 0:_record$student$name.toLowerCase().includes(term))||((_record$student2=record.student)===null||_record$student2===void 0?void 0:(_record$student2$std_=_record$student2.std_index)===null||_record$student2$std_===void 0?void 0:_record$student2$std_.toLowerCase().includes(term));});}// Filter by date\nif(dateFilter){filtered=filtered.filter(record=>dayjs(record.date).format(\"YYYY-MM-DD\")===dateFilter);}// Filter by month\nif(monthFilter){filtered=filtered.filter(record=>dayjs(record.date).format(\"YYYY-MM\")===monthFilter);}// Filter by status\nif(statusFilter){filtered=filtered.filter(record=>record.status===statusFilter);}// Filter by section\nif(sectionFilter){filtered=filtered.filter(record=>{var _record$student3;return((_record$student3=record.student)===null||_record$student3===void 0?void 0:_record$student3.section)===sectionFilter;});}return filtered;},[records,searchTerm,dateFilter,monthFilter,statusFilter,sectionFilter]);// Get current date records that are absent/late and not yet notified\nconst currentDateAbsentLateRecords=useMemo(()=>{const today=dayjs().format(\"YYYY-MM-DD\");return records.filter(record=>dayjs(record.date).format(\"YYYY-MM-DD\")===today&&(record.status===\"Absent\"||record.status===\"Late\")&&!record.notifiedParent&&!notifiedRecords.has(record._id));},[records,notifiedRecords]);const remove=async id=>{if(!window.confirm(\"Delete this record?\"))return;await deleteAttendance(id);await load();};const startEdit=record=>{setEditingId(record._id);setEditStatus(record.status||\"Present\");};const cancelEdit=()=>{setEditingId(null);setEditStatus(\"\");};const saveEdit=async id=>{setSaving(true);try{await updateAttendance(id,{status:editStatus});await load();cancelEdit();}catch(e){var _e$response,_e$response$data;alert((e===null||e===void 0?void 0:(_e$response=e.response)===null||_e$response===void 0?void 0:(_e$response$data=_e$response.data)===null||_e$response$data===void 0?void 0:_e$response$data.message)||\"Failed to update record\");}finally{setSaving(false);}};const clearFilters=()=>{setSearchTerm(\"\");setDateFilter(\"\");setMonthFilter(\"\");setStatusFilter(\"\");setSectionFilter(\"\");};const hasActiveFilters=searchTerm||dateFilter||monthFilter||statusFilter||sectionFilter;// Generate text report from data\nconst generateTextReport=data=>{let report='';report+='='.repeat(50)+'\\n';report+=\"           \".concat(data.title,\"\\n\");report+='='.repeat(50)+'\\n';report+=\"Generated on: \".concat(data.generatedOn,\"\\n\\n\");// Filters applied\nif(data.filters&&Object.keys(data.filters).some(key=>data.filters[key])){report+='Filters Applied:\\n';report+='-'.repeat(20)+'\\n';if(data.filters.searchTerm)report+=\"Search: \".concat(data.filters.searchTerm,\"\\n\");if(data.filters.dateFilter)report+=\"Date: \".concat(data.filters.dateFilter,\"\\n\");if(data.filters.monthFilter)report+=\"Month: \".concat(data.filters.monthFilter,\"\\n\");if(data.filters.statusFilter)report+=\"Status: \".concat(data.filters.statusFilter,\"\\n\");if(data.filters.sectionFilter)report+=\"Section: \".concat(data.filters.sectionFilter,\"\\n\");report+='\\n';}// Statistics\nreport+='Statistics:\\n';report+='-'.repeat(20)+'\\n';report+=\"Total Records: \".concat(data.statistics.totalRecords,\"\\n\");report+=\"Present: \".concat(data.statistics.present,\"\\n\");report+=\"Absent: \".concat(data.statistics.absent,\"\\n\");report+=\"Late: \".concat(data.statistics.late,\"\\n\");report+=\"Excused: \".concat(data.statistics.excused,\"\\n\");report+=\"Attendance Rate: \".concat(data.statistics.attendancePercentage,\"%\\n\\n\");// Records\nreport+='Records:\\n';report+='-'.repeat(20)+'\\n';data.records.forEach((record,index)=>{var _record$student4,_record$student5,_record$student6;report+=\"\".concat(index+1,\". \").concat(((_record$student4=record.student)===null||_record$student4===void 0?void 0:_record$student4.name)||'Unknown',\" (\").concat(((_record$student5=record.student)===null||_record$student5===void 0?void 0:_record$student5.std_index)||'N/A',\")\\n\");report+=\"   Section: \".concat(((_record$student6=record.student)===null||_record$student6===void 0?void 0:_record$student6.section)||'N/A',\"\\n\");report+=\"   Status: \".concat(record.status,\"\\n\");report+=\"   Date: \".concat(new Date(record.date).toLocaleDateString(),\"\\n\");report+='\\n';});report+='='.repeat(50)+'\\n';report+='End of Report\\n';report+='='.repeat(50)+'\\n';return report;};// Download functionality\nconst downloadReport=async()=>{try{// Check if there are records to download\nif(filteredRecords.length===0){alert('No records to download. Please adjust your filters or add some attendance records first.');return;}console.log('Downloading report with:',{recordCount:filteredRecords.length,filters:{searchTerm:searchTerm||null,dateFilter:dateFilter||null,monthFilter:monthFilter||null,statusFilter:statusFilter||null,sectionFilter:sectionFilter||null}});const response=await fetch('http://localhost:5002/reports/generate',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({filters:{searchTerm:searchTerm||null,dateFilter:dateFilter||null,monthFilter:monthFilter||null,statusFilter:statusFilter||null,sectionFilter:sectionFilter||null},records:filteredRecords})});if(!response.ok){const errorData=await response.json().catch(()=>({}));throw new Error(errorData.message||\"Server error: \".concat(response.status));}// Check if response is a PDF\nconst contentType=response.headers.get('content-type');if(contentType&&contentType.includes('application/pdf')){const blob=await response.blob();// Check if blob is empty\nif(blob.size===0){throw new Error('Received empty PDF file. Please try again.');}const url=window.URL.createObjectURL(blob);const a=document.createElement('a');a.style.display='none';a.href=url;// Generate filename based on filters\nlet filename='attendance_report';if(monthFilter){filename=\"attendance_report_\".concat(monthFilter);}else if(dateFilter){filename=\"attendance_report_\".concat(dateFilter);}else if(hasActiveFilters){filename='attendance_report_filtered';}filename+='.pdf';a.download=filename;document.body.appendChild(a);a.click();window.URL.revokeObjectURL(url);document.body.removeChild(a);console.log('PDF downloaded successfully:',filename);return;}// If it's JSON (fallback)\nif(contentType&&contentType.includes('application/json')){const data=await response.json();console.log('Received JSON response (fallback):',data);// Create a simple text report as fallback\nconst reportText=generateTextReport(data.data);// Create and download text file\nconst blob=new Blob([reportText],{type:'text/plain'});const url=window.URL.createObjectURL(blob);const a=document.createElement('a');a.style.display='none';a.href=url;// Generate filename based on filters\nlet filename='attendance_report';if(monthFilter){filename=\"attendance_report_\".concat(monthFilter);}else if(dateFilter){filename=\"attendance_report_\".concat(dateFilter);}else if(hasActiveFilters){filename='attendance_report_filtered';}filename+='.txt';a.download=filename;document.body.appendChild(a);a.click();window.URL.revokeObjectURL(url);document.body.removeChild(a);console.log('Text report downloaded successfully (fallback):',filename);return;}// If neither PDF nor JSON\nconst errorText=await response.text();console.error('Unexpected response type:',contentType,errorText);throw new Error('Server returned unexpected response type. Please check server logs.');}catch(error){console.error('Download error:',error);alert(\"Failed to download report: \".concat(error.message,\"\\n\\nPlease check that the backend server is running and try again.\"));}};// Get button text based on filters\nconst getDownloadButtonText=()=>{if(monthFilter){return\"Download \".concat(dayjs(monthFilter).format('MMMM YYYY'),\" Report\");}else if(hasActiveFilters){return'Download Selected Range Report';}else{return'Download Current Report';}};// Notify parents for current date absent/late students\nconst notifyParentsForCurrentDate=async()=>{if(currentDateAbsentLateRecords.length===0){alert(\"No absent or late students found for today.\");return;}setNotifying(true);try{const items=currentDateAbsentLateRecords.map(record=>({studentId:record.student._id,status:record.status,date:dayjs(record.date).format(\"YYYY-MM-DD\")}));console.log(\"Sending notifications for:\",items);const{data}=await notifyParentsForAbsents(items);const succeeded=Array.isArray(data===null||data===void 0?void 0:data.succeeded)?data.succeeded:[];const failed=Array.isArray(data===null||data===void 0?void 0:data.failed)?data.failed:[];if(succeeded.length>0){// Mark records as notified locally\nconst newNotifiedSet=new Set(notifiedRecords);currentDateAbsentLateRecords.forEach(record=>{if(succeeded.includes(record.student._id)){newNotifiedSet.add(record._id);}});setNotifiedRecords(newNotifiedSet);// Update the records in the database\nawait Promise.all(currentDateAbsentLateRecords.filter(record=>succeeded.includes(record.student._id)).map(record=>updateAttendance(record._id,{notifiedParent:true})));alert(\"Successfully notified \".concat(succeeded.length,\" parent(s) for today's absent/late students.\"));}if(failed.length>0){const names=failed.map(f=>{const record=currentDateAbsentLateRecords.find(r=>r.student._id===f.studentId);return record?\"\".concat(record.student.name,\" (\").concat(record.student.parentPhoneNum,\")\"):f.studentId;}).join(\", \");alert(\"Failed to notify: \".concat(names,\"\\n\\nPlease check phone numbers and try again.\"));}}catch(e){var _e$response2,_e$response2$data;console.error(\"Notification error:\",e);alert((e===null||e===void 0?void 0:(_e$response2=e.response)===null||_e$response2===void 0?void 0:(_e$response2$data=_e$response2.data)===null||_e$response2$data===void 0?void 0:_e$response2$data.message)||\"Failed to send notifications. Please check your Twilio configuration.\");}finally{setNotifying(false);}};return/*#__PURE__*/_jsxs(Layout,{children:[/*#__PURE__*/_jsx(\"div\",{style:{textAlign:\"center\",marginTop:12},children:/*#__PURE__*/_jsx(\"h1\",{style:{margin:0},children:\"Attendance Records\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"panel\",style:{marginTop:16,marginBottom:16},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"column\",gap:16},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"grid\",gridTemplateColumns:\"repeat(auto-fit, minmax(200px, 1fr))\",gap:12,alignItems:\"end\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field\",style:{flex:1,minWidth:200},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Search by Name or Index\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter name or index number...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),style:{marginBottom:0}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",style:{flex:1,minWidth:150},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Filter by Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:dateFilter,onChange:e=>setDateFilter(e.target.value),style:{marginBottom:0}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",style:{flex:1,minWidth:150},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Filter by Month\"}),/*#__PURE__*/_jsx(\"input\",{type:\"month\",value:monthFilter,onChange:e=>setMonthFilter(e.target.value),style:{marginBottom:0}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",style:{flex:1,minWidth:150},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Filter by Status\"}),/*#__PURE__*/_jsxs(\"select\",{value:statusFilter,onChange:e=>setStatusFilter(e.target.value),style:{marginBottom:0},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Status\"}),STATUS_OPTIONS.map(opt=>/*#__PURE__*/_jsx(\"option\",{value:opt.value,children:opt.label},opt.value))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",style:{flex:1,minWidth:150},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Filter by Section\"}),/*#__PURE__*/_jsxs(\"select\",{value:sectionFilter,onChange:e=>setSectionFilter(e.target.value),style:{marginBottom:0},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Sections\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1A\",children:\"1A\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1B\",children:\"1B\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2A\",children:\"2A\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2B\",children:\"2B\"}),/*#__PURE__*/_jsx(\"option\",{value:\"12A\",children:\"12A\"}),/*#__PURE__*/_jsx(\"option\",{value:\"11C\",children:\"11C\"})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",alignItems:\"end\"},children:/*#__PURE__*/_jsxs(\"button\",{onClick:downloadReport,className:\"success\",style:{padding:\"8px 16px\",fontSize:\"14px\",display:\"flex\",alignItems:\"center\",gap:\"8px\",height:\"fit-content\",whiteSpace:\"nowrap\"},title:\"Download filtered attendance report\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-download\",style:{fontSize:\"14px\"}}),getDownloadButtonText()]})})]}),hasActiveFilters&&/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",justifyContent:\"flex-end\",padding:\"12px 0\",borderTop:\"1px solid var(--border)\"},children:/*#__PURE__*/_jsxs(\"button\",{className:\"ghost\",onClick:clearFilters,style:{height:\"fit-content\",padding:\"8px 16px\",display:\"flex\",alignItems:\"center\",gap:\"4px\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times\",style:{fontSize:\"12px\"}}),\"Clear Filters\"]})}),currentDateAbsentLateRecords.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"notification-section\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"notification-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"notification-info\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-exclamation-triangle\",style:{marginRight:\"8px\"}}),currentDateAbsentLateRecords.length,\" absent/late student(s) for today\"]}),/*#__PURE__*/_jsx(\"p\",{children:currentDateAbsentLateRecords.map(r=>r.student.name).join(\", \")})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"success\",onClick:notifyParentsForCurrentDate,disabled:notifying,style:{whiteSpace:\"nowrap\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-bell\",style:{marginRight:\"8px\"}}),notifying?\"Sending...\":\"Notify Parents (Today Only)\"]})]})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",padding:\"8px 0\",borderTop:\"1px solid var(--border)\",fontSize:\"14px\",color:\"var(--subtle)\"},children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Showing \",filteredRecords.length,\" of \",records.length,\" records\",hasActiveFilters&&\" (filtered)\",monthFilter&&\" - \".concat(dayjs(monthFilter).format('MMMM YYYY'))]}),hasActiveFilters&&/*#__PURE__*/_jsx(\"span\",{style:{color:\"var(--primary)\"},children:\"Filters active\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"panel\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:{padding:\"12px 8px\",textAlign:\"left\"},children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:\"12px 8px\",textAlign:\"left\"},children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:\"12px 8px\",textAlign:\"left\"},children:\"Index\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:\"12px 8px\",textAlign:\"left\"},children:\"Section\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:\"12px 8px\",textAlign:\"left\"},children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:\"12px 8px\",textAlign:\"left\"},children:\"Notified\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:\"12px 8px\",textAlign:\"right\",minWidth:\"200px\"},children:\"Actions\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[loading&&/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"7\",children:\"Loading...\"})}),!loading&&filteredRecords.map(r=>{var _r$student,_r$student2,_r$student3;return/*#__PURE__*/_jsxs(\"tr\",{style:{transition:\"background-color 0.2s ease\"},onMouseEnter:e=>{e.target.style.backgroundColor=\"#f8f9fa\";},onMouseLeave:e=>{e.target.style.backgroundColor=\"transparent\";},children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:\"12px 8px\",verticalAlign:\"middle\"},children:dayjs(r.date).format(\"YYYY-MM-DD\")}),/*#__PURE__*/_jsx(\"td\",{style:{padding:\"12px 8px\",verticalAlign:\"middle\"},children:(_r$student=r.student)===null||_r$student===void 0?void 0:_r$student.name}),/*#__PURE__*/_jsx(\"td\",{style:{padding:\"12px 8px\",verticalAlign:\"middle\"},children:/*#__PURE__*/_jsx(\"span\",{className:\"badge\",children:(_r$student2=r.student)===null||_r$student2===void 0?void 0:_r$student2.std_index})}),/*#__PURE__*/_jsx(\"td\",{style:{padding:\"12px 8px\",verticalAlign:\"middle\"},children:(_r$student3=r.student)===null||_r$student3===void 0?void 0:_r$student3.section}),/*#__PURE__*/_jsx(\"td\",{style:{padding:\"12px 8px\",verticalAlign:\"middle\"},children:editingId===r._id?/*#__PURE__*/_jsx(\"select\",{value:editStatus,onChange:e=>setEditStatus(e.target.value),style:{padding:\"4px 8px\",borderRadius:\"4px\",border:\"1px solid #ddd\",fontSize:\"12px\"},children:STATUS_OPTIONS.map(opt=>/*#__PURE__*/_jsx(\"option\",{value:opt.value,children:opt.label},opt.value))}):/*#__PURE__*/_jsx(\"span\",{style:{padding:\"4px 8px\",borderRadius:\"4px\",backgroundColor:r.status===\"Present\"?\"#d4edda\":r.status===\"Absent\"?\"#f8d7da\":r.status===\"Late\"?\"#fff3cd\":\"#e2e3e5\",color:r.status===\"Present\"?\"#155724\":r.status===\"Absent\"?\"#721c24\":r.status===\"Late\"?\"#856404\":\"#6c757d\",fontSize:\"12px\",fontWeight:\"500\"},children:r.status})}),/*#__PURE__*/_jsx(\"td\",{style:{padding:\"12px 8px\",verticalAlign:\"middle\"},children:r.notifiedParent||notifiedRecords.has(r._id)?/*#__PURE__*/_jsxs(\"span\",{style:{color:\"var(--success)\",fontSize:\"12px\",display:\"flex\",alignItems:\"center\",gap:\"4px\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-check-circle\",style:{fontSize:\"10px\"}}),\"Notified\"]}):/*#__PURE__*/_jsx(\"span\",{style:{color:\"var(--subtle)\",fontSize:\"12px\"},children:\"-\"})}),/*#__PURE__*/_jsx(\"td\",{style:{textAlign:\"right\",padding:\"8px 4px\",verticalAlign:\"middle\"},children:/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",gap:\"6px\",justifyContent:\"flex-end\",alignItems:\"center\",flexWrap:\"nowrap\"},children:editingId===r._id?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>saveEdit(r._id),disabled:saving,style:{fontSize:\"11px\",padding:\"6px 12px\",minWidth:\"60px\",height:\"28px\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",borderRadius:\"4px\",border:\"1px solid #28a745\",cursor:saving?\"not-allowed\":\"pointer\",transition:\"all 0.2s ease\",backgroundColor:\"white\",color:\"#28a745\"},onMouseEnter:e=>{if(!saving){e.target.style.backgroundColor=\"#28a745\";e.target.style.color=\"white\";e.target.style.transform=\"translateY(-1px)\";}},onMouseLeave:e=>{if(!saving){e.target.style.backgroundColor=\"white\";e.target.style.color=\"#28a745\";e.target.style.transform=\"translateY(0)\";}},children:saving?\"Saving...\":\"Save\"}),/*#__PURE__*/_jsx(\"button\",{className:\"ghost\",onClick:cancelEdit,disabled:saving,style:{fontSize:\"11px\",padding:\"6px 12px\",minWidth:\"60px\",height:\"28px\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",borderRadius:\"4px\",border:\"1px solid #6c757d\",cursor:saving?\"not-allowed\":\"pointer\",transition:\"all 0.2s ease\",backgroundColor:\"transparent\",color:\"#6c757d\"},onMouseEnter:e=>{if(!saving){e.target.style.backgroundColor=\"#6c757d\";e.target.style.color=\"white\";e.target.style.transform=\"translateY(-1px)\";}},onMouseLeave:e=>{if(!saving){e.target.style.backgroundColor=\"transparent\";e.target.style.color=\"#6c757d\";e.target.style.transform=\"translateY(0)\";}},children:\"Cancel\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>startEdit(r),style:{fontSize:\"11px\",padding:\"6px 12px\",minWidth:\"50px\",height:\"28px\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",borderRadius:\"4px\",border:\"1px solid #6c757d\",backgroundColor:\"#6c757d\",color:\"white\",cursor:\"pointer\",transition:\"all 0.2s ease\"},onMouseEnter:e=>{e.target.style.backgroundColor=\"#5a6268\";e.target.style.color=\"white\";e.target.style.transform=\"translateY(-1px)\";},onMouseLeave:e=>{e.target.style.backgroundColor=\"#6c757d\";e.target.style.color=\"white\";e.target.style.transform=\"translateY(0)\";},title:\"Edit Record\",children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{className:\"danger\",onClick:()=>remove(r._id),style:{fontSize:\"11px\",padding:\"6px 12px\",minWidth:\"60px\",height:\"28px\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},title:\"Delete Record\",children:\"Delete\"})]})})})]},r._id);}),!loading&&filteredRecords.length===0&&/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"7\",style:{color:\"#aaa\",textAlign:\"center\",padding:\"20px\"},children:hasActiveFilters?\"No records match your search criteria\":\"No records\"})})]})]})})]});};export default AttendanceRecords;","map":{"version":3,"names":["React","useEffect","useState","useMemo","Layout","getAllAttendance","deleteAttendance","updateAttendance","notifyParentsForAbsents","STATUS_OPTIONS","dayjs","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AttendanceRecords","records","setRecords","loading","setLoading","editingId","setEditingId","editStatus","setEditStatus","saving","setSaving","searchTerm","setSearchTerm","dateFilter","setDateFilter","monthFilter","setMonthFilter","statusFilter","setStatusFilter","sectionFilter","setSectionFilter","notifying","setNotifying","notifiedRecords","setNotifiedRecords","Set","load","data","filteredRecords","filtered","trim","term","toLowerCase","filter","record","_record$student","_record$student$name","_record$student2","_record$student2$std_","student","name","includes","std_index","date","format","status","_record$student3","section","currentDateAbsentLateRecords","today","notifiedParent","has","_id","remove","id","window","confirm","startEdit","cancelEdit","saveEdit","e","_e$response","_e$response$data","alert","response","message","clearFilters","hasActiveFilters","generateTextReport","report","repeat","concat","title","generatedOn","filters","Object","keys","some","key","statistics","totalRecords","present","absent","late","excused","attendancePercentage","forEach","index","_record$student4","_record$student5","_record$student6","Date","toLocaleDateString","downloadReport","length","console","log","recordCount","fetch","method","headers","body","JSON","stringify","ok","errorData","json","catch","Error","contentType","get","blob","size","url","URL","createObjectURL","a","document","createElement","style","display","href","filename","download","appendChild","click","revokeObjectURL","removeChild","reportText","Blob","type","errorText","text","error","getDownloadButtonText","notifyParentsForCurrentDate","items","map","studentId","succeeded","Array","isArray","failed","newNotifiedSet","add","Promise","all","names","f","find","r","parentPhoneNum","join","_e$response2","_e$response2$data","children","textAlign","marginTop","margin","className","marginBottom","flexDirection","gap","gridTemplateColumns","alignItems","flex","minWidth","placeholder","value","onChange","target","opt","label","onClick","padding","fontSize","height","whiteSpace","justifyContent","borderTop","marginRight","disabled","color","colSpan","_r$student","_r$student2","_r$student3","transition","onMouseEnter","backgroundColor","onMouseLeave","verticalAlign","borderRadius","border","fontWeight","flexWrap","cursor","transform"],"sources":["/Users/kavinth/Documents/GitHub/Smart-Alert/Smart-Alert-new/frontend/src/pages/AttendanceRecords.jsx"],"sourcesContent":["import React, { useEffect, useState, useMemo } from \"react\";\nimport Layout from \"../components/Layout\";\nimport { getAllAttendance, deleteAttendance, updateAttendance, notifyParentsForAbsents } from \"../api/client\";\nimport { STATUS_OPTIONS } from \"../utils/statusOptions\";\nimport dayjs from \"dayjs\";\n\nconst AttendanceRecords = () => {\n  const [records, setRecords] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  const [editingId, setEditingId] = useState(null);\n  const [editStatus, setEditStatus] = useState(\"\");\n  const [saving, setSaving] = useState(false);\n\n  // Search and filter states\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [dateFilter, setDateFilter] = useState(\"\");\n  const [monthFilter, setMonthFilter] = useState(\"\");\n  const [statusFilter, setStatusFilter] = useState(\"\");\n  const [sectionFilter, setSectionFilter] = useState(\"\");\n\n  // Notification states\n  const [notifying, setNotifying] = useState(false);\n  const [notifiedRecords, setNotifiedRecords] = useState(new Set());\n\n  const load = async () => {\n    setLoading(true);\n    try {\n      const { data } = await getAllAttendance();\n      setRecords(data.records || []);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => { \n    load(); \n  }, []);\n\n  // Filter records based on search criteria\n  const filteredRecords = useMemo(() => {\n    let filtered = [...records];\n\n    // Filter by search term (name or index)\n    if (searchTerm.trim()) {\n      const term = searchTerm.toLowerCase().trim();\n      filtered = filtered.filter(record => \n        record.student?.name?.toLowerCase().includes(term) ||\n        record.student?.std_index?.toLowerCase().includes(term)\n      );\n    }\n\n    // Filter by date\n    if (dateFilter) {\n      filtered = filtered.filter(record => \n        dayjs(record.date).format(\"YYYY-MM-DD\") === dateFilter\n      );\n    }\n\n    // Filter by month\n    if (monthFilter) {\n      filtered = filtered.filter(record => \n        dayjs(record.date).format(\"YYYY-MM\") === monthFilter\n      );\n    }\n\n    // Filter by status\n    if (statusFilter) {\n      filtered = filtered.filter(record => record.status === statusFilter);\n    }\n\n    // Filter by section\n    if (sectionFilter) {\n      filtered = filtered.filter(record => record.student?.section === sectionFilter);\n    }\n\n    return filtered;\n  }, [records, searchTerm, dateFilter, monthFilter, statusFilter, sectionFilter]);\n\n  // Get current date records that are absent/late and not yet notified\n  const currentDateAbsentLateRecords = useMemo(() => {\n    const today = dayjs().format(\"YYYY-MM-DD\");\n    return records.filter(record => \n      dayjs(record.date).format(\"YYYY-MM-DD\") === today &&\n      (record.status === \"Absent\" || record.status === \"Late\") &&\n      !record.notifiedParent &&\n      !notifiedRecords.has(record._id)\n    );\n  }, [records, notifiedRecords]);\n\n  const remove = async (id) => {\n    if (!window.confirm(\"Delete this record?\")) return;\n    await deleteAttendance(id);\n    await load();\n  };\n\n  const startEdit = (record) => {\n    setEditingId(record._id);\n    setEditStatus(record.status || \"Present\");\n  };\n\n  const cancelEdit = () => {\n    setEditingId(null);\n    setEditStatus(\"\");\n  };\n\n  const saveEdit = async (id) => {\n    setSaving(true);\n    try {\n      await updateAttendance(id, { status: editStatus });\n      await load();\n      cancelEdit();\n    } catch (e) {\n      alert(e?.response?.data?.message || \"Failed to update record\");\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const clearFilters = () => {\n    setSearchTerm(\"\");\n    setDateFilter(\"\");\n    setMonthFilter(\"\");\n    setStatusFilter(\"\");\n    setSectionFilter(\"\");\n  };\n\n  const hasActiveFilters = searchTerm || dateFilter || monthFilter || statusFilter || sectionFilter;\n\n  // Generate text report from data\n  const generateTextReport = (data) => {\n    let report = '';\n    report += '='.repeat(50) + '\\n';\n    report += `           ${data.title}\\n`;\n    report += '='.repeat(50) + '\\n';\n    report += `Generated on: ${data.generatedOn}\\n\\n`;\n    \n    // Filters applied\n    if (data.filters && Object.keys(data.filters).some(key => data.filters[key])) {\n      report += 'Filters Applied:\\n';\n      report += '-'.repeat(20) + '\\n';\n      if (data.filters.searchTerm) report += `Search: ${data.filters.searchTerm}\\n`;\n      if (data.filters.dateFilter) report += `Date: ${data.filters.dateFilter}\\n`;\n      if (data.filters.monthFilter) report += `Month: ${data.filters.monthFilter}\\n`;\n      if (data.filters.statusFilter) report += `Status: ${data.filters.statusFilter}\\n`;\n      if (data.filters.sectionFilter) report += `Section: ${data.filters.sectionFilter}\\n`;\n      report += '\\n';\n    }\n    \n    // Statistics\n    report += 'Statistics:\\n';\n    report += '-'.repeat(20) + '\\n';\n    report += `Total Records: ${data.statistics.totalRecords}\\n`;\n    report += `Present: ${data.statistics.present}\\n`;\n    report += `Absent: ${data.statistics.absent}\\n`;\n    report += `Late: ${data.statistics.late}\\n`;\n    report += `Excused: ${data.statistics.excused}\\n`;\n    report += `Attendance Rate: ${data.statistics.attendancePercentage}%\\n\\n`;\n    \n    // Records\n    report += 'Records:\\n';\n    report += '-'.repeat(20) + '\\n';\n    data.records.forEach((record, index) => {\n      report += `${index + 1}. ${record.student?.name || 'Unknown'} (${record.student?.std_index || 'N/A'})\\n`;\n      report += `   Section: ${record.student?.section || 'N/A'}\\n`;\n      report += `   Status: ${record.status}\\n`;\n      report += `   Date: ${new Date(record.date).toLocaleDateString()}\\n`;\n      report += '\\n';\n    });\n    \n    report += '='.repeat(50) + '\\n';\n    report += 'End of Report\\n';\n    report += '='.repeat(50) + '\\n';\n    \n    return report;\n  };\n\n  // Download functionality\n  const downloadReport = async () => {\n    try {\n      // Check if there are records to download\n      if (filteredRecords.length === 0) {\n        alert('No records to download. Please adjust your filters or add some attendance records first.');\n        return;\n      }\n\n      console.log('Downloading report with:', {\n        recordCount: filteredRecords.length,\n        filters: {\n          searchTerm: searchTerm || null,\n          dateFilter: dateFilter || null,\n          monthFilter: monthFilter || null,\n          statusFilter: statusFilter || null,\n          sectionFilter: sectionFilter || null,\n        }\n      });\n\n      const response = await fetch('http://localhost:5002/reports/generate', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          filters: {\n            searchTerm: searchTerm || null,\n            dateFilter: dateFilter || null,\n            monthFilter: monthFilter || null,\n            statusFilter: statusFilter || null,\n            sectionFilter: sectionFilter || null,\n          },\n          records: filteredRecords\n        })\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.message || `Server error: ${response.status}`);\n      }\n\n      // Check if response is a PDF\n      const contentType = response.headers.get('content-type');\n      if (contentType && contentType.includes('application/pdf')) {\n        const blob = await response.blob();\n        \n        // Check if blob is empty\n        if (blob.size === 0) {\n          throw new Error('Received empty PDF file. Please try again.');\n        }\n\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.style.display = 'none';\n        a.href = url;\n        \n        // Generate filename based on filters\n        let filename = 'attendance_report';\n        if (monthFilter) {\n          filename = `attendance_report_${monthFilter}`;\n        } else if (dateFilter) {\n          filename = `attendance_report_${dateFilter}`;\n        } else if (hasActiveFilters) {\n          filename = 'attendance_report_filtered';\n        }\n        filename += '.pdf';\n        \n        a.download = filename;\n        document.body.appendChild(a);\n        a.click();\n        window.URL.revokeObjectURL(url);\n        document.body.removeChild(a);\n        \n        console.log('PDF downloaded successfully:', filename);\n        return;\n      }\n\n      // If it's JSON (fallback)\n      if (contentType && contentType.includes('application/json')) {\n        const data = await response.json();\n        console.log('Received JSON response (fallback):', data);\n        \n        // Create a simple text report as fallback\n        const reportText = generateTextReport(data.data);\n        \n        // Create and download text file\n        const blob = new Blob([reportText], { type: 'text/plain' });\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.style.display = 'none';\n        a.href = url;\n        \n        // Generate filename based on filters\n        let filename = 'attendance_report';\n        if (monthFilter) {\n          filename = `attendance_report_${monthFilter}`;\n        } else if (dateFilter) {\n          filename = `attendance_report_${dateFilter}`;\n        } else if (hasActiveFilters) {\n          filename = 'attendance_report_filtered';\n        }\n        filename += '.txt';\n        \n        a.download = filename;\n        document.body.appendChild(a);\n        a.click();\n        window.URL.revokeObjectURL(url);\n        document.body.removeChild(a);\n        \n        console.log('Text report downloaded successfully (fallback):', filename);\n        return;\n      }\n\n      // If neither PDF nor JSON\n      const errorText = await response.text();\n      console.error('Unexpected response type:', contentType, errorText);\n      throw new Error('Server returned unexpected response type. Please check server logs.');\n    } catch (error) {\n      console.error('Download error:', error);\n      alert(`Failed to download report: ${error.message}\\n\\nPlease check that the backend server is running and try again.`);\n    }\n  };\n\n  // Get button text based on filters\n  const getDownloadButtonText = () => {\n    if (monthFilter) {\n      return `Download ${dayjs(monthFilter).format('MMMM YYYY')} Report`;\n    } else if (hasActiveFilters) {\n      return 'Download Selected Range Report';\n    } else {\n      return 'Download Current Report';\n    }\n  };\n\n  // Notify parents for current date absent/late students\n  const notifyParentsForCurrentDate = async () => {\n    if (currentDateAbsentLateRecords.length === 0) {\n      alert(\"No absent or late students found for today.\");\n      return;\n    }\n\n    setNotifying(true);\n    try {\n      const items = currentDateAbsentLateRecords.map(record => ({\n        studentId: record.student._id,\n        status: record.status,\n        date: dayjs(record.date).format(\"YYYY-MM-DD\")\n      }));\n\n      console.log(\"Sending notifications for:\", items);\n\n      const { data } = await notifyParentsForAbsents(items);\n      const succeeded = Array.isArray(data?.succeeded) ? data.succeeded : [];\n      const failed = Array.isArray(data?.failed) ? data.failed : [];\n\n      if (succeeded.length > 0) {\n        // Mark records as notified locally\n        const newNotifiedSet = new Set(notifiedRecords);\n        currentDateAbsentLateRecords.forEach(record => {\n          if (succeeded.includes(record.student._id)) {\n            newNotifiedSet.add(record._id);\n          }\n        });\n        setNotifiedRecords(newNotifiedSet);\n\n        // Update the records in the database\n        await Promise.all(\n          currentDateAbsentLateRecords\n            .filter(record => succeeded.includes(record.student._id))\n            .map(record => \n              updateAttendance(record._id, { notifiedParent: true })\n            )\n        );\n\n        alert(`Successfully notified ${succeeded.length} parent(s) for today's absent/late students.`);\n      }\n\n      if (failed.length > 0) {\n        const names = failed\n          .map((f) => {\n            const record = currentDateAbsentLateRecords.find(r => r.student._id === f.studentId);\n            return record ? `${record.student.name} (${record.student.parentPhoneNum})` : f.studentId;\n          })\n          .join(\", \");\n        alert(`Failed to notify: ${names}\\n\\nPlease check phone numbers and try again.`);\n      }\n    } catch (e) {\n      console.error(\"Notification error:\", e);\n      alert(e?.response?.data?.message || \"Failed to send notifications. Please check your Twilio configuration.\");\n    } finally {\n      setNotifying(false);\n    }\n  };\n\n\n  return (\n    <Layout>\n      <div style={{ textAlign: \"center\", marginTop: 12 }}>\n        <h1 style={{ margin: 0 }}>Attendance Records</h1>\n      </div>\n\n      {/* Search and Filter Section */}\n      <div className=\"panel\" style={{ marginTop: 16, marginBottom: 16 }}>\n        <div style={{ display: \"flex\", flexDirection: \"column\", gap: 16 }}>\n          <div style={{ \n            display: \"grid\", \n            gridTemplateColumns: \"repeat(auto-fit, minmax(200px, 1fr))\", \n            gap: 12, \n            alignItems: \"end\" \n          }}>\n            {/* Search by Name/Index */}\n            <div className=\"field\" style={{ flex: 1, minWidth: 200 }}>\n              <label>Search by Name or Index</label>\n              <input\n                type=\"text\"\n                placeholder=\"Enter name or index number...\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                style={{ marginBottom: 0 }}\n              />\n            </div>\n\n            {/* Filter by Date */}\n            <div className=\"field\" style={{ flex: 1, minWidth: 150 }}>\n              <label>Filter by Date</label>\n              <input\n                type=\"date\"\n                value={dateFilter}\n                onChange={(e) => setDateFilter(e.target.value)}\n                style={{ marginBottom: 0 }}\n              />\n            </div>\n\n            {/* Filter by Month */}\n            <div className=\"field\" style={{ flex: 1, minWidth: 150 }}>\n              <label>Filter by Month</label>\n              <input\n                type=\"month\"\n                value={monthFilter}\n                onChange={(e) => setMonthFilter(e.target.value)}\n                style={{ marginBottom: 0 }}\n              />\n            </div>\n\n            {/* Filter by Status */}\n            <div className=\"field\" style={{ flex: 1, minWidth: 150 }}>\n              <label>Filter by Status</label>\n              <select\n                value={statusFilter}\n                onChange={(e) => setStatusFilter(e.target.value)}\n                style={{ marginBottom: 0 }}\n              >\n                <option value=\"\">All Status</option>\n                {STATUS_OPTIONS.map((opt) => (\n                  <option key={opt.value} value={opt.value}>\n                    {opt.label}\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            {/* Filter by Section */}\n            <div className=\"field\" style={{ flex: 1, minWidth: 150 }}>\n              <label>Filter by Section</label>\n              <select\n                value={sectionFilter}\n                onChange={(e) => setSectionFilter(e.target.value)}\n                style={{ marginBottom: 0 }}\n              >\n                <option value=\"\">All Sections</option>\n                <option value=\"1A\">1A</option>\n                <option value=\"1B\">1B</option>\n                <option value=\"2A\">2A</option>\n                <option value=\"2B\">2B</option>\n                <option value=\"12A\">12A</option>\n                <option value=\"11C\">11C</option>\n              </select>\n            </div>\n\n            {/* Download Report Button */}\n            <div style={{ display: \"flex\", alignItems: \"end\" }}>\n              <button\n                onClick={downloadReport}\n                className=\"success\"\n                style={{\n                  padding: \"8px 16px\",\n                  fontSize: \"14px\",\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  gap: \"8px\",\n                  height: \"fit-content\",\n                  whiteSpace: \"nowrap\"\n                }}\n                title=\"Download filtered attendance report\"\n              >\n                <i className=\"fas fa-download\" style={{ fontSize: \"14px\" }}></i>\n                {getDownloadButtonText()}\n              </button>\n            </div>\n\n          </div>\n\n          {/* Clear Filters Button */}\n          {hasActiveFilters && (\n            <div style={{ \n              display: \"flex\", \n              justifyContent: \"flex-end\",\n              padding: \"12px 0\",\n              borderTop: \"1px solid var(--border)\"\n            }}>\n              <button\n                className=\"ghost\"\n                onClick={clearFilters}\n                style={{ \n                  height: \"fit-content\", \n                  padding: \"8px 16px\",\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  gap: \"4px\"\n                }}\n              >\n                <i className=\"fas fa-times\" style={{ fontSize: \"12px\" }}></i>\n                Clear Filters\n              </button>\n            </div>\n          )}\n\n          {/* Notification Section for Current Date */}\n          {currentDateAbsentLateRecords.length > 0 && (\n  <div className=\"notification-section\">\n    <div className=\"notification-content\">\n      <div className=\"notification-info\">\n        <h4>\n          <i className=\"fas fa-exclamation-triangle\" style={{ marginRight: \"8px\" }}></i>\n          {currentDateAbsentLateRecords.length} absent/late student(s) for today\n        </h4>\n        <p>\n          {currentDateAbsentLateRecords.map(r => r.student.name).join(\", \")}\n        </p>\n      </div>\n      <button\n        className=\"success\"\n        onClick={notifyParentsForCurrentDate}\n        disabled={notifying}\n        style={{ whiteSpace: \"nowrap\" }}\n      >\n        <i className=\"fas fa-bell\" style={{ marginRight: \"8px\" }}></i>\n        {notifying ? \"Sending...\" : \"Notify Parents (Today Only)\"}\n      </button>\n    </div>\n  </div>\n)}\n\n          {/* Results Summary */}\n          <div style={{ \n            display: \"flex\", \n            justifyContent: \"space-between\", \n            alignItems: \"center\",\n            padding: \"8px 0\",\n            borderTop: \"1px solid var(--border)\",\n            fontSize: \"14px\",\n            color: \"var(--subtle)\"\n          }}>\n            <span>\n              Showing {filteredRecords.length} of {records.length} records\n              {hasActiveFilters && \" (filtered)\"}\n              {monthFilter && ` - ${dayjs(monthFilter).format('MMMM YYYY')}`}\n            </span>\n            {hasActiveFilters && (\n              <span style={{ color: \"var(--primary)\" }}>\n                Filters active\n              </span>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Records Table */}\n      <div className=\"panel\">\n        <table className=\"table\">\n          <thead>\n            <tr>\n              <th style={{ padding: \"12px 8px\", textAlign: \"left\" }}>Date</th>\n              <th style={{ padding: \"12px 8px\", textAlign: \"left\" }}>Name</th>\n              <th style={{ padding: \"12px 8px\", textAlign: \"left\" }}>Index</th>\n              <th style={{ padding: \"12px 8px\", textAlign: \"left\" }}>Section</th>\n              <th style={{ padding: \"12px 8px\", textAlign: \"left\" }}>Status</th>\n              <th style={{ padding: \"12px 8px\", textAlign: \"left\" }}>Notified</th>\n              <th style={{ padding: \"12px 8px\", textAlign: \"right\", minWidth: \"200px\" }}>Actions</th>\n            </tr>\n          </thead>\n          <tbody>\n            {loading && <tr><td colSpan=\"7\">Loading...</td></tr>}\n\n            {!loading && filteredRecords.map((r) => (\n              <tr \n                key={r._id}\n                style={{\n                  transition: \"background-color 0.2s ease\"\n                }}\n                onMouseEnter={(e) => {\n                  e.target.style.backgroundColor = \"#f8f9fa\";\n                }}\n                onMouseLeave={(e) => {\n                  e.target.style.backgroundColor = \"transparent\";\n                }}\n              >\n                <td style={{ padding: \"12px 8px\", verticalAlign: \"middle\" }}>{dayjs(r.date).format(\"YYYY-MM-DD\")}</td>\n                <td style={{ padding: \"12px 8px\", verticalAlign: \"middle\" }}>{r.student?.name}</td>\n                <td style={{ padding: \"12px 8px\", verticalAlign: \"middle\" }}><span className=\"badge\">{r.student?.std_index}</span></td>\n                <td style={{ padding: \"12px 8px\", verticalAlign: \"middle\" }}>{r.student?.section}</td>\n\n                <td style={{ padding: \"12px 8px\", verticalAlign: \"middle\" }}>\n                  {editingId === r._id ? (\n                    <select \n                      value={editStatus} \n                      onChange={(e) => setEditStatus(e.target.value)}\n                      style={{ \n                        padding: \"4px 8px\", \n                        borderRadius: \"4px\", \n                        border: \"1px solid #ddd\",\n                        fontSize: \"12px\"\n                      }}\n                    >\n                      {STATUS_OPTIONS.map((opt) => (\n                        <option key={opt.value} value={opt.value}>{opt.label}</option>\n                      ))}\n                    </select>\n                  ) : (\n                    <span style={{ \n                      padding: \"4px 8px\", \n                      borderRadius: \"4px\",\n                      backgroundColor: r.status === \"Present\" ? \"#d4edda\" : \n                                    r.status === \"Absent\" ? \"#f8d7da\" : \n                                    r.status === \"Late\" ? \"#fff3cd\" : \"#e2e3e5\",\n                      color: r.status === \"Present\" ? \"#155724\" : \n                            r.status === \"Absent\" ? \"#721c24\" : \n                            r.status === \"Late\" ? \"#856404\" : \"#6c757d\",\n                      fontSize: \"12px\",\n                      fontWeight: \"500\"\n                    }}>\n                      {r.status}\n                    </span>\n                  )}\n                </td>\n\n                <td style={{ padding: \"12px 8px\", verticalAlign: \"middle\" }}>\n                  {r.notifiedParent || notifiedRecords.has(r._id) ? (\n                    <span style={{ \n                      color: \"var(--success)\", \n                      fontSize: \"12px\",\n                      display: \"flex\",\n                      alignItems: \"center\",\n                      gap: \"4px\"\n                    }}>\n                      <i className=\"fas fa-check-circle\" style={{ fontSize: \"10px\" }}></i>\n                      Notified\n                    </span>\n                  ) : (\n                    <span style={{ color: \"var(--subtle)\", fontSize: \"12px\" }}>-</span>\n                  )}\n                </td>\n\n                <td style={{ \n                  textAlign: \"right\", \n                  padding: \"8px 4px\",\n                  verticalAlign: \"middle\"\n                }}>\n                  <div style={{ \n                    display: \"flex\", \n                    gap: \"6px\", \n                    justifyContent: \"flex-end\", \n                    alignItems: \"center\",\n                    flexWrap: \"nowrap\"\n                  }}>\n                    {editingId === r._id ? (\n                      <>\n                        <button \n                          onClick={() => saveEdit(r._id)} \n                          disabled={saving}\n                          style={{ \n                            fontSize: \"11px\", \n                            padding: \"6px 12px\", \n                            minWidth: \"60px\",\n                            height: \"28px\",\n                            display: \"flex\",\n                            alignItems: \"center\",\n                            justifyContent: \"center\",\n                            borderRadius: \"4px\",\n                            border: \"1px solid #28a745\",\n                            cursor: saving ? \"not-allowed\" : \"pointer\",\n                            transition: \"all 0.2s ease\",\n                            backgroundColor: \"white\",\n                            color: \"#28a745\"\n                          }}\n                          onMouseEnter={(e) => {\n                            if (!saving) {\n                              e.target.style.backgroundColor = \"#28a745\";\n                              e.target.style.color = \"white\";\n                              e.target.style.transform = \"translateY(-1px)\";\n                            }\n                          }}\n                          onMouseLeave={(e) => {\n                            if (!saving) {\n                              e.target.style.backgroundColor = \"white\";\n                              e.target.style.color = \"#28a745\";\n                              e.target.style.transform = \"translateY(0)\";\n                            }\n                          }}\n                        >\n                          {saving ? \"Saving...\" : \"Save\"}\n                        </button>\n                        <button \n                          className=\"ghost\" \n                          onClick={cancelEdit} \n                          disabled={saving}\n                          style={{ \n                            fontSize: \"11px\", \n                            padding: \"6px 12px\", \n                            minWidth: \"60px\",\n                            height: \"28px\",\n                            display: \"flex\",\n                            alignItems: \"center\",\n                            justifyContent: \"center\",\n                            borderRadius: \"4px\",\n                            border: \"1px solid #6c757d\",\n                            cursor: saving ? \"not-allowed\" : \"pointer\",\n                            transition: \"all 0.2s ease\",\n                            backgroundColor: \"transparent\",\n                            color: \"#6c757d\"\n                          }}\n                          onMouseEnter={(e) => {\n                            if (!saving) {\n                              e.target.style.backgroundColor = \"#6c757d\";\n                              e.target.style.color = \"white\";\n                              e.target.style.transform = \"translateY(-1px)\";\n                            }\n                          }}\n                          onMouseLeave={(e) => {\n                            if (!saving) {\n                              e.target.style.backgroundColor = \"transparent\";\n                              e.target.style.color = \"#6c757d\";\n                              e.target.style.transform = \"translateY(0)\";\n                            }\n                          }}\n                        >\n                          Cancel\n                        </button>\n                      </>\n                    ) : (\n                      <>\n                        <button \n                          onClick={() => startEdit(r)}\n                          style={{ \n                            fontSize: \"11px\", \n                            padding: \"6px 12px\", \n                            minWidth: \"50px\",\n                            height: \"28px\",\n                            display: \"flex\",\n                            alignItems: \"center\",\n                            justifyContent: \"center\",\n                            borderRadius: \"4px\",\n                            border: \"1px solid #6c757d\",\n                            backgroundColor: \"#6c757d\",\n                            color: \"white\",\n                            cursor: \"pointer\",\n                            transition: \"all 0.2s ease\"\n                          }}\n                          onMouseEnter={(e) => {\n                            e.target.style.backgroundColor = \"#5a6268\";\n                            e.target.style.color = \"white\";\n                            e.target.style.transform = \"translateY(-1px)\";\n                          }}\n                          onMouseLeave={(e) => {\n                            e.target.style.backgroundColor = \"#6c757d\";\n                            e.target.style.color = \"white\";\n                            e.target.style.transform = \"translateY(0)\";\n                          }}\n                          title=\"Edit Record\"\n                        >\n                          Edit\n                        </button>\n                        <button \n                          className=\"danger\" \n                          onClick={() => remove(r._id)}\n                          style={{ \n                            fontSize: \"11px\", \n                            padding: \"6px 12px\", \n                            minWidth: \"60px\",\n                            height: \"28px\",\n                            display: \"flex\",\n                            alignItems: \"center\",\n                            justifyContent: \"center\"\n                          }}\n                          title=\"Delete Record\"\n                        >\n                          Delete\n                        </button>\n                      </>\n                    )}\n                  </div>\n                </td>\n              </tr>\n            ))}\n\n            {!loading && filteredRecords.length === 0 && (\n              <tr>\n                <td colSpan=\"7\" style={{ color: \"#aaa\", textAlign: \"center\", padding: \"20px\" }}>\n                  {hasActiveFilters ? \"No records match your search criteria\" : \"No records\"}\n                </td>\n              </tr>\n            )}\n          </tbody>\n        </table>\n      </div>\n    </Layout>\n  );\n};\n\nexport default AttendanceRecords;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"// @ts-check\nimport { debounce } from '../../utils/debounce.js';\nimport { Block } from '../../../abstract/Block.js';\nimport { EditorCropButtonControl } from './EditorCropButtonControl.js';\nimport { EditorFilterControl } from './EditorFilterControl.js';\nimport { EditorOperationControl } from './EditorOperationControl.js';\nimport { FAKE_ORIGINAL_FILTER } from './EditorSlider.js';\nimport { batchPreloadImages } from '../../utils/preloadImage.js';\nimport { ALL_COLOR_OPERATIONS, ALL_CROP_OPERATIONS, ALL_FILTERS, ALL_TABS, COLOR_OPERATIONS_CONFIG, TabId } from './toolbar-constants.js';\nimport { viewerImageSrc } from './util.js';\n\n/** @param {String} id */\nfunction renderTabToggle(id) {\n  return /* HTML */`\n    <uc-presence-toggle\n      class=\"uc-tab-toggle\"\n      set=\"visible: presence.tabToggle.${id}; styles: presence.tabToggleStyles;\"\n    >\n      <uc-btn-ui\n        theme=\"tab\"\n        ref=\"tab-toggle-${id}\"\n        data-id=\"${id}\"\n        icon=\"${id}\"\n        set=\"onclick: on.clickTab; aria-role:tab_role; aria-controls:tab_${id}; title-prop: a11y-editor-tab-${id}\"\n      >\n      </uc-btn-ui>\n    </uc-presence-toggle>\n  `;\n}\n\n/** @param {String} id */\nfunction renderTabContent(id) {\n  return /* HTML */`\n    <uc-presence-toggle\n      id=\"tab_${id}\"\n      class=\"uc-tab-content\"\n      set=\"visible: presence.tabContent.${id}; styles: presence.tabContentStyles\"\n    >\n      <uc-editor-scroller hidden-scrollbar>\n        <div class=\"uc-controls-list_align\">\n          <div\n            role=\"listbox\"\n            aria-orientation=\"horizontal\"\n            class=\"uc-controls-list_inner\"\n            ref=\"controls-list-${id}\"\n          ></div>\n        </div>\n      </uc-editor-scroller>\n    </uc-presence-toggle>\n  `;\n}\nexport class EditorToolbar extends Block {\n  constructor() {\n    super();\n    this.init$ = {\n      ...this.init$,\n      '*sliderEl': null,\n      /** @type {import('./types.js').LoadingOperations} */\n      '*loadingOperations': new Map(),\n      '*showSlider': false,\n      '*currentFilter': FAKE_ORIGINAL_FILTER,\n      '*currentOperation': null,\n      showLoader: false,\n      filters: ALL_FILTERS,\n      colorOperations: ALL_COLOR_OPERATIONS,\n      cropOperations: ALL_CROP_OPERATIONS,\n      '*operationTooltip': null,\n      'presence.mainToolbar': true,\n      'presence.subToolbar': false,\n      'presence.tabToggles': true,\n      'presence.tabContent.crop': false,\n      'presence.tabContent.tuning': false,\n      'presence.tabContent.filters': false,\n      'presence.tabToggle.crop': true,\n      'presence.tabToggle.tuning': true,\n      'presence.tabToggle.filters': true,\n      'presence.subTopToolbarStyles': {\n        hidden: 'uc-sub-toolbar--top-hidden',\n        visible: 'uc-sub-toolbar--visible'\n      },\n      'presence.subBottomToolbarStyles': {\n        hidden: 'uc-sub-toolbar--bottom-hidden',\n        visible: 'uc-sub-toolbar--visible'\n      },\n      'presence.tabContentStyles': {\n        hidden: 'uc-tab-content--hidden',\n        visible: 'uc-tab-content--visible'\n      },\n      'presence.tabToggleStyles': {\n        hidden: 'uc-tab-toggle--hidden',\n        visible: 'uc-tab-toggle--visible'\n      },\n      'presence.tabTogglesStyles': {\n        hidden: 'uc-tab-toggles--hidden',\n        visible: 'uc-tab-toggles--visible'\n      },\n      'on.cancel': () => {\n        this._cancelPreload?.();\n        this.$['*on.cancel']();\n      },\n      'on.apply': () => {\n        this.$['*on.apply'](this.$['*editorTransformations']);\n      },\n      'on.applySlider': () => {\n        this.ref['slider-el'].apply();\n        this._onSliderClose();\n      },\n      'on.cancelSlider': () => {\n        this.ref['slider-el'].cancel();\n        this._onSliderClose();\n      },\n      /** @param {MouseEvent} e */\n      'on.clickTab': e => {\n        const id = /** @type {HTMLElement} */e.currentTarget.getAttribute('data-id');\n        if (id) {\n          this._activateTab(id, {\n            fromViewer: false\n          });\n        }\n      },\n      tab_role: 'tab',\n      [`tab_${TabId.TUNING}`]: `tab_${TabId.TUNING}`,\n      [`tab_${TabId.CROP}`]: `tab_${TabId.CROP}`,\n      [`tab_${TabId.FILTERS}`]: `tab_${TabId.FILTERS}`,\n      cancel: 'cancel',\n      apply: 'apply',\n      'a11y-editor-tab-filters': 'a11y-editor-tab-filters',\n      'a11y-editor-tab-tuning': 'a11y-editor-tab-tuning',\n      'a11y-editor-tab-crop': 'a11y-editor-tab-crop'\n    };\n\n    /** @private */\n\n    this._debouncedShowLoader = debounce(this._showLoader.bind(this), 500);\n  }\n\n  /** @private */\n  _onSliderClose() {\n    this.$['*showSlider'] = false;\n    if (this.$['*tabId'] === TabId.TUNING) {\n      this.ref['tooltip-el'].classList.toggle('uc-info-tooltip_visible', false);\n    }\n  }\n\n  /**\n   * @private\n   * @param {String} operation\n   */\n  _createOperationControl(operation) {\n    let el = new EditorOperationControl();\n    // @ts-expect-error TODO: fix\n    el.operation = operation;\n    return el;\n  }\n\n  /**\n   * @private\n   * @param {String} filter\n   */\n  _createFilterControl(filter) {\n    let el = new EditorFilterControl();\n    // @ts-expect-error TODO: fix\n    el.filter = filter;\n    return el;\n  }\n\n  /**\n   * @private\n   * @param {String} operation\n   */\n  _createToggleControl(operation) {\n    let el = new EditorCropButtonControl();\n    // @ts-expect-error TODO: fix\n    el.operation = operation;\n    return el;\n  }\n\n  /**\n   * @private\n   * @param {String} tabId\n   */\n  _renderControlsList(tabId) {\n    let listEl = this.ref[`controls-list-${tabId}`];\n    let fr = document.createDocumentFragment();\n    if (tabId === TabId.CROP) {\n      this.$.cropOperations.forEach(/** @param {string} operation */operation => {\n        let el = this._createToggleControl(operation);\n        // @ts-ignore\n        fr.appendChild(el);\n      });\n    } else if (tabId === TabId.FILTERS) {\n      [FAKE_ORIGINAL_FILTER, ...this.$.filters].forEach(filterId => {\n        let el = this._createFilterControl(filterId);\n        // @ts-ignore\n        fr.appendChild(el);\n      });\n    } else if (tabId === TabId.TUNING) {\n      this.$.colorOperations.forEach(/** @param {string} operation */operation => {\n        let el = this._createOperationControl(operation);\n        // @ts-ignore\n        fr.appendChild(el);\n      });\n    }\n    [...fr.children].forEach((el, idx) => {\n      if (idx === fr.childNodes.length - 1) {\n        el.classList.add('uc-controls-list_last-item');\n      }\n    });\n    listEl.innerHTML = '';\n    listEl.appendChild(fr);\n  }\n\n  /**\n   * @private\n   * @param {String} id\n   * @param {{ fromViewer?: Boolean }} options\n   */\n  _activateTab(id, {\n    fromViewer\n  }) {\n    this.$['*tabId'] = id;\n    if (id === TabId.CROP) {\n      this.$['*faderEl'].deactivate();\n      this.$['*cropperEl'].activate(this.$['*imageSize'], {\n        fromViewer\n      });\n    } else {\n      this.$['*faderEl'].activate({\n        url: this.$['*originalUrl'],\n        fromViewer\n      });\n      this.$['*cropperEl'].deactivate();\n    }\n    for (let tabId of ALL_TABS) {\n      let isCurrentTab = tabId === id;\n      let tabToggleEl = this.ref[`tab-toggle-${tabId}`];\n      tabToggleEl.active = isCurrentTab;\n      if (isCurrentTab) {\n        this._renderControlsList(id);\n        this._syncTabIndicator();\n      } else {\n        this._unmountTabControls(tabId);\n      }\n      this.$[`presence.tabContent.${tabId}`] = isCurrentTab;\n    }\n  }\n\n  /**\n   * @private\n   * @param {String} tabId\n   */\n  _unmountTabControls(tabId) {\n    let listEl = this.ref[`controls-list-${tabId}`];\n    if (listEl) {\n      listEl.innerHTML = '';\n    }\n  }\n\n  /** @private */\n  _syncTabIndicator() {\n    let tabToggleEl = this.ref[`tab-toggle-${this.$['*tabId']}`];\n    let indicatorEl = this.ref['tabs-indicator'];\n    indicatorEl.style.transform = `translateX(${tabToggleEl.offsetLeft}px)`;\n  }\n\n  /** @private */\n  async _preloadEditedImage() {\n    if (this.$['*imgContainerEl'] && this.$['*originalUrl']) {\n      let width = this.$['*imgContainerEl'].offsetWidth;\n      let src = await this.proxyUrl(viewerImageSrc(this.$['*originalUrl'], width, this.$['*editorTransformations']));\n      this._cancelPreload?.();\n      let {\n        cancel\n      } = batchPreloadImages([src]);\n      this._cancelPreload = () => {\n        cancel();\n        this._cancelPreload = undefined;\n      };\n    }\n  }\n\n  /**\n   * @private\n   * @param {boolean} show\n   */\n  _showLoader(show) {\n    this.$.showLoader = show;\n  }\n  _updateInfoTooltip = debounce(() => {\n    const transformations = this.$['*editorTransformations'];\n    /** @type {keyof COLOR_OPERATIONS_CONFIG} */\n    const currentOperation = this.$['*currentOperation'];\n    let text = '';\n    let visible = false;\n    if (this.$['*tabId'] === TabId.FILTERS) {\n      visible = true;\n      if (this.$['*currentFilter'] && transformations?.filter?.name === this.$['*currentFilter']) {\n        let value = transformations?.filter?.amount || 100;\n        text = this.$['*currentFilter'] + ' ' + value;\n      } else {\n        text = this.l10n(FAKE_ORIGINAL_FILTER);\n      }\n    } else if (this.$['*tabId'] === TabId.TUNING && currentOperation) {\n      visible = true;\n      let value = transformations?.[currentOperation] || COLOR_OPERATIONS_CONFIG[currentOperation].zero;\n      text = this.l10n(currentOperation) + ' ' + value;\n    }\n    if (visible) {\n      this.$['*operationTooltip'] = text;\n    }\n    this.ref['tooltip-el'].classList.toggle('uc-info-tooltip_visible', visible);\n  }, 0);\n  initCallback() {\n    super.initCallback();\n    this.$['*sliderEl'] = this.ref['slider-el'];\n    this.sub('*imageSize', imageSize => {\n      if (imageSize) {\n        setTimeout(() => {\n          this._activateTab(this.$['*tabId'], {\n            fromViewer: true\n          });\n        }, 0);\n      }\n    });\n    this.sub('*editorTransformations', editorTransformations => {\n      let appliedFilter = editorTransformations?.filter?.name;\n      if (this.$['*currentFilter'] !== appliedFilter) {\n        this.$['*currentFilter'] = appliedFilter;\n      }\n    });\n    this.sub('*currentFilter', () => {\n      this._updateInfoTooltip();\n    });\n    this.sub('*currentOperation', () => {\n      this._updateInfoTooltip();\n    });\n    this.sub('*tabId', () => {\n      this._updateInfoTooltip();\n    });\n    this.sub('*originalUrl', () => {\n      this.$['*faderEl'] && this.$['*faderEl'].deactivate();\n    });\n    this.sub('*editorTransformations', transformations => {\n      this._preloadEditedImage();\n      if (this.$['*faderEl']) {\n        this.$['*faderEl'].setTransformations(transformations);\n      }\n    });\n    this.sub('*loadingOperations', (/** @type {import('./types.js').LoadingOperations} */loadingOperations) => {\n      let anyLoading = false;\n      for (let [, mapping] of loadingOperations.entries()) {\n        if (anyLoading) {\n          break;\n        }\n        for (let [, loading] of mapping.entries()) {\n          if (loading) {\n            anyLoading = true;\n            break;\n          }\n        }\n      }\n      this._debouncedShowLoader(anyLoading);\n    });\n    this.sub('*showSlider', showSlider => {\n      this.$['presence.subToolbar'] = showSlider;\n      this.$['presence.mainToolbar'] = !showSlider;\n    });\n    this.sub('*tabList', tabList => {\n      this.$['presence.tabToggles'] = tabList.length > 1;\n      for (const tabId of ALL_TABS) {\n        this.$[`presence.tabToggle.${tabId}`] = tabList.includes(tabId);\n        const toggleEl = this.ref[`tab-toggle-${tabId}`];\n        toggleEl.style.gridColumn = tabList.indexOf(tabId) + 1;\n      }\n      if (!tabList.includes(this.$['*tabId'])) {\n        this._activateTab(tabList[0], {\n          fromViewer: false\n        });\n      }\n    });\n    this._updateInfoTooltip();\n  }\n  destroyCallback() {\n    this.$['*showSlider'] = false;\n  }\n}\nEditorToolbar.template = /* HTML */`\n  <uc-line-loader-ui set=\"active: showLoader\"></uc-line-loader-ui>\n  <div class=\"uc-info-tooltip_container\">\n    <div class=\"uc-info-tooltip_wrapper\">\n      <div ref=\"tooltip-el\" class=\"uc-info-tooltip uc-info-tooltip_hidden\">{{*operationTooltip}}</div>\n    </div>\n  </div>\n  <div class=\"uc-toolbar-container\">\n    <uc-presence-toggle\n      role=\"tablist\"\n      class=\"uc-sub-toolbar\"\n      set=\"visible: presence.mainToolbar; styles: presence.subTopToolbarStyles\"\n    >\n      <div class=\"uc-tab-content-row\">${ALL_TABS.map(renderTabContent).join('')}</div>\n      <div class=\"uc-controls-row\">\n        <uc-presence-toggle\n          class=\"uc-tab-toggles\"\n          set=\"visible: presence.tabToggles; styles: presence.tabTogglesStyles\"\n        >\n          <div ref=\"tabs-indicator\" class=\"uc-tab-toggles_indicator\"></div>\n          ${ALL_TABS.map(renderTabToggle).join('')}\n        </uc-presence-toggle>\n        <uc-btn-ui style=\"order: -1\" theme=\"secondary-icon\" icon=\"closeMax\" set=\"onclick: on.cancel; title-prop:cancel\">\n        </uc-btn-ui>\n        <uc-btn-ui theme=\"primary-icon\" icon=\"done\" set=\"onclick: on.apply; title-prop:apply\"> </uc-btn-ui>\n      </div>\n    </uc-presence-toggle>\n    <uc-presence-toggle\n      class=\"uc-sub-toolbar\"\n      set=\"visible: presence.subToolbar; styles: presence.subBottomToolbarStyles\"\n    >\n      <div class=\"uc-slider\">\n        <uc-editor-slider ref=\"slider-el\"></uc-editor-slider>\n      </div>\n      <div class=\"uc-controls-row\">\n        <uc-btn-ui theme=\"secondary\" set=\"onclick: on.cancelSlider\" l10n=\"@text:cancel\"> </uc-btn-ui>\n        <uc-btn-ui theme=\"primary\" set=\"onclick: on.applySlider\" l10n=\"@text:apply\"> </uc-btn-ui>\n      </div>\n    </uc-presence-toggle>\n  </div>\n`;","map":{"version":3,"names":["debounce","Block","EditorCropButtonControl","EditorFilterControl","EditorOperationControl","FAKE_ORIGINAL_FILTER","batchPreloadImages","ALL_COLOR_OPERATIONS","ALL_CROP_OPERATIONS","ALL_FILTERS","ALL_TABS","COLOR_OPERATIONS_CONFIG","TabId","viewerImageSrc","renderTabToggle","id","renderTabContent","EditorToolbar","constructor","init$","Map","showLoader","filters","colorOperations","cropOperations","hidden","visible","on.cancel","_cancelPreload","$","on.apply","on.applySlider","ref","apply","_onSliderClose","on.cancelSlider","cancel","e","currentTarget","getAttribute","_activateTab","fromViewer","tab_role","TUNING","CROP","FILTERS","_debouncedShowLoader","_showLoader","bind","classList","toggle","_createOperationControl","operation","el","_createFilterControl","filter","_createToggleControl","_renderControlsList","tabId","listEl","fr","document","createDocumentFragment","forEach","appendChild","filterId","children","idx","childNodes","length","add","innerHTML","deactivate","activate","url","isCurrentTab","tabToggleEl","active","_syncTabIndicator","_unmountTabControls","indicatorEl","style","transform","offsetLeft","_preloadEditedImage","width","offsetWidth","src","proxyUrl","undefined","show","_updateInfoTooltip","transformations","currentOperation","text","name","value","amount","l10n","zero","initCallback","sub","imageSize","setTimeout","editorTransformations","appliedFilter","setTransformations","loadingOperations","anyLoading","mapping","entries","loading","showSlider","tabList","includes","toggleEl","gridColumn","indexOf","destroyCallback","template","map","join"],"sources":["/Users/kavinth/Documents/GitHub/Smart-Alert/Smart-Alert-new/frontend/node_modules/@uploadcare/file-uploader/blocks/CloudImageEditor/src/EditorToolbar.js"],"sourcesContent":["// @ts-check\nimport { debounce } from '../../utils/debounce.js';\nimport { Block } from '../../../abstract/Block.js';\nimport { EditorCropButtonControl } from './EditorCropButtonControl.js';\nimport { EditorFilterControl } from './EditorFilterControl.js';\nimport { EditorOperationControl } from './EditorOperationControl.js';\nimport { FAKE_ORIGINAL_FILTER } from './EditorSlider.js';\nimport { batchPreloadImages } from '../../utils/preloadImage.js';\nimport {\n  ALL_COLOR_OPERATIONS,\n  ALL_CROP_OPERATIONS,\n  ALL_FILTERS,\n  ALL_TABS,\n  COLOR_OPERATIONS_CONFIG,\n  TabId,\n} from './toolbar-constants.js';\nimport { viewerImageSrc } from './util.js';\n\n/** @param {String} id */\nfunction renderTabToggle(id) {\n  return /* HTML */ `\n    <uc-presence-toggle\n      class=\"uc-tab-toggle\"\n      set=\"visible: presence.tabToggle.${id}; styles: presence.tabToggleStyles;\"\n    >\n      <uc-btn-ui\n        theme=\"tab\"\n        ref=\"tab-toggle-${id}\"\n        data-id=\"${id}\"\n        icon=\"${id}\"\n        set=\"onclick: on.clickTab; aria-role:tab_role; aria-controls:tab_${id}; title-prop: a11y-editor-tab-${id}\"\n      >\n      </uc-btn-ui>\n    </uc-presence-toggle>\n  `;\n}\n\n/** @param {String} id */\nfunction renderTabContent(id) {\n  return /* HTML */ `\n    <uc-presence-toggle\n      id=\"tab_${id}\"\n      class=\"uc-tab-content\"\n      set=\"visible: presence.tabContent.${id}; styles: presence.tabContentStyles\"\n    >\n      <uc-editor-scroller hidden-scrollbar>\n        <div class=\"uc-controls-list_align\">\n          <div\n            role=\"listbox\"\n            aria-orientation=\"horizontal\"\n            class=\"uc-controls-list_inner\"\n            ref=\"controls-list-${id}\"\n          ></div>\n        </div>\n      </uc-editor-scroller>\n    </uc-presence-toggle>\n  `;\n}\n\nexport class EditorToolbar extends Block {\n  constructor() {\n    super();\n\n    this.init$ = {\n      ...this.init$,\n      '*sliderEl': null,\n      /** @type {import('./types.js').LoadingOperations} */\n      '*loadingOperations': new Map(),\n      '*showSlider': false,\n      '*currentFilter': FAKE_ORIGINAL_FILTER,\n      '*currentOperation': null,\n      showLoader: false,\n      filters: ALL_FILTERS,\n      colorOperations: ALL_COLOR_OPERATIONS,\n      cropOperations: ALL_CROP_OPERATIONS,\n      '*operationTooltip': null,\n\n      'presence.mainToolbar': true,\n      'presence.subToolbar': false,\n      'presence.tabToggles': true,\n      'presence.tabContent.crop': false,\n      'presence.tabContent.tuning': false,\n      'presence.tabContent.filters': false,\n      'presence.tabToggle.crop': true,\n      'presence.tabToggle.tuning': true,\n      'presence.tabToggle.filters': true,\n      'presence.subTopToolbarStyles': {\n        hidden: 'uc-sub-toolbar--top-hidden',\n        visible: 'uc-sub-toolbar--visible',\n      },\n      'presence.subBottomToolbarStyles': {\n        hidden: 'uc-sub-toolbar--bottom-hidden',\n        visible: 'uc-sub-toolbar--visible',\n      },\n      'presence.tabContentStyles': {\n        hidden: 'uc-tab-content--hidden',\n        visible: 'uc-tab-content--visible',\n      },\n      'presence.tabToggleStyles': {\n        hidden: 'uc-tab-toggle--hidden',\n        visible: 'uc-tab-toggle--visible',\n      },\n      'presence.tabTogglesStyles': {\n        hidden: 'uc-tab-toggles--hidden',\n        visible: 'uc-tab-toggles--visible',\n      },\n      'on.cancel': () => {\n        this._cancelPreload?.();\n        this.$['*on.cancel']();\n      },\n      'on.apply': () => {\n        this.$['*on.apply'](this.$['*editorTransformations']);\n      },\n      'on.applySlider': () => {\n        this.ref['slider-el'].apply();\n        this._onSliderClose();\n      },\n      'on.cancelSlider': () => {\n        this.ref['slider-el'].cancel();\n        this._onSliderClose();\n      },\n      /** @param {MouseEvent} e */\n      'on.clickTab': (e) => {\n        const id = /** @type {HTMLElement} */ (e.currentTarget).getAttribute('data-id');\n        if (id) {\n          this._activateTab(id, { fromViewer: false });\n        }\n      },\n      tab_role: 'tab',\n      [`tab_${TabId.TUNING}`]: `tab_${TabId.TUNING}`,\n      [`tab_${TabId.CROP}`]: `tab_${TabId.CROP}`,\n      [`tab_${TabId.FILTERS}`]: `tab_${TabId.FILTERS}`,\n      cancel: 'cancel',\n      apply: 'apply',\n      'a11y-editor-tab-filters': 'a11y-editor-tab-filters',\n      'a11y-editor-tab-tuning': 'a11y-editor-tab-tuning',\n      'a11y-editor-tab-crop': 'a11y-editor-tab-crop',\n    };\n\n    /** @private */\n\n    this._debouncedShowLoader = debounce(this._showLoader.bind(this), 500);\n  }\n\n  /** @private */\n  _onSliderClose() {\n    this.$['*showSlider'] = false;\n    if (this.$['*tabId'] === TabId.TUNING) {\n      this.ref['tooltip-el'].classList.toggle('uc-info-tooltip_visible', false);\n    }\n  }\n\n  /**\n   * @private\n   * @param {String} operation\n   */\n  _createOperationControl(operation) {\n    let el = new EditorOperationControl();\n    // @ts-expect-error TODO: fix\n    el.operation = operation;\n    return el;\n  }\n\n  /**\n   * @private\n   * @param {String} filter\n   */\n  _createFilterControl(filter) {\n    let el = new EditorFilterControl();\n    // @ts-expect-error TODO: fix\n    el.filter = filter;\n    return el;\n  }\n\n  /**\n   * @private\n   * @param {String} operation\n   */\n  _createToggleControl(operation) {\n    let el = new EditorCropButtonControl();\n    // @ts-expect-error TODO: fix\n    el.operation = operation;\n    return el;\n  }\n\n  /**\n   * @private\n   * @param {String} tabId\n   */\n  _renderControlsList(tabId) {\n    let listEl = this.ref[`controls-list-${tabId}`];\n    let fr = document.createDocumentFragment();\n\n    if (tabId === TabId.CROP) {\n      this.$.cropOperations.forEach(\n        /** @param {string} operation */ (operation) => {\n          let el = this._createToggleControl(operation);\n          // @ts-ignore\n          fr.appendChild(el);\n        },\n      );\n    } else if (tabId === TabId.FILTERS) {\n      [FAKE_ORIGINAL_FILTER, ...this.$.filters].forEach((filterId) => {\n        let el = this._createFilterControl(filterId);\n        // @ts-ignore\n        fr.appendChild(el);\n      });\n    } else if (tabId === TabId.TUNING) {\n      this.$.colorOperations.forEach(\n        /** @param {string} operation */ (operation) => {\n          let el = this._createOperationControl(operation);\n          // @ts-ignore\n          fr.appendChild(el);\n        },\n      );\n    }\n\n    [...fr.children].forEach((el, idx) => {\n      if (idx === fr.childNodes.length - 1) {\n        el.classList.add('uc-controls-list_last-item');\n      }\n    });\n\n    listEl.innerHTML = '';\n    listEl.appendChild(fr);\n  }\n\n  /**\n   * @private\n   * @param {String} id\n   * @param {{ fromViewer?: Boolean }} options\n   */\n  _activateTab(id, { fromViewer }) {\n    this.$['*tabId'] = id;\n\n    if (id === TabId.CROP) {\n      this.$['*faderEl'].deactivate();\n      this.$['*cropperEl'].activate(this.$['*imageSize'], { fromViewer });\n    } else {\n      this.$['*faderEl'].activate({ url: this.$['*originalUrl'], fromViewer });\n      this.$['*cropperEl'].deactivate();\n    }\n\n    for (let tabId of ALL_TABS) {\n      let isCurrentTab = tabId === id;\n\n      let tabToggleEl = this.ref[`tab-toggle-${tabId}`];\n      tabToggleEl.active = isCurrentTab;\n\n      if (isCurrentTab) {\n        this._renderControlsList(id);\n        this._syncTabIndicator();\n      } else {\n        this._unmountTabControls(tabId);\n      }\n      this.$[`presence.tabContent.${tabId}`] = isCurrentTab;\n    }\n  }\n\n  /**\n   * @private\n   * @param {String} tabId\n   */\n  _unmountTabControls(tabId) {\n    let listEl = this.ref[`controls-list-${tabId}`];\n    if (listEl) {\n      listEl.innerHTML = '';\n    }\n  }\n\n  /** @private */\n  _syncTabIndicator() {\n    let tabToggleEl = this.ref[`tab-toggle-${this.$['*tabId']}`];\n    let indicatorEl = this.ref['tabs-indicator'];\n    indicatorEl.style.transform = `translateX(${tabToggleEl.offsetLeft}px)`;\n  }\n\n  /** @private */\n  async _preloadEditedImage() {\n    if (this.$['*imgContainerEl'] && this.$['*originalUrl']) {\n      let width = this.$['*imgContainerEl'].offsetWidth;\n      let src = await this.proxyUrl(viewerImageSrc(this.$['*originalUrl'], width, this.$['*editorTransformations']));\n      this._cancelPreload?.();\n      let { cancel } = batchPreloadImages([src]);\n      this._cancelPreload = () => {\n        cancel();\n        this._cancelPreload = undefined;\n      };\n    }\n  }\n\n  /**\n   * @private\n   * @param {boolean} show\n   */\n  _showLoader(show) {\n    this.$.showLoader = show;\n  }\n\n  _updateInfoTooltip = debounce(() => {\n    const transformations = this.$['*editorTransformations'];\n    /** @type {keyof COLOR_OPERATIONS_CONFIG} */\n    const currentOperation = this.$['*currentOperation'];\n    let text = '';\n    let visible = false;\n\n    if (this.$['*tabId'] === TabId.FILTERS) {\n      visible = true;\n      if (this.$['*currentFilter'] && transformations?.filter?.name === this.$['*currentFilter']) {\n        let value = transformations?.filter?.amount || 100;\n        text = this.$['*currentFilter'] + ' ' + value;\n      } else {\n        text = this.l10n(FAKE_ORIGINAL_FILTER);\n      }\n    } else if (this.$['*tabId'] === TabId.TUNING && currentOperation) {\n      visible = true;\n      let value = transformations?.[currentOperation] || COLOR_OPERATIONS_CONFIG[currentOperation].zero;\n      text = this.l10n(currentOperation) + ' ' + value;\n    }\n    if (visible) {\n      this.$['*operationTooltip'] = text;\n    }\n    this.ref['tooltip-el'].classList.toggle('uc-info-tooltip_visible', visible);\n  }, 0);\n\n  initCallback() {\n    super.initCallback();\n\n    this.$['*sliderEl'] = this.ref['slider-el'];\n\n    this.sub('*imageSize', (imageSize) => {\n      if (imageSize) {\n        setTimeout(() => {\n          this._activateTab(this.$['*tabId'], { fromViewer: true });\n        }, 0);\n      }\n    });\n\n    this.sub('*editorTransformations', (editorTransformations) => {\n      let appliedFilter = editorTransformations?.filter?.name;\n      if (this.$['*currentFilter'] !== appliedFilter) {\n        this.$['*currentFilter'] = appliedFilter;\n      }\n    });\n\n    this.sub('*currentFilter', () => {\n      this._updateInfoTooltip();\n    });\n\n    this.sub('*currentOperation', () => {\n      this._updateInfoTooltip();\n    });\n\n    this.sub('*tabId', () => {\n      this._updateInfoTooltip();\n    });\n\n    this.sub('*originalUrl', () => {\n      this.$['*faderEl'] && this.$['*faderEl'].deactivate();\n    });\n\n    this.sub('*editorTransformations', (transformations) => {\n      this._preloadEditedImage();\n      if (this.$['*faderEl']) {\n        this.$['*faderEl'].setTransformations(transformations);\n      }\n    });\n\n    this.sub('*loadingOperations', (/** @type {import('./types.js').LoadingOperations} */ loadingOperations) => {\n      let anyLoading = false;\n      for (let [, mapping] of loadingOperations.entries()) {\n        if (anyLoading) {\n          break;\n        }\n        for (let [, loading] of mapping.entries()) {\n          if (loading) {\n            anyLoading = true;\n            break;\n          }\n        }\n      }\n      this._debouncedShowLoader(anyLoading);\n    });\n\n    this.sub('*showSlider', (showSlider) => {\n      this.$['presence.subToolbar'] = showSlider;\n      this.$['presence.mainToolbar'] = !showSlider;\n    });\n\n    this.sub('*tabList', (tabList) => {\n      this.$['presence.tabToggles'] = tabList.length > 1;\n      for (const tabId of ALL_TABS) {\n        this.$[`presence.tabToggle.${tabId}`] = tabList.includes(tabId);\n        const toggleEl = this.ref[`tab-toggle-${tabId}`];\n        toggleEl.style.gridColumn = tabList.indexOf(tabId) + 1;\n      }\n\n      if (!tabList.includes(this.$['*tabId'])) {\n        this._activateTab(tabList[0], { fromViewer: false });\n      }\n    });\n\n    this._updateInfoTooltip();\n  }\n\n  destroyCallback() {\n    this.$['*showSlider'] = false;\n  }\n}\n\nEditorToolbar.template = /* HTML */ `\n  <uc-line-loader-ui set=\"active: showLoader\"></uc-line-loader-ui>\n  <div class=\"uc-info-tooltip_container\">\n    <div class=\"uc-info-tooltip_wrapper\">\n      <div ref=\"tooltip-el\" class=\"uc-info-tooltip uc-info-tooltip_hidden\">{{*operationTooltip}}</div>\n    </div>\n  </div>\n  <div class=\"uc-toolbar-container\">\n    <uc-presence-toggle\n      role=\"tablist\"\n      class=\"uc-sub-toolbar\"\n      set=\"visible: presence.mainToolbar; styles: presence.subTopToolbarStyles\"\n    >\n      <div class=\"uc-tab-content-row\">${ALL_TABS.map(renderTabContent).join('')}</div>\n      <div class=\"uc-controls-row\">\n        <uc-presence-toggle\n          class=\"uc-tab-toggles\"\n          set=\"visible: presence.tabToggles; styles: presence.tabTogglesStyles\"\n        >\n          <div ref=\"tabs-indicator\" class=\"uc-tab-toggles_indicator\"></div>\n          ${ALL_TABS.map(renderTabToggle).join('')}\n        </uc-presence-toggle>\n        <uc-btn-ui style=\"order: -1\" theme=\"secondary-icon\" icon=\"closeMax\" set=\"onclick: on.cancel; title-prop:cancel\">\n        </uc-btn-ui>\n        <uc-btn-ui theme=\"primary-icon\" icon=\"done\" set=\"onclick: on.apply; title-prop:apply\"> </uc-btn-ui>\n      </div>\n    </uc-presence-toggle>\n    <uc-presence-toggle\n      class=\"uc-sub-toolbar\"\n      set=\"visible: presence.subToolbar; styles: presence.subBottomToolbarStyles\"\n    >\n      <div class=\"uc-slider\">\n        <uc-editor-slider ref=\"slider-el\"></uc-editor-slider>\n      </div>\n      <div class=\"uc-controls-row\">\n        <uc-btn-ui theme=\"secondary\" set=\"onclick: on.cancelSlider\" l10n=\"@text:cancel\"> </uc-btn-ui>\n        <uc-btn-ui theme=\"primary\" set=\"onclick: on.applySlider\" l10n=\"@text:apply\"> </uc-btn-ui>\n      </div>\n    </uc-presence-toggle>\n  </div>\n`;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
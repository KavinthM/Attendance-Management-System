{"ast":null,"code":"// @ts-check\nimport { debounce } from '../blocks/utils/debounce.js';\nimport { resolveLocaleDefinition } from './localeRegistry.js';\nimport { default as en } from '../locales/file-uploader/en.js';\n\n/** @param {string} key */\nexport const localeStateKey = key => `*l10n/${key}`;\nexport const DEFAULT_LOCALE = 'en';\nexport class LocaleManager {\n  /**\n   * @private\n   * @type {import('./Block.js').Block | null}\n   */\n  _blockInstance = null;\n\n  /** @private */\n  _localeName = '';\n\n  /**\n   * @private\n   * @type {Set<() => void>}\n   */\n  _callbacks = new Set();\n\n  /**\n   * @private\n   * @type {Map<import('./Block.js').Block, Map<string, () => void>>}\n   */\n  _boundBlocks = new Map();\n\n  /** @param {import('./Block.js').Block} blockInstance */\n  constructor(blockInstance) {\n    this._blockInstance = blockInstance;\n    for (let [key, value] of Object.entries(en)) {\n      const noTranslation = this._blockInstance.has(localeStateKey(key)) ? !this._blockInstance.$[localeStateKey(key)] : true;\n      this._blockInstance.add(localeStateKey(key), value, noTranslation);\n    }\n    setTimeout(() => {\n      blockInstance.subConfigValue('localeName', async localeName => {\n        if (!this._blockInstance || !localeName) {\n          return;\n        }\n        this._localeName = localeName;\n        const definition = await resolveLocaleDefinition(localeName);\n        if (localeName !== DEFAULT_LOCALE && this._localeName !== localeName) {\n          return;\n        }\n        const overrides = this._blockInstance.cfg.localeDefinitionOverride?.[localeName];\n        for (const [key, value] of Object.entries(definition)) {\n          const overriddenValue = overrides?.[key];\n          this._blockInstance.add(localeStateKey(key), overriddenValue ?? value, true);\n          for (const callback of this._callbacks) {\n            callback();\n          }\n        }\n      });\n      blockInstance.subConfigValue('localeDefinitionOverride', localeDefinitionOverride => {\n        if (!localeDefinitionOverride) {\n          return;\n        }\n        const definition = localeDefinitionOverride[this._localeName];\n        if (!definition) {\n          return;\n        }\n        for (const [key, value] of Object.entries(definition)) {\n          this._blockInstance?.add(localeStateKey(key), value, true);\n          for (const callback of this._callbacks) {\n            callback();\n          }\n        }\n      });\n    });\n  }\n\n  /**\n   * @param {() => void} callback\n   * @returns {() => void}\n   */\n  onLocaleChange(callback) {\n    const debouncedCb = debounce(callback, 0);\n    this._callbacks.add(debouncedCb);\n    return () => {\n      this._callbacks.delete(debouncedCb);\n    };\n  }\n\n  /**\n   * @param {import('./Block.js').Block} block\n   * @param {string} key\n   * @param {() => void} resolver\n   */\n  bindL10n(block, key, resolver) {\n    block.$[key] = resolver();\n    if (!this._boundBlocks.has(block)) {\n      this._boundBlocks.set(block, new Map());\n    }\n    this._boundBlocks.get(block)?.get(key)?.();\n    const destroyCallback = this.onLocaleChange(() => {\n      block.$[key] = resolver();\n    });\n    this._boundBlocks.get(block)?.set(key, destroyCallback);\n  }\n\n  /** @param {import('./Block.js').Block} block */\n  destroyL10nBindings(block) {\n    const callbacks = this._boundBlocks.get(block);\n    if (!callbacks) {\n      return;\n    }\n    for (const callback of callbacks.values()) {\n      callback();\n    }\n    this._boundBlocks.delete(block);\n  }\n  destroy() {\n    this._callbacks.clear();\n  }\n}","map":{"version":3,"names":["debounce","resolveLocaleDefinition","default","en","localeStateKey","key","DEFAULT_LOCALE","LocaleManager","_blockInstance","_localeName","_callbacks","Set","_boundBlocks","Map","constructor","blockInstance","value","Object","entries","noTranslation","has","$","add","setTimeout","subConfigValue","localeName","definition","overrides","cfg","localeDefinitionOverride","overriddenValue","callback","onLocaleChange","debouncedCb","delete","bindL10n","block","resolver","set","get","destroyCallback","destroyL10nBindings","callbacks","values","destroy","clear"],"sources":["/Users/kavinth/Documents/GitHub/Smart-Alert/Smart-Alert-new/frontend/node_modules/@uploadcare/file-uploader/abstract/LocaleManager.js"],"sourcesContent":["// @ts-check\nimport { debounce } from '../blocks/utils/debounce.js';\nimport { resolveLocaleDefinition } from './localeRegistry.js';\nimport { default as en } from '../locales/file-uploader/en.js';\n\n/** @param {string} key */\nexport const localeStateKey = (key) => `*l10n/${key}`;\nexport const DEFAULT_LOCALE = 'en';\n\nexport class LocaleManager {\n  /**\n   * @private\n   * @type {import('./Block.js').Block | null}\n   */\n  _blockInstance = null;\n\n  /** @private */\n  _localeName = '';\n\n  /**\n   * @private\n   * @type {Set<() => void>}\n   */\n  _callbacks = new Set();\n\n  /**\n   * @private\n   * @type {Map<import('./Block.js').Block, Map<string, () => void>>}\n   */\n  _boundBlocks = new Map();\n\n  /** @param {import('./Block.js').Block} blockInstance */\n  constructor(blockInstance) {\n    this._blockInstance = blockInstance;\n\n    for (let [key, value] of Object.entries(en)) {\n      const noTranslation = this._blockInstance.has(localeStateKey(key))\n        ? !this._blockInstance.$[localeStateKey(key)]\n        : true;\n      this._blockInstance.add(localeStateKey(key), value, noTranslation);\n    }\n\n    setTimeout(() => {\n      blockInstance.subConfigValue('localeName', async (localeName) => {\n        if (!this._blockInstance || !localeName) {\n          return;\n        }\n        this._localeName = localeName;\n        const definition = await resolveLocaleDefinition(localeName);\n        if (localeName !== DEFAULT_LOCALE && this._localeName !== localeName) {\n          return;\n        }\n\n        const overrides = this._blockInstance.cfg.localeDefinitionOverride?.[localeName];\n        for (const [key, value] of Object.entries(definition)) {\n          const overriddenValue = overrides?.[key];\n          this._blockInstance.add(localeStateKey(key), overriddenValue ?? value, true);\n          for (const callback of this._callbacks) {\n            callback();\n          }\n        }\n      });\n\n      blockInstance.subConfigValue('localeDefinitionOverride', (localeDefinitionOverride) => {\n        if (!localeDefinitionOverride) {\n          return;\n        }\n        const definition = localeDefinitionOverride[this._localeName];\n        if (!definition) {\n          return;\n        }\n        for (const [key, value] of Object.entries(definition)) {\n          this._blockInstance?.add(localeStateKey(key), value, true);\n          for (const callback of this._callbacks) {\n            callback();\n          }\n        }\n      });\n    });\n  }\n\n  /**\n   * @param {() => void} callback\n   * @returns {() => void}\n   */\n  onLocaleChange(callback) {\n    const debouncedCb = debounce(callback, 0);\n    this._callbacks.add(debouncedCb);\n    return () => {\n      this._callbacks.delete(debouncedCb);\n    };\n  }\n\n  /**\n   * @param {import('./Block.js').Block} block\n   * @param {string} key\n   * @param {() => void} resolver\n   */\n  bindL10n(block, key, resolver) {\n    block.$[key] = resolver();\n\n    if (!this._boundBlocks.has(block)) {\n      this._boundBlocks.set(block, new Map());\n    }\n\n    this._boundBlocks.get(block)?.get(key)?.();\n\n    const destroyCallback = this.onLocaleChange(() => {\n      block.$[key] = resolver();\n    });\n\n    this._boundBlocks.get(block)?.set(key, destroyCallback);\n  }\n\n  /** @param {import('./Block.js').Block} block */\n  destroyL10nBindings(block) {\n    const callbacks = this._boundBlocks.get(block);\n    if (!callbacks) {\n      return;\n    }\n    for (const callback of callbacks.values()) {\n      callback();\n    }\n    this._boundBlocks.delete(block);\n  }\n\n  destroy() {\n    this._callbacks.clear();\n  }\n}\n"],"mappings":"AAAA;AACA,SAASA,QAAQ,QAAQ,6BAA6B;AACtD,SAASC,uBAAuB,QAAQ,qBAAqB;AAC7D,SAASC,OAAO,IAAIC,EAAE,QAAQ,gCAAgC;;AAE9D;AACA,OAAO,MAAMC,cAAc,GAAIC,GAAG,IAAK,SAASA,GAAG,EAAE;AACrD,OAAO,MAAMC,cAAc,GAAG,IAAI;AAElC,OAAO,MAAMC,aAAa,CAAC;EACzB;AACF;AACA;AACA;EACEC,cAAc,GAAG,IAAI;;EAErB;EACAC,WAAW,GAAG,EAAE;;EAEhB;AACF;AACA;AACA;EACEC,UAAU,GAAG,IAAIC,GAAG,CAAC,CAAC;;EAEtB;AACF;AACA;AACA;EACEC,YAAY,GAAG,IAAIC,GAAG,CAAC,CAAC;;EAExB;EACAC,WAAWA,CAACC,aAAa,EAAE;IACzB,IAAI,CAACP,cAAc,GAAGO,aAAa;IAEnC,KAAK,IAAI,CAACV,GAAG,EAAEW,KAAK,CAAC,IAAIC,MAAM,CAACC,OAAO,CAACf,EAAE,CAAC,EAAE;MAC3C,MAAMgB,aAAa,GAAG,IAAI,CAACX,cAAc,CAACY,GAAG,CAAChB,cAAc,CAACC,GAAG,CAAC,CAAC,GAC9D,CAAC,IAAI,CAACG,cAAc,CAACa,CAAC,CAACjB,cAAc,CAACC,GAAG,CAAC,CAAC,GAC3C,IAAI;MACR,IAAI,CAACG,cAAc,CAACc,GAAG,CAAClB,cAAc,CAACC,GAAG,CAAC,EAAEW,KAAK,EAAEG,aAAa,CAAC;IACpE;IAEAI,UAAU,CAAC,MAAM;MACfR,aAAa,CAACS,cAAc,CAAC,YAAY,EAAE,MAAOC,UAAU,IAAK;QAC/D,IAAI,CAAC,IAAI,CAACjB,cAAc,IAAI,CAACiB,UAAU,EAAE;UACvC;QACF;QACA,IAAI,CAAChB,WAAW,GAAGgB,UAAU;QAC7B,MAAMC,UAAU,GAAG,MAAMzB,uBAAuB,CAACwB,UAAU,CAAC;QAC5D,IAAIA,UAAU,KAAKnB,cAAc,IAAI,IAAI,CAACG,WAAW,KAAKgB,UAAU,EAAE;UACpE;QACF;QAEA,MAAME,SAAS,GAAG,IAAI,CAACnB,cAAc,CAACoB,GAAG,CAACC,wBAAwB,GAAGJ,UAAU,CAAC;QAChF,KAAK,MAAM,CAACpB,GAAG,EAAEW,KAAK,CAAC,IAAIC,MAAM,CAACC,OAAO,CAACQ,UAAU,CAAC,EAAE;UACrD,MAAMI,eAAe,GAAGH,SAAS,GAAGtB,GAAG,CAAC;UACxC,IAAI,CAACG,cAAc,CAACc,GAAG,CAAClB,cAAc,CAACC,GAAG,CAAC,EAAEyB,eAAe,IAAId,KAAK,EAAE,IAAI,CAAC;UAC5E,KAAK,MAAMe,QAAQ,IAAI,IAAI,CAACrB,UAAU,EAAE;YACtCqB,QAAQ,CAAC,CAAC;UACZ;QACF;MACF,CAAC,CAAC;MAEFhB,aAAa,CAACS,cAAc,CAAC,0BAA0B,EAAGK,wBAAwB,IAAK;QACrF,IAAI,CAACA,wBAAwB,EAAE;UAC7B;QACF;QACA,MAAMH,UAAU,GAAGG,wBAAwB,CAAC,IAAI,CAACpB,WAAW,CAAC;QAC7D,IAAI,CAACiB,UAAU,EAAE;UACf;QACF;QACA,KAAK,MAAM,CAACrB,GAAG,EAAEW,KAAK,CAAC,IAAIC,MAAM,CAACC,OAAO,CAACQ,UAAU,CAAC,EAAE;UACrD,IAAI,CAAClB,cAAc,EAAEc,GAAG,CAAClB,cAAc,CAACC,GAAG,CAAC,EAAEW,KAAK,EAAE,IAAI,CAAC;UAC1D,KAAK,MAAMe,QAAQ,IAAI,IAAI,CAACrB,UAAU,EAAE;YACtCqB,QAAQ,CAAC,CAAC;UACZ;QACF;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;;EAEA;AACF;AACA;AACA;EACEC,cAAcA,CAACD,QAAQ,EAAE;IACvB,MAAME,WAAW,GAAGjC,QAAQ,CAAC+B,QAAQ,EAAE,CAAC,CAAC;IACzC,IAAI,CAACrB,UAAU,CAACY,GAAG,CAACW,WAAW,CAAC;IAChC,OAAO,MAAM;MACX,IAAI,CAACvB,UAAU,CAACwB,MAAM,CAACD,WAAW,CAAC;IACrC,CAAC;EACH;;EAEA;AACF;AACA;AACA;AACA;EACEE,QAAQA,CAACC,KAAK,EAAE/B,GAAG,EAAEgC,QAAQ,EAAE;IAC7BD,KAAK,CAACf,CAAC,CAAChB,GAAG,CAAC,GAAGgC,QAAQ,CAAC,CAAC;IAEzB,IAAI,CAAC,IAAI,CAACzB,YAAY,CAACQ,GAAG,CAACgB,KAAK,CAAC,EAAE;MACjC,IAAI,CAACxB,YAAY,CAAC0B,GAAG,CAACF,KAAK,EAAE,IAAIvB,GAAG,CAAC,CAAC,CAAC;IACzC;IAEA,IAAI,CAACD,YAAY,CAAC2B,GAAG,CAACH,KAAK,CAAC,EAAEG,GAAG,CAAClC,GAAG,CAAC,GAAG,CAAC;IAE1C,MAAMmC,eAAe,GAAG,IAAI,CAACR,cAAc,CAAC,MAAM;MAChDI,KAAK,CAACf,CAAC,CAAChB,GAAG,CAAC,GAAGgC,QAAQ,CAAC,CAAC;IAC3B,CAAC,CAAC;IAEF,IAAI,CAACzB,YAAY,CAAC2B,GAAG,CAACH,KAAK,CAAC,EAAEE,GAAG,CAACjC,GAAG,EAAEmC,eAAe,CAAC;EACzD;;EAEA;EACAC,mBAAmBA,CAACL,KAAK,EAAE;IACzB,MAAMM,SAAS,GAAG,IAAI,CAAC9B,YAAY,CAAC2B,GAAG,CAACH,KAAK,CAAC;IAC9C,IAAI,CAACM,SAAS,EAAE;MACd;IACF;IACA,KAAK,MAAMX,QAAQ,IAAIW,SAAS,CAACC,MAAM,CAAC,CAAC,EAAE;MACzCZ,QAAQ,CAAC,CAAC;IACZ;IACA,IAAI,CAACnB,YAAY,CAACsB,MAAM,CAACE,KAAK,CAAC;EACjC;EAEAQ,OAAOA,CAAA,EAAG;IACR,IAAI,CAAClC,UAAU,CAACmC,KAAK,CAAC,CAAC;EACzB;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"// @ts-check\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { browserFeatures } from '../../utils/browser-info.js';\nimport { CameraSourceTypes } from '../CameraSource/constants.js';\nimport { ExternalUploadSource, UploadSource, UploadSourceMobile } from '../utils/UploadSource.js';\nconst L10N_PREFIX = 'src-type-';\n\n/**\n * @typedef {{\n *   type: string;\n *   activity?: string;\n *   textKey?: string;\n *   icon?: string;\n *   activate?: () => boolean;\n *   activityParams?: Record<string, unknown>;\n * }} TConfig\n */\n\nexport class SourceBtn extends UploaderBlock {\n  couldBeCtxOwner = true;\n  /** @type {string | undefined} */\n  type = undefined;\n  /**\n   * @private\n   * @type {Record<string, TConfig>}\n   */\n  _registeredTypes = {};\n  constructor() {\n    super();\n    this.init$ = {\n      ...this.init$,\n      iconName: 'default',\n      'src-type': ''\n    };\n  }\n  initTypes() {\n    this.registerType({\n      type: UploadSource.LOCAL,\n      activate: () => {\n        this.api.openSystemDialog();\n        return false;\n      }\n    });\n    this.registerType({\n      type: UploadSource.URL,\n      activity: ActivityBlock.activities.URL,\n      textKey: 'from-url'\n    });\n    this.registerType({\n      type: UploadSource.CAMERA,\n      activity: ActivityBlock.activities.CAMERA,\n      activate: () => {\n        const supportsCapture = browserFeatures.htmlMediaCapture;\n        if (supportsCapture) {\n          this.api.openSystemDialog({\n            captureCamera: true\n          });\n        }\n        return !supportsCapture;\n      }\n    });\n    this.registerType({\n      type: 'draw',\n      activity: ActivityBlock.activities.DRAW,\n      icon: 'edit-draw'\n    });\n    for (let mobileSourceType of Object.values(UploadSourceMobile)) {\n      this.registerType({\n        type: mobileSourceType,\n        activity: ActivityBlock.activities.CAMERA,\n        activate: () => {\n          const supportsCapture = browserFeatures.htmlMediaCapture;\n          if (supportsCapture) {\n            this.api.openSystemDialog({\n              captureCamera: true,\n              modeCamera: mobileSourceType === 'mobile-photo-camera' ? CameraSourceTypes.PHOTO : CameraSourceTypes.VIDEO\n            });\n          }\n          return !supportsCapture;\n        }\n      });\n    }\n    for (let externalSourceType of Object.values(ExternalUploadSource)) {\n      this.registerType({\n        type: externalSourceType,\n        activity: ActivityBlock.activities.EXTERNAL,\n        activityParams: {\n          externalSourceType: externalSourceType\n        }\n      });\n    }\n  }\n  initCallback() {\n    super.initCallback();\n    this.initTypes();\n    this.defineAccessor('type', /** @param {string} val */\n    val => {\n      if (!val) {\n        return;\n      }\n      this.applyType(val);\n    });\n  }\n\n  /** @param {TConfig} typeConfig */\n  registerType(typeConfig) {\n    this._registeredTypes[typeConfig.type] = typeConfig;\n  }\n\n  /** @param {string} type */\n  getType(type) {\n    return this._registeredTypes[type];\n  }\n  activate() {\n    if (!this.type) {\n      return;\n    }\n    const configType = this._registeredTypes[this.type];\n    const {\n      activity,\n      activate,\n      activityParams = {}\n    } = configType;\n    const showActivity = activate ? activate() : !!activity;\n    if (showActivity) {\n      this.modalManager.open(/** @type {string} */activity);\n      this.set$({\n        '*currentActivityParams': activityParams,\n        '*currentActivity': activity\n      });\n    }\n  }\n\n  /** @param {string} type */\n  applyType(type) {\n    const configType = this._registeredTypes[type];\n    if (!configType) {\n      console.warn('Unsupported source type: ' + type);\n      return;\n    }\n    const {\n      textKey = type,\n      icon = type\n    } = configType;\n    this.$['src-type'] = `${L10N_PREFIX}${textKey}`;\n    this.$.iconName = icon;\n    this.onclick = () => {\n      this.activate();\n    };\n  }\n}\nSourceBtn.template = /* HTML */`\n  <button type=\"button\">\n    <uc-icon set=\"@name: iconName\"></uc-icon>\n    <div class=\"uc-txt\" l10n=\"src-type\"></div>\n  </button>\n`;\nSourceBtn.bindAttributes({\n  // @ts-expect-error symbiote types bug\n  type: null\n});","map":{"version":3,"names":["ActivityBlock","UploaderBlock","browserFeatures","CameraSourceTypes","ExternalUploadSource","UploadSource","UploadSourceMobile","L10N_PREFIX","SourceBtn","couldBeCtxOwner","type","undefined","_registeredTypes","constructor","init$","iconName","initTypes","registerType","LOCAL","activate","api","openSystemDialog","URL","activity","activities","textKey","CAMERA","supportsCapture","htmlMediaCapture","captureCamera","DRAW","icon","mobileSourceType","Object","values","modeCamera","PHOTO","VIDEO","externalSourceType","EXTERNAL","activityParams","initCallback","defineAccessor","val","applyType","typeConfig","getType","configType","showActivity","modalManager","open","set$","console","warn","$","onclick","template","bindAttributes"],"sources":["/Users/kavinth/Documents/GitHub/Smart-Alert/Smart-Alert-new/frontend/node_modules/@uploadcare/file-uploader/blocks/SourceBtn/SourceBtn.js"],"sourcesContent":["// @ts-check\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { browserFeatures } from '../../utils/browser-info.js';\nimport { CameraSourceTypes } from '../CameraSource/constants.js';\nimport { ExternalUploadSource, UploadSource, UploadSourceMobile } from '../utils/UploadSource.js';\n\nconst L10N_PREFIX = 'src-type-';\n\n/**\n * @typedef {{\n *   type: string;\n *   activity?: string;\n *   textKey?: string;\n *   icon?: string;\n *   activate?: () => boolean;\n *   activityParams?: Record<string, unknown>;\n * }} TConfig\n */\n\nexport class SourceBtn extends UploaderBlock {\n  couldBeCtxOwner = true;\n  /** @type {string | undefined} */\n  type = undefined;\n  /**\n   * @private\n   * @type {Record<string, TConfig>}\n   */\n  _registeredTypes = {};\n\n  constructor() {\n    super();\n\n    this.init$ = {\n      ...this.init$,\n      iconName: 'default',\n      'src-type': '',\n    };\n  }\n\n  initTypes() {\n    this.registerType({\n      type: UploadSource.LOCAL,\n      activate: () => {\n        this.api.openSystemDialog();\n        return false;\n      },\n    });\n    this.registerType({\n      type: UploadSource.URL,\n      activity: ActivityBlock.activities.URL,\n      textKey: 'from-url',\n    });\n    this.registerType({\n      type: UploadSource.CAMERA,\n      activity: ActivityBlock.activities.CAMERA,\n      activate: () => {\n        const supportsCapture = browserFeatures.htmlMediaCapture;\n\n        if (supportsCapture) {\n          this.api.openSystemDialog({ captureCamera: true });\n        }\n        return !supportsCapture;\n      },\n    });\n\n    this.registerType({\n      type: 'draw',\n      activity: ActivityBlock.activities.DRAW,\n      icon: 'edit-draw',\n    });\n\n    for (let mobileSourceType of Object.values(UploadSourceMobile)) {\n      this.registerType({\n        type: mobileSourceType,\n        activity: ActivityBlock.activities.CAMERA,\n        activate: () => {\n          const supportsCapture = browserFeatures.htmlMediaCapture;\n          if (supportsCapture) {\n            this.api.openSystemDialog({\n              captureCamera: true,\n              modeCamera:\n                mobileSourceType === 'mobile-photo-camera' ? CameraSourceTypes.PHOTO : CameraSourceTypes.VIDEO,\n            });\n          }\n          return !supportsCapture;\n        },\n      });\n    }\n\n    for (let externalSourceType of Object.values(ExternalUploadSource)) {\n      this.registerType({\n        type: externalSourceType,\n        activity: ActivityBlock.activities.EXTERNAL,\n        activityParams: {\n          externalSourceType: externalSourceType,\n        },\n      });\n    }\n  }\n\n  initCallback() {\n    super.initCallback();\n    this.initTypes();\n\n    this.defineAccessor(\n      'type',\n      /** @param {string} val */\n      (val) => {\n        if (!val) {\n          return;\n        }\n        this.applyType(val);\n      },\n    );\n  }\n\n  /** @param {TConfig} typeConfig */\n  registerType(typeConfig) {\n    this._registeredTypes[typeConfig.type] = typeConfig;\n  }\n\n  /** @param {string} type */\n  getType(type) {\n    return this._registeredTypes[type];\n  }\n\n  activate() {\n    if (!this.type) {\n      return;\n    }\n    const configType = this._registeredTypes[this.type];\n    const { activity, activate, activityParams = {} } = configType;\n    const showActivity = activate ? activate() : !!activity;\n\n    if (showActivity) {\n      this.modalManager.open(/** @type {string} */ (activity));\n\n      this.set$({\n        '*currentActivityParams': activityParams,\n        '*currentActivity': activity,\n      });\n    }\n  }\n\n  /** @param {string} type */\n  applyType(type) {\n    const configType = this._registeredTypes[type];\n    if (!configType) {\n      console.warn('Unsupported source type: ' + type);\n      return;\n    }\n    const { textKey = type, icon = type } = configType;\n\n    this.$['src-type'] = `${L10N_PREFIX}${textKey}`;\n    this.$.iconName = icon;\n    this.onclick = () => {\n      this.activate();\n    };\n  }\n}\n\nSourceBtn.template = /* HTML */ `\n  <button type=\"button\">\n    <uc-icon set=\"@name: iconName\"></uc-icon>\n    <div class=\"uc-txt\" l10n=\"src-type\"></div>\n  </button>\n`;\nSourceBtn.bindAttributes({\n  // @ts-expect-error symbiote types bug\n  type: null,\n});\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
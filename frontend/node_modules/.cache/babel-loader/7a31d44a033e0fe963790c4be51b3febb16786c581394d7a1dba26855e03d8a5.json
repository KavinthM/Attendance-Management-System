{"ast":null,"code":"// @ts-check\n\nimport { localeStateKey } from './LocaleManager.js';\n\n/**\n * @template {import('./Block.js').Block} T\n * @param {DocumentFragment} fr\n * @param {T} fnCtx\n */\nexport function l10nProcessor(fr, fnCtx) {\n  [...fr.querySelectorAll('[l10n]')].forEach(el => {\n    let key = el.getAttribute('l10n');\n    if (!key) {\n      return;\n    }\n    const list = key.split(';');\n    for (const item of list) {\n      if (item) locale(el, item, fnCtx);\n    }\n  });\n}\n\n/**\n * @param {Element} el\n * @param {string} key\n * @param {any} fnCtx\n */\nconst locale = (el, key, fnCtx) => {\n  let elProp = 'textContent';\n  let useAttribute = false;\n  if (key.includes(':')) {\n    const arr = key.split(':');\n    elProp = arr[0];\n    key = arr[1];\n    if (elProp.startsWith('@')) {\n      elProp = elProp.slice(1);\n      useAttribute = true;\n    }\n  }\n\n  // Check if the key is present in the local context\n  const localCtxKey = key;\n  if (fnCtx.has(localCtxKey)) {\n    fnCtx.sub(localCtxKey, (/** @type {string} */mappedKey) => {\n      if (!mappedKey) {\n        return;\n      }\n      // Store the subscription in a temporary map to be able to unsubscribe later\n      if (!fnCtx.l10nProcessorSubs.has(localCtxKey)) {\n        fnCtx.l10nProcessorSubs.set(localCtxKey, new Set());\n      }\n      const keySubs = fnCtx.l10nProcessorSubs.get(localCtxKey);\n      keySubs?.forEach(/** @param {{ remove: () => void }} sub */\n      sub => {\n        sub.remove();\n        keySubs.delete(sub);\n        fnCtx.allSubs.delete(sub);\n      });\n      // We don't need the leading * in the key because we use the key as a local context key relative to the global state\n      const nodeStateKey = localeStateKey(mappedKey).replace('*', '');\n      // If the key is not present in the node context, add it\n      if (!fnCtx.nodeCtx.has(nodeStateKey)) {\n        fnCtx.nodeCtx.add(nodeStateKey, mappedKey);\n      }\n      // Subscribe on the global l10n key change\n      const sub = fnCtx.nodeCtx.sub(nodeStateKey, () => {\n        el[(/** @type {'textContent'} */elProp)] = fnCtx.l10n(mappedKey);\n      });\n      keySubs?.add(sub);\n      // Store the subscription in the global context to make able Symbiote to unsubscribe it on destroy\n      fnCtx.allSubs.add(sub);\n      el.removeAttribute('l10n');\n    });\n  }\n\n  // Otherwise, assume the key is in the global context\n  const stateKey = localeStateKey(key);\n  if (!fnCtx.has(stateKey)) {\n    fnCtx.add(stateKey, '');\n  }\n  fnCtx.sub(stateKey, () => {\n    key = /** @type {string} */key;\n    if (useAttribute) {\n      el.setAttribute(elProp, fnCtx.l10n(key));\n    } else {\n      el[(/** @type {'textContent'} */elProp)] = fnCtx.l10n(key);\n    }\n  });\n  el.removeAttribute('l10n');\n};","map":{"version":3,"names":["localeStateKey","l10nProcessor","fr","fnCtx","querySelectorAll","forEach","el","key","getAttribute","list","split","item","locale","elProp","useAttribute","includes","arr","startsWith","slice","localCtxKey","has","sub","mappedKey","l10nProcessorSubs","set","Set","keySubs","get","remove","delete","allSubs","nodeStateKey","replace","nodeCtx","add","l10n","removeAttribute","stateKey","setAttribute"],"sources":["/Users/kavinth/Documents/GitHub/Smart-Alert/Smart-Alert-new/frontend/node_modules/@uploadcare/file-uploader/abstract/l10nProcessor.js"],"sourcesContent":["// @ts-check\n\nimport { localeStateKey } from './LocaleManager.js';\n\n/**\n * @template {import('./Block.js').Block} T\n * @param {DocumentFragment} fr\n * @param {T} fnCtx\n */\nexport function l10nProcessor(fr, fnCtx) {\n  [...fr.querySelectorAll('[l10n]')].forEach((el) => {\n    let key = el.getAttribute('l10n');\n    if (!key) {\n      return;\n    }\n    const list = key.split(';');\n\n    for (const item of list) {\n      if (item) locale(el, item, fnCtx);\n    }\n  });\n}\n\n/**\n * @param {Element} el\n * @param {string} key\n * @param {any} fnCtx\n */\nconst locale = (el, key, fnCtx) => {\n  let elProp = 'textContent';\n  let useAttribute = false;\n  if (key.includes(':')) {\n    const arr = key.split(':');\n    elProp = arr[0];\n    key = arr[1];\n    if (elProp.startsWith('@')) {\n      elProp = elProp.slice(1);\n      useAttribute = true;\n    }\n  }\n\n  // Check if the key is present in the local context\n  const localCtxKey = key;\n  if (fnCtx.has(localCtxKey)) {\n    fnCtx.sub(localCtxKey, (/** @type {string} */ mappedKey) => {\n      if (!mappedKey) {\n        return;\n      }\n      // Store the subscription in a temporary map to be able to unsubscribe later\n      if (!fnCtx.l10nProcessorSubs.has(localCtxKey)) {\n        fnCtx.l10nProcessorSubs.set(localCtxKey, new Set());\n      }\n      const keySubs = fnCtx.l10nProcessorSubs.get(localCtxKey);\n      keySubs?.forEach(\n        /** @param {{ remove: () => void }} sub */\n        (sub) => {\n          sub.remove();\n          keySubs.delete(sub);\n          fnCtx.allSubs.delete(sub);\n        },\n      );\n      // We don't need the leading * in the key because we use the key as a local context key relative to the global state\n      const nodeStateKey = localeStateKey(mappedKey).replace('*', '');\n      // If the key is not present in the node context, add it\n      if (!fnCtx.nodeCtx.has(nodeStateKey)) {\n        fnCtx.nodeCtx.add(nodeStateKey, mappedKey);\n      }\n      // Subscribe on the global l10n key change\n      const sub = fnCtx.nodeCtx.sub(nodeStateKey, () => {\n        el[/** @type {'textContent'} */ (elProp)] = fnCtx.l10n(mappedKey);\n      });\n      keySubs?.add(sub);\n      // Store the subscription in the global context to make able Symbiote to unsubscribe it on destroy\n      fnCtx.allSubs.add(sub);\n      el.removeAttribute('l10n');\n    });\n  }\n\n  // Otherwise, assume the key is in the global context\n  const stateKey = localeStateKey(key);\n  if (!fnCtx.has(stateKey)) {\n    fnCtx.add(stateKey, '');\n  }\n  fnCtx.sub(stateKey, () => {\n    key = /** @type {string} */ (key);\n    if (useAttribute) {\n      el.setAttribute(elProp, fnCtx.l10n(key));\n    } else {\n      el[/** @type {'textContent'} */ (elProp)] = fnCtx.l10n(key);\n    }\n  });\n  el.removeAttribute('l10n');\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
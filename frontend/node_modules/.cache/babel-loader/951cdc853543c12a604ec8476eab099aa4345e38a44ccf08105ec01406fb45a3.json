{"ast":null,"code":"import React,{useState}from\"react\";import{Link,useNavigate}from\"react-router-dom\";import Layout from\"../Components/Layout\";import StudentForm from\"../Components/StudentForm\";import{addStudent,getNextStudentIndex}from\"../api/client\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AddStudent=()=>{const navigate=useNavigate();const[adding,setAdding]=useState(false);const[nextIndex,setNextIndex]=useState(\"\");React.useEffect(()=>{getNextStudentIndex().then(_ref=>{let{data}=_ref;return setNextIndex(data.nextIndex);}).catch(console.error);},[]);const handleAdd=async(payload,reset)=>{setAdding(true);try{await addStudent(payload);// Ensure we navigate back to list to see the update\nnavigate(\"/students\");return{status:\"success\"};}catch(e){var _e$response,_e$response2,_e$response2$data;const status=e===null||e===void 0?void 0:(_e$response=e.response)===null||_e$response===void 0?void 0:_e$response.status;const msg=(e===null||e===void 0?void 0:(_e$response2=e.response)===null||_e$response2===void 0?void 0:(_e$response2$data=_e$response2.data)===null||_e$response2$data===void 0?void 0:_e$response2$data.message)||\"Failed to add student\";if(status===409&&msg.includes(\"email\")){return{status:\"error\",code:\"DUPLICATE_EMAIL\",message:msg};}alert(msg);return{status:\"error\",code:\"OTHER\",message:msg};}finally{setAdding(false);}};return/*#__PURE__*/_jsx(Layout,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-slate-900\",children:\"Register Student\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-500 mt-1\",children:\"Add a new student to the system\"})]}),/*#__PURE__*/_jsxs(Link,{to:\"/students\",className:\"btn-secondary self-start md:self-auto\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa-solid fa-arrow-left mr-2\"}),\" Back to List\"]})]}),/*#__PURE__*/_jsx(StudentForm,{onSubmit:handleAdd,submitting:adding,nextIndex:nextIndex})]})});};export default AddStudent;","map":{"version":3,"names":["React","useState","Link","useNavigate","Layout","StudentForm","addStudent","getNextStudentIndex","jsx","_jsx","jsxs","_jsxs","AddStudent","navigate","adding","setAdding","nextIndex","setNextIndex","useEffect","then","_ref","data","catch","console","error","handleAdd","payload","reset","status","e","_e$response","_e$response2","_e$response2$data","response","msg","message","includes","code","alert","children","className","to","onSubmit","submitting"],"sources":["/Users/kavinth/Documents/GitHub/Smart-Alert/Smart-Alert-new/frontend/src/pages/AddStudent.jsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport Layout from \"../Components/Layout\";\nimport StudentForm from \"../Components/StudentForm\";\nimport { addStudent, getNextStudentIndex } from \"../api/client\";\n\nconst AddStudent = () => {\n    const navigate = useNavigate();\n    const [adding, setAdding] = useState(false);\n    const [nextIndex, setNextIndex] = useState(\"\");\n\n    React.useEffect(() => {\n        getNextStudentIndex().then(({ data }) => setNextIndex(data.nextIndex)).catch(console.error);\n    }, []);\n\n    const handleAdd = async (payload, reset) => {\n        setAdding(true);\n        try {\n            await addStudent(payload);\n            // Ensure we navigate back to list to see the update\n            navigate(\"/students\");\n            return { status: \"success\" };\n        } catch (e) {\n            const status = e?.response?.status;\n            const msg = e?.response?.data?.message || \"Failed to add student\";\n\n            if (status === 409 && msg.includes(\"email\")) {\n                return { status: \"error\", code: \"DUPLICATE_EMAIL\", message: msg };\n            }\n\n            alert(msg);\n            return { status: \"error\", code: \"OTHER\", message: msg };\n        } finally {\n            setAdding(false);\n        }\n    };\n\n    return (\n        <Layout>\n            <div className=\"max-w-4xl mx-auto\">\n                <div className=\"mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4\">\n                    <div>\n                        <h1 className=\"text-3xl font-bold text-slate-900\">Register Student</h1>\n                        <p className=\"text-slate-500 mt-1\">Add a new student to the system</p>\n                    </div>\n                    <Link to=\"/students\" className=\"btn-secondary self-start md:self-auto\">\n                        <i className=\"fa-solid fa-arrow-left mr-2\"></i> Back to List\n                    </Link>\n                </div>\n\n                <StudentForm onSubmit={handleAdd} submitting={adding} nextIndex={nextIndex} />\n            </div>\n        </Layout>\n    );\n};\n\nexport default AddStudent;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
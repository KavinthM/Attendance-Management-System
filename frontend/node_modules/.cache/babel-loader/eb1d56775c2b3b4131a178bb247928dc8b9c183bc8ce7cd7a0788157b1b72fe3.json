{"ast":null,"code":"var _jsxFileName = \"/Users/kavinth/Documents/GitHub/Smart-Alert/Smart-Alert-new/frontend/src/pages/Attendance.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport Layout from \"../Components/Layout\";\nimport Select from \"../Components/Select\";\nimport AttendanceRow from \"../Components/AttendanceRow\";\nimport { getStudents, markAttendance, getAllAttendance } from \"../api/client\";\nimport dayjs from \"dayjs\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Attendance = () => {\n  _s();\n  const [students, setStudents] = useState([]);\n  const [section, setSection] = useState(\"\");\n  const [date, setDate] = useState(dayjs().format(\"YYYY-MM-DD\"));\n  const [rows, setRows] = useState({});\n  const [submitting, setSubmitting] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [existingIdsForDate, setExistingIdsForDate] = useState(new Set());\n  const [loadingExisting, setLoadingExisting] = useState(false);\n  const load = async () => {\n    setLoading(true);\n    try {\n      const {\n        data\n      } = await getStudents();\n      setStudents(data.students || []);\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    load();\n  }, []);\n  useEffect(() => {\n    const id = setInterval(() => {\n      setDate(dayjs().format(\"YYYY-MM-DD\"));\n    }, 60 * 1000);\n    return () => clearInterval(id);\n  }, []);\n  const sections = useMemo(() => {\n    const set = new Set(students.map(s => s.section));\n    return Array.from(set).sort().map(s => ({\n      value: s,\n      label: s\n    }));\n  }, [students]);\n  const visible = useMemo(() => section ? students.filter(s => s.section === section) : [], [students, section]);\n  useEffect(() => {\n    if (!section) {\n      setRows({});\n      return;\n    }\n    const map = {};\n    visible.forEach(s => {\n      var _rows$s$_id;\n      map[s._id] = (_rows$s$_id = rows[s._id]) !== null && _rows$s$_id !== void 0 ? _rows$s$_id : {\n        status: \"Present\"\n      };\n    });\n    setRows(map);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [visible.length, section]);\n  useEffect(() => {\n    const loadExisting = async () => {\n      if (!section) {\n        setExistingIdsForDate(new Set());\n        return;\n      }\n      setLoadingExisting(true);\n      try {\n        const {\n          data\n        } = await getAllAttendance();\n        const list = Array.isArray(data.records) ? data.records : [];\n        const ids = new Set(list.filter(r => dayjs(r.date).format(\"YYYY-MM-DD\") === date).filter(r => {\n          var _r$student;\n          return ((_r$student = r.student) === null || _r$student === void 0 ? void 0 : _r$student.section) === section;\n        }).map(r => {\n          var _r$student2;\n          return (_r$student2 = r.student) === null || _r$student2 === void 0 ? void 0 : _r$student2._id;\n        }).filter(Boolean));\n        setExistingIdsForDate(ids);\n      } finally {\n        setLoadingExisting(false);\n      }\n    };\n    loadExisting();\n  }, [date, section]);\n  const updateRow = (studentId, newRow) => {\n    setRows(r => ({\n      ...r,\n      [studentId]: newRow\n    }));\n  };\n  const nothingToSubmit = useMemo(() => {\n    return visible.every(s => existingIdsForDate.has(s._id));\n  }, [visible, existingIdsForDate]);\n  const submit = async () => {\n    if (!section) return alert(\"Select a class/section first\");\n    setSubmitting(true);\n    try {\n      const toSubmit = visible.filter(s => !existingIdsForDate.has(s._id));\n      if (toSubmit.length === 0) {\n        alert(\"Attendance already marked for all students in this section for this date.\");\n        return;\n      }\n      const payloads = toSubmit.map(s => {\n        var _rows$s$_id2;\n        const status = ((_rows$s$_id2 = rows[s._id]) === null || _rows$s$_id2 === void 0 ? void 0 : _rows$s$_id2.status) || \"Present\";\n        return {\n          studentId: s._id,\n          date,\n          status,\n          notifiedParent: false\n        };\n      });\n      for (const p of payloads) {\n        await markAttendance(p);\n      }\n      setExistingIdsForDate(prev => {\n        const next = new Set(prev);\n        toSubmit.forEach(s => next.add(s._id));\n        return next;\n      });\n      alert(\"Attendance marked successfully\");\n    } catch (e) {\n      var _e$response, _e$response$data;\n      alert((e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.message) || \"Failed to mark attendance\");\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Loading state\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(Layout, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-center items-center min-h-96\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-muted-foreground\",\n            children: \"Loading attendance system...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-8\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center mb-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-3xl font-bold text-foreground mb-2\",\n          children: \"Attendance Management\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-muted-foreground\",\n          children: \"Mark and manage student attendance records\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-card rounded-xl shadow-sm border p-6 mb-6\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col md:flex-row gap-4 items-center justify-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-full md:w-80\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-foreground mb-2\",\n              children: \"Class Section\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 159,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Select, {\n              value: section,\n              onChange: setSection,\n              options: [{\n                value: \"\",\n                label: \"Select a section\"\n              }, ...sections]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-full md:w-80\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-foreground mb-2\",\n              children: \"Attendance Date\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"date\",\n                value: date,\n                readOnly: true,\n                className: \"w-full px-4 py-3 bg-muted text-foreground border border-border rounded-lg text-center cursor-not-allowed opacity-80 font-medium\",\n                \"aria-label\": \"Date\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute inset-y-0 right-3 flex items-center\",\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-muted-foreground\",\n                  children: \"\\uD83D\\uDCC5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 182,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 181,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 7\n    }, this), !section ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-card rounded-xl shadow-sm border p-12 text-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"max-w-md mx-auto\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-6xl mb-4\",\n          children: \"\\uD83D\\uDCCA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-xl font-semibold text-foreground mb-2\",\n          children: \"Ready to Mark Attendance\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-muted-foreground mb-6\",\n          children: \"Please select a class section from the dropdown above to begin marking attendance for your students.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-primary/5 border border-primary/20 rounded-lg p-4 mb-6\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-wrap items-center justify-between gap-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"font-semibold text-foreground\",\n              children: [\"Section \", section]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-muted-foreground\",\n              children: [visible.length, \" students \\u2022 \", dayjs(date).format('MMMM D, YYYY')]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-1 text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-3 h-3 bg-green-500 rounded-full\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 218,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-muted-foreground\",\n                children: [\"Marked: \", existingIdsForDate.size]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 219,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 217,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-1 text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-3 h-3 bg-blue-500 rounded-full\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 222,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-muted-foreground\",\n                children: [\"Pending: \", visible.length - existingIdsForDate.size]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 223,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 221,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-card rounded-xl shadow-sm border overflow-hidden\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"overflow-x-auto\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"w-full\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              className: \"bg-muted/50 border-b border-border\",\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-4 px-6 text-left font-semibold text-foreground\",\n                  children: \"Student Name\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 235,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-4 px-6 text-left font-semibold text-foreground\",\n                  children: \"Index Number\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 236,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-4 px-6 text-left font-semibold text-foreground\",\n                  children: \"Section\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 237,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-4 px-6 text-left font-semibold text-foreground\",\n                  children: \"Attendance Status\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 238,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 234,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: [(loading || loadingExisting) && /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: /*#__PURE__*/_jsxDEV(\"td\", {\n                  colSpan: \"4\",\n                  className: \"py-8 text-center\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex justify-center items-center gap-3\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"animate-spin rounded-full h-5 w-5 border-b-2 border-primary\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 246,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-muted-foreground\",\n                      children: \"Loading student data...\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 247,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 245,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 244,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 243,\n                columnNumber: 21\n              }, this), !loading && !loadingExisting && visible.map(s => /*#__PURE__*/_jsxDEV(AttendanceRow, {\n                student: s,\n                row: rows[s._id] || {\n                  status: \"Present\"\n                },\n                onChange: updateRow,\n                disabled: existingIdsForDate.has(s._id)\n              }, s._id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 254,\n                columnNumber: 21\n              }, this)), !loading && !loadingExisting && visible.length === 0 && /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: /*#__PURE__*/_jsxDEV(\"td\", {\n                  colSpan: \"4\",\n                  className: \"py-12 text-center\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-muted-foreground\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"text-4xl mb-3\",\n                      children: \"\\uD83D\\uDC65\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 267,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"font-medium\",\n                      children: \"No students found in this section\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 268,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-sm mt-1\",\n                      children: \"Please check the section selection\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 269,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 266,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 265,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 264,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"border-t border-border bg-muted/20 px-6 py-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col sm:flex-row justify-between items-center gap-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-muted-foreground\",\n              children: nothingToSubmit ? /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"flex items-center gap-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"w-2 h-2 bg-green-500 rounded-full\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 284,\n                  columnNumber: 23\n                }, this), \"All attendance marked for today\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 283,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                children: [visible.length - existingIdsForDate.size, \" students pending attendance\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 288,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 281,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex gap-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"px-6 py-2.5 border border-border rounded-lg font-medium text-foreground hover:bg-muted transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed\",\n                onClick: () => setRows({}),\n                disabled: submitting,\n                children: \"Reset Changes\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 293,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"px-8 py-2.5 bg-primary text-primary-foreground rounded-lg font-medium hover:bg-primary/90 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\",\n                onClick: submit,\n                disabled: submitting || !section || nothingToSubmit,\n                children: submitting ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"animate-spin rounded-full h-4 w-4 border-b-2 border-current\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 307,\n                    columnNumber: 25\n                  }, this), \"Processing...\"]\n                }, void 0, true) : `Submit Attendance`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 300,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 292,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 147,\n    columnNumber: 5\n  }, this);\n};\n_s(Attendance, \"vN3AgFJcR/XyNFBSwE6FkyXPC3M=\");\n_c = Attendance;\nexport default Attendance;\nvar _c;\n$RefreshReg$(_c, \"Attendance\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","Layout","Select","AttendanceRow","getStudents","markAttendance","getAllAttendance","dayjs","jsxDEV","_jsxDEV","Fragment","_Fragment","Attendance","_s","students","setStudents","section","setSection","date","setDate","format","rows","setRows","submitting","setSubmitting","loading","setLoading","existingIdsForDate","setExistingIdsForDate","Set","loadingExisting","setLoadingExisting","load","data","id","setInterval","clearInterval","sections","set","map","s","Array","from","sort","value","label","visible","filter","forEach","_rows$s$_id","_id","status","length","loadExisting","list","isArray","records","ids","r","_r$student","student","_r$student2","Boolean","updateRow","studentId","newRow","nothingToSubmit","every","has","submit","alert","toSubmit","payloads","_rows$s$_id2","notifiedParent","p","prev","next","add","e","_e$response","_e$response$data","response","message","children","className","fileName","_jsxFileName","lineNumber","columnNumber","onChange","options","type","readOnly","size","colSpan","row","disabled","onClick","_c","$RefreshReg$"],"sources":["/Users/kavinth/Documents/GitHub/Smart-Alert/Smart-Alert-new/frontend/src/pages/Attendance.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from \"react\";\nimport Layout from \"../Components/Layout\";\nimport Select from \"../Components/Select\";\nimport AttendanceRow from \"../Components/AttendanceRow\";\nimport { getStudents, markAttendance, getAllAttendance } from \"../api/client\";\nimport dayjs from \"dayjs\";\n\nconst Attendance = () => {\n  const [students, setStudents] = useState([]);\n  const [section, setSection] = useState(\"\");\n  const [date, setDate] = useState(dayjs().format(\"YYYY-MM-DD\"));\n  const [rows, setRows] = useState({});\n  const [submitting, setSubmitting] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [existingIdsForDate, setExistingIdsForDate] = useState(new Set());\n  const [loadingExisting, setLoadingExisting] = useState(false);\n\n  const load = async () => {\n    setLoading(true);\n    try {\n      const { data } = await getStudents();\n      setStudents(data.students || []);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => { load(); }, []);\n\n  useEffect(() => {\n    const id = setInterval(() => {\n      setDate(dayjs().format(\"YYYY-MM-DD\"));\n    }, 60 * 1000);\n    return () => clearInterval(id);\n  }, []);\n\n  const sections = useMemo(() => {\n    const set = new Set(students.map((s) => s.section));\n    return Array.from(set).sort().map((s) => ({ value: s, label: s }));\n  }, [students]);\n\n  const visible = useMemo(\n    () => (section ? students.filter((s) => s.section === section) : []),\n    [students, section]\n  );\n\n  useEffect(() => {\n    if (!section) {\n      setRows({});\n      return;\n    }\n    const map = {};\n    visible.forEach((s) => {\n      map[s._id] = rows[s._id] ?? { status: \"Present\" };\n    });\n    setRows(map);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [visible.length, section]);\n\n  useEffect(() => {\n    const loadExisting = async () => {\n      if (!section) {\n        setExistingIdsForDate(new Set());\n        return;\n      }\n      setLoadingExisting(true);\n      try {\n        const { data } = await getAllAttendance();\n        const list = Array.isArray(data.records) ? data.records : [];\n        const ids = new Set(\n          list\n            .filter((r) => dayjs(r.date).format(\"YYYY-MM-DD\") === date)\n            .filter((r) => r.student?.section === section)\n            .map((r) => r.student?._id)\n            .filter(Boolean)\n        );\n        setExistingIdsForDate(ids);\n      } finally {\n        setLoadingExisting(false);\n      }\n    };\n    loadExisting();\n  }, [date, section]);\n\n  const updateRow = (studentId, newRow) => {\n    setRows((r) => ({ ...r, [studentId]: newRow }));\n  };\n\n  const nothingToSubmit = useMemo(() => {\n    return visible.every((s) => existingIdsForDate.has(s._id));\n  }, [visible, existingIdsForDate]);\n\n  const submit = async () => {\n    if (!section) return alert(\"Select a class/section first\");\n    \n    setSubmitting(true);\n    try {\n      const toSubmit = visible.filter((s) => !existingIdsForDate.has(s._id));\n      if (toSubmit.length === 0) {\n        alert(\"Attendance already marked for all students in this section for this date.\");\n        return;\n      }\n\n      const payloads = toSubmit.map((s) => {\n        const status = rows[s._id]?.status || \"Present\";\n        return {\n          studentId: s._id,\n          date,\n          status,\n          notifiedParent: false\n        };\n      });\n\n      for (const p of payloads) {\n        await markAttendance(p);\n      }\n\n      setExistingIdsForDate((prev) => {\n        const next = new Set(prev);\n        toSubmit.forEach((s) => next.add(s._id));\n        return next;\n      });\n\n      alert(\"Attendance marked successfully\");\n    } catch (e) {\n      alert(e?.response?.data?.message || \"Failed to mark attendance\");\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Loading state\n  if (loading) {\n    return (\n      <Layout>\n        <div className=\"flex justify-center items-center min-h-96\">\n          <div className=\"text-center\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n            <p className=\"text-muted-foreground\">Loading attendance system...</p>\n          </div>\n        </div>\n      </Layout>\n    );\n  }\n\n  return (\n    <Layout>\n      {/* Header Section */}\n      <div className=\"mb-8\">\n        <div className=\"text-center mb-2\">\n          <h1 className=\"text-3xl font-bold text-foreground mb-2\">Attendance Management</h1>\n          <p className=\"text-muted-foreground\">Mark and manage student attendance records</p>\n        </div>\n        \n        {/* Controls Card */}\n        <div className=\"bg-card rounded-xl shadow-sm border p-6 mb-6\">\n          <div className=\"flex flex-col md:flex-row gap-4 items-center justify-center\">\n            <div className=\"w-full md:w-80\">\n              <label className=\"block text-sm font-medium text-foreground mb-2\">\n                Class Section\n              </label>\n              <Select\n                value={section}\n                onChange={setSection}\n                options={[{ value: \"\", label: \"Select a section\" }, ...sections]}\n              />\n            </div>\n            \n            <div className=\"w-full md:w-80\">\n              <label className=\"block text-sm font-medium text-foreground mb-2\">\n                Attendance Date\n              </label>\n              <div className=\"relative\">\n                <input\n                  type=\"date\"\n                  value={date}\n                  readOnly\n                  className=\"w-full px-4 py-3 bg-muted text-foreground border border-border rounded-lg text-center cursor-not-allowed opacity-80 font-medium\"\n                  aria-label=\"Date\"\n                />\n                <div className=\"absolute inset-y-0 right-3 flex items-center\">\n                  <span className=\"text-muted-foreground\">ðŸ“…</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      {!section ? (\n        <div className=\"bg-card rounded-xl shadow-sm border p-12 text-center\">\n          <div className=\"max-w-md mx-auto\">\n            <div className=\"text-6xl mb-4\">ðŸ“Š</div>\n            <h3 className=\"text-xl font-semibold text-foreground mb-2\">\n              Ready to Mark Attendance\n            </h3>\n            <p className=\"text-muted-foreground mb-6\">\n              Please select a class section from the dropdown above to begin marking attendance for your students.\n            </p>\n          </div>\n        </div>\n      ) : (\n        <>\n          {/* Summary Bar */}\n          <div className=\"bg-primary/5 border border-primary/20 rounded-lg p-4 mb-6\">\n            <div className=\"flex flex-wrap items-center justify-between gap-4\">\n              <div>\n                <h3 className=\"font-semibold text-foreground\">\n                  Section {section}\n                </h3>\n                <p className=\"text-sm text-muted-foreground\">\n                  {visible.length} students â€¢ {dayjs(date).format('MMMM D, YYYY')}\n                </p>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"flex items-center gap-1 text-sm\">\n                  <div className=\"w-3 h-3 bg-green-500 rounded-full\"></div>\n                  <span className=\"text-muted-foreground\">Marked: {existingIdsForDate.size}</span>\n                </div>\n                <div className=\"flex items-center gap-1 text-sm\">\n                  <div className=\"w-3 h-3 bg-blue-500 rounded-full\"></div>\n                  <span className=\"text-muted-foreground\">Pending: {visible.length - existingIdsForDate.size}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Attendance Table */}\n          <div className=\"bg-card rounded-xl shadow-sm border overflow-hidden\">\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full\">\n                <thead className=\"bg-muted/50 border-b border-border\">\n                  <tr>\n                    <th className=\"py-4 px-6 text-left font-semibold text-foreground\">Student Name</th>\n                    <th className=\"py-4 px-6 text-left font-semibold text-foreground\">Index Number</th>\n                    <th className=\"py-4 px-6 text-left font-semibold text-foreground\">Section</th>\n                    <th className=\"py-4 px-6 text-left font-semibold text-foreground\">Attendance Status</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {(loading || loadingExisting) && (\n                    <tr>\n                      <td colSpan=\"4\" className=\"py-8 text-center\">\n                        <div className=\"flex justify-center items-center gap-3\">\n                          <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-primary\"></div>\n                          <span className=\"text-muted-foreground\">Loading student data...</span>\n                        </div>\n                      </td>\n                    </tr>\n                  )}\n                  \n                  {!loading && !loadingExisting && visible.map((s) => (\n                    <AttendanceRow\n                      key={s._id}\n                      student={s}\n                      row={rows[s._id] || { status: \"Present\" }}\n                      onChange={updateRow}\n                      disabled={existingIdsForDate.has(s._id)}\n                    />\n                  ))}\n                  \n                  {!loading && !loadingExisting && visible.length === 0 && (\n                    <tr>\n                      <td colSpan=\"4\" className=\"py-12 text-center\">\n                        <div className=\"text-muted-foreground\">\n                          <div className=\"text-4xl mb-3\">ðŸ‘¥</div>\n                          <p className=\"font-medium\">No students found in this section</p>\n                          <p className=\"text-sm mt-1\">Please check the section selection</p>\n                        </div>\n                      </td>\n                    </tr>\n                  )}\n                </tbody>\n              </table>\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"border-t border-border bg-muted/20 px-6 py-4\">\n              <div className=\"flex flex-col sm:flex-row justify-between items-center gap-4\">\n                <div className=\"text-sm text-muted-foreground\">\n                  {nothingToSubmit ? (\n                    <span className=\"flex items-center gap-2\">\n                      <span className=\"w-2 h-2 bg-green-500 rounded-full\"></span>\n                      All attendance marked for today\n                    </span>\n                  ) : (\n                    <span>{visible.length - existingIdsForDate.size} students pending attendance</span>\n                  )}\n                </div>\n                \n                <div className=\"flex gap-3\">\n                  <button \n                    className=\"px-6 py-2.5 border border-border rounded-lg font-medium text-foreground hover:bg-muted transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    onClick={() => setRows({})}\n                    disabled={submitting}\n                  >\n                    Reset Changes\n                  </button>\n                  <button\n                    className=\"px-8 py-2.5 bg-primary text-primary-foreground rounded-lg font-medium hover:bg-primary/90 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"\n                    onClick={submit}\n                    disabled={submitting || !section || nothingToSubmit}\n                  >\n                    {submitting ? (\n                      <>\n                        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-current\"></div>\n                        Processing...\n                      </>\n                    ) : (\n                      `Submit Attendance`\n                    )}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </>\n      )}\n    </Layout>\n  );\n};\n\nexport default Attendance;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
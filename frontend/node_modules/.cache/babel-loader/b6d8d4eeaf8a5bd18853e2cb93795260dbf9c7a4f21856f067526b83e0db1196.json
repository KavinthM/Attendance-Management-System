{"ast":null,"code":"// @ts-check\nimport { shrinkFile } from '@uploadcare/image-shrink';\nimport { CancelError, UploadcareError, uploadFile } from '@uploadcare/upload-client';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { parseShrink } from '../../utils/parseShrink.js';\nimport { ExternalUploadSource } from '../utils/UploadSource.js';\nimport { debounce } from '../utils/debounce.js';\nimport { throttle } from '../utils/throttle.js';\nimport { FileItemConfig } from './FileItemConfig.js';\nconst FileItemState = Object.freeze({\n  FINISHED: Symbol('FINISHED'),\n  FAILED: Symbol('FAILED'),\n  UPLOADING: Symbol('UPLOADING'),\n  IDLE: Symbol('IDLE')\n});\nexport class FileItem extends FileItemConfig {\n  couldBeCtxOwner = true;\n  pauseRender = true;\n\n  /** @private */\n  _renderedOnce = false;\n  constructor() {\n    super();\n    this.init$ = {\n      ...this.init$,\n      uid: '',\n      itemName: '',\n      errorText: '',\n      hint: '',\n      thumbUrl: '',\n      progressValue: 0,\n      progressVisible: false,\n      badgeIcon: '',\n      isFinished: false,\n      isFailed: false,\n      isUploading: false,\n      isFocused: false,\n      isEditable: false,\n      showFileNames: false,\n      state: FileItemState.IDLE,\n      ariaLabelStatusFile: '',\n      onEdit: this._withEntry(entry => {\n        this.$['*currentActivityParams'] = {\n          internalId: entry.uid\n        };\n        this.modalManager.open(ActivityBlock.activities.CLOUD_IMG_EDIT);\n        this.$['*currentActivity'] = ActivityBlock.activities.CLOUD_IMG_EDIT;\n      }),\n      onRemove: () => {\n        this.uploadCollection.remove(this.$.uid);\n      },\n      onUpload: () => {\n        this.upload();\n      }\n    };\n  }\n  _reset() {\n    super._reset();\n    this._debouncedCalculateState.cancel();\n  }\n\n  /**\n   * @private\n   * @param {IntersectionObserverEntry[]} entries\n   */\n  _observerCallback(entries) {\n    let [entry] = entries;\n    this._isIntersecting = entry.isIntersecting;\n    this._thumbRect = entry.boundingClientRect;\n    if (entry.isIntersecting && !this._renderedOnce) {\n      this.render();\n      this._renderedOnce = true;\n    }\n  }\n\n  /** @private */\n  _calculateState = this._withEntry(entry => {\n    let state = FileItemState.IDLE;\n    if (entry.getValue('errors').length > 0) {\n      state = FileItemState.FAILED;\n    } else if (entry.getValue('isUploading')) {\n      state = FileItemState.UPLOADING;\n    } else if (entry.getValue('fileInfo')) {\n      state = FileItemState.FINISHED;\n    }\n    this.$.state = state;\n  });\n\n  /** @private */\n  _debouncedCalculateState = debounce(this._calculateState.bind(this), 100);\n  _updateHint = this._withEntry(throttle(entry => {\n    const source = entry.getValue('source');\n    const externalUrl = entry.getValue('externalUrl');\n    const noErrors = entry.getValue('errors').length === 0;\n    const noProgress = this.$.progressValue === 0;\n    const isUploading = this.$.state === FileItemState.UPLOADING;\n    const isQueued = entry.getValue('isQueued');\n    if (!noErrors || !isUploading || !noProgress) {\n      this.$.hint = '';\n      return;\n    }\n    if (isQueued) {\n      const hint = this.l10n('queued');\n      this.$.hint = hint;\n      return;\n    }\n    if (externalUrl && source && Object.values(ExternalUploadSource).includes(source)) {\n      const hint = this.l10n('waiting-for', {\n        source: this.l10n(`src-type-${source}`)\n      });\n      this.$.hint = hint;\n      return;\n    }\n    this.$.hint = '';\n  }, 100));\n\n  /**\n   * @private\n   * @param {String} id\n   */\n  _handleEntryId(id) {\n    this._reset();\n    let entry = this.uploadCollection?.read(id);\n    this._entry = entry;\n    if (!entry) {\n      return;\n    }\n    this._subEntry('uploadProgress', uploadProgress => {\n      this.$.progressValue = uploadProgress;\n      this._updateHint();\n    });\n    this._subEntry('isQueued', () => {\n      this._updateHint();\n    });\n    this._subEntry('fileName', name => {\n      this.$.itemName = name || entry.getValue('externalUrl') || this.l10n('file-no-name');\n      this._debouncedCalculateState();\n    });\n    this._subEntry('externalUrl', externalUrl => {\n      this.$.itemName = entry.getValue('fileName') || externalUrl || this.l10n('file-no-name');\n    });\n    this._subEntry('fileInfo', () => {\n      this._debouncedCalculateState();\n    });\n    this._subEntry('errors', () => this._debouncedCalculateState());\n    this._subEntry('isUploading', () => this._debouncedCalculateState());\n    this._subEntry('fileSize', () => this._debouncedCalculateState());\n    this._subEntry('mimeType', () => this._debouncedCalculateState());\n    this._subEntry('isImage', () => this._debouncedCalculateState());\n  }\n\n  /** @param {boolean} value */\n  _updateShowFileNames(value) {\n    const isListMode = this.cfg.filesViewMode === 'list';\n    if (isListMode) {\n      this.$.showFileNames = true;\n      return;\n    }\n    this.$.showFileNames = value;\n  }\n  initCallback() {\n    super.initCallback();\n    this.sub('uid', uid => {\n      this._handleEntryId(uid);\n    });\n    this.sub('state', state => {\n      this._handleState(state);\n    });\n    this.subConfigValue('useCloudImageEditor', () => this._debouncedCalculateState());\n    this.subConfigValue('filesViewMode', mode => {\n      this._updateShowFileNames(this.cfg.gridShowFileNames);\n      this.setAttribute('mode', mode);\n    });\n    this.subConfigValue('gridShowFileNames', value => {\n      this._updateShowFileNames(value);\n    });\n    this.onclick = () => {\n      FileItem.activeInstances.forEach(inst => {\n        if (inst === this) {\n          inst.setAttribute('focused', '');\n        } else {\n          inst.removeAttribute('focused');\n        }\n      });\n    };\n    this.sub('*uploadTrigger', /** @param {Set<string>} itemsToUpload */\n    itemsToUpload => {\n      if (this._entry && !itemsToUpload.has(this._entry.uid)) {\n        return;\n      }\n      setTimeout(() => this.isConnected && this.upload());\n    });\n    FileItem.activeInstances.add(this);\n  }\n  _handleState = this._withEntry(/** @param {(typeof FileItemState)[keyof typeof FileItemState]} state */\n  (entry, state) => {\n    if (state === FileItemState.FAILED) {\n      this.$.badgeIcon = 'badge-error';\n    } else if (state === FileItemState.FINISHED) {\n      this.$.badgeIcon = 'badge-success';\n    }\n    if (state === FileItemState.UPLOADING) {\n      this.$.isFocused = false;\n    }\n    const fileName = entry.getValue('fileName');\n    this.set$({\n      isFailed: state === FileItemState.FAILED,\n      isUploading: state === FileItemState.UPLOADING,\n      isFinished: state === FileItemState.FINISHED,\n      progressVisible: state === FileItemState.UPLOADING,\n      isEditable: this.cfg.useCloudImageEditor && this._entry?.getValue('isImage') && this._entry?.getValue('cdnUrl'),\n      errorText: entry.getValue('errors')?.[0]?.message,\n      ariaLabelStatusFile: fileName && this.l10n('a11y-file-item-status', {\n        fileName,\n        status: this.l10n(state?.description?.toLocaleLowerCase() ?? '').toLocaleLowerCase()\n      })\n    });\n    this._updateHint();\n  });\n  destroyCallback() {\n    super.destroyCallback();\n    FileItem.activeInstances.delete(this);\n    this._reset();\n  }\n  connectedCallback() {\n    super.connectedCallback();\n\n    /** @private */\n    this._observer = new window.IntersectionObserver(this._observerCallback.bind(this), {\n      threshold: [0, 1]\n    });\n    this._observer.observe(this);\n  }\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this._observer?.disconnect();\n  }\n  _settingsOfShrink() {\n    return parseShrink(this.cfg.imageShrink);\n  }\n\n  /**\n   * @private\n   * @param {File} file\n   */\n  _processShrink(file) {\n    return shrinkFile(file, this._settingsOfShrink());\n  }\n  upload = this._withEntry(async entry => {\n    if (!this.uploadCollection.read(entry.uid)) {\n      return;\n    }\n    if (entry.getValue('fileInfo') || entry.getValue('isUploading') || entry.getValue('errors').length > 0) {\n      return;\n    }\n    const multipleMax = this.cfg.multiple ? this.cfg.multipleMax : 1;\n    if (multipleMax && this.uploadCollection.size > multipleMax) {\n      return;\n    }\n    this._debouncedCalculateState();\n    entry.setMultipleValues({\n      isUploading: true,\n      errors: [],\n      isQueued: true\n    });\n    try {\n      let abortController = new AbortController();\n      entry.setValue('abortController', abortController);\n      const uploadTask = async () => {\n        entry.setValue('isQueued', false);\n        /** @type {Blob | File | null} */\n        let file = entry.getValue('file');\n        if (file && this.cfg.imageShrink) {\n          file = await this._processShrink(/** @type {File} */file).catch(() => file);\n        }\n        const fileInput = file || entry.getValue('externalUrl') || entry.getValue('uuid');\n        if (!fileInput) {\n          throw new Error('No file input');\n        }\n        const baseUploadClientOptions = await this.getUploadClientOptions();\n        /** @type {import('@uploadcare/upload-client').FileFromOptions} */\n        const uploadClientOptions = {\n          ...baseUploadClientOptions,\n          fileName: entry.getValue('fileName') ?? undefined,\n          source: entry.getValue('source') ?? undefined,\n          onProgress: progress => {\n            if (progress.isComputable) {\n              let percentage = progress.value * 100;\n              entry.setValue('uploadProgress', percentage);\n            }\n          },\n          signal: abortController.signal,\n          metadata: await this.getMetadataFor(entry.uid)\n        };\n        this.debugPrint('upload options', fileInput, uploadClientOptions);\n        return uploadFile(fileInput, uploadClientOptions);\n      };\n\n      /** @type {import('@uploadcare/upload-client').UploadcareFile} */\n      let fileInfo = await this.$['*uploadQueue'].add(uploadTask);\n      entry.setMultipleValues({\n        fileInfo,\n        isQueued: false,\n        isUploading: false,\n        fileName: fileInfo.originalFilename,\n        fileSize: fileInfo.size,\n        isImage: fileInfo.isImage ?? false,\n        mimeType: fileInfo.contentInfo?.mime?.mime ?? fileInfo.mimeType,\n        uuid: fileInfo.uuid,\n        cdnUrl: entry.getValue('cdnUrl') ?? fileInfo.cdnUrl,\n        cdnUrlModifiers: entry.getValue('cdnUrlModifiers') ?? '',\n        uploadProgress: 100,\n        source: entry.getValue('source') ?? null\n      });\n      if (entry === this._entry) {\n        this._debouncedCalculateState();\n      }\n    } catch (cause) {\n      if (cause instanceof CancelError && cause.isCancel) {\n        entry.setMultipleValues({\n          isUploading: false,\n          uploadProgress: 0\n        });\n      } else if (cause instanceof UploadcareError) {\n        entry.setMultipleValues({\n          isUploading: false,\n          uploadProgress: 0,\n          uploadError: cause\n        });\n      } else {\n        console.error('Unknown upload error', cause);\n        entry.setMultipleValues({\n          isUploading: false,\n          uploadProgress: 0,\n          // TODO: Add translation?\n          uploadError: new Error('Something went wrong', {\n            cause\n          })\n        });\n      }\n      if (entry === this._entry) {\n        this._debouncedCalculateState();\n      }\n    }\n  });\n}\nFileItem.template = /* HTML */`\n  <div class=\"uc-inner\" set=\"@finished: isFinished; @uploading: isUploading; @failed: isFailed; @focused: isFocused\">\n    <uc-thumb set=\"uid:uid;badgeIcon:badgeIcon\"></uc-thumb>\n\n    <div aria-atomic=\"true\" aria-live=\"polite\" class=\"uc-file-name-wrapper\" set=\"@aria-label:ariaLabelStatusFile;\">\n      <span class=\"uc-file-name\" set=\"@hidden: !showFileNames\">{{itemName}}</span>\n      <span class=\"uc-file-error\" set=\"@hidden: !errorText;\">{{errorText}}</span>\n      <span class=\"uc-file-hint\" set=\"@hidden: !hint\">{{hint}}</span>\n    </div>\n    <div class=\"uc-file-actions\">\n      <button\n        type=\"button\"\n        l10n=\"@title:file-item-edit-button;@aria-label:file-item-edit-button\"\n        class=\"uc-edit-btn uc-mini-btn\"\n        set=\"onclick: onEdit; @hidden: !isEditable\"\n      >\n        <uc-icon name=\"edit-file\"></uc-icon>\n      </button>\n      <button\n        type=\"button\"\n        l10n=\"@title:file-item-remove-button;@aria-label:file-item-remove-button\"\n        class=\"uc-remove-btn uc-mini-btn\"\n        set=\"onclick: onRemove;\"\n      >\n        <uc-icon name=\"remove-file\"></uc-icon>\n      </button>\n      <button type=\"button\" class=\"uc-upload-btn uc-mini-btn\" set=\"onclick: onUpload;\">\n        <uc-icon name=\"upload\"></uc-icon>\n      </button>\n    </div>\n    <uc-progress-bar\n      class=\"uc-progress-bar\"\n      set=\"value: progressValue; visible: progressVisible; @hasFileName: showFileNames;\"\n    >\n    </uc-progress-bar>\n  </div>\n`;\nFileItem.activeInstances = new Set();","map":{"version":3,"names":["shrinkFile","CancelError","UploadcareError","uploadFile","ActivityBlock","parseShrink","ExternalUploadSource","debounce","throttle","FileItemConfig","FileItemState","Object","freeze","FINISHED","Symbol","FAILED","UPLOADING","IDLE","FileItem","couldBeCtxOwner","pauseRender","_renderedOnce","constructor","init$","uid","itemName","errorText","hint","thumbUrl","progressValue","progressVisible","badgeIcon","isFinished","isFailed","isUploading","isFocused","isEditable","showFileNames","state","ariaLabelStatusFile","onEdit","_withEntry","entry","$","internalId","modalManager","open","activities","CLOUD_IMG_EDIT","onRemove","uploadCollection","remove","onUpload","upload","_reset","_debouncedCalculateState","cancel","_observerCallback","entries","_isIntersecting","isIntersecting","_thumbRect","boundingClientRect","render","_calculateState","getValue","length","bind","_updateHint","source","externalUrl","noErrors","noProgress","isQueued","l10n","values","includes","_handleEntryId","id","read","_entry","_subEntry","uploadProgress","name","_updateShowFileNames","value","isListMode","cfg","filesViewMode","initCallback","sub","_handleState","subConfigValue","mode","gridShowFileNames","setAttribute","onclick","activeInstances","forEach","inst","removeAttribute","itemsToUpload","has","setTimeout","isConnected","add","fileName","set$","useCloudImageEditor","message","status","description","toLocaleLowerCase","destroyCallback","delete","connectedCallback","_observer","window","IntersectionObserver","threshold","observe","disconnectedCallback","disconnect","_settingsOfShrink","imageShrink","_processShrink","file","multipleMax","multiple","size","setMultipleValues","errors","abortController","AbortController","setValue","uploadTask","catch","fileInput","Error","baseUploadClientOptions","getUploadClientOptions","uploadClientOptions","undefined","onProgress","progress","isComputable","percentage","signal","metadata","getMetadataFor","debugPrint","fileInfo","originalFilename","fileSize","isImage","mimeType","contentInfo","mime","uuid","cdnUrl","cdnUrlModifiers","cause","isCancel","uploadError","console","error","template","Set"],"sources":["/Users/kavinth/Documents/GitHub/Smart-Alert/Smart-Alert-new/frontend/node_modules/@uploadcare/file-uploader/blocks/FileItem/FileItem.js"],"sourcesContent":["// @ts-check\nimport { shrinkFile } from '@uploadcare/image-shrink';\nimport { CancelError, UploadcareError, uploadFile } from '@uploadcare/upload-client';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { parseShrink } from '../../utils/parseShrink.js';\nimport { ExternalUploadSource } from '../utils/UploadSource.js';\nimport { debounce } from '../utils/debounce.js';\nimport { throttle } from '../utils/throttle.js';\nimport { FileItemConfig } from './FileItemConfig.js';\n\nconst FileItemState = Object.freeze({\n  FINISHED: Symbol('FINISHED'),\n  FAILED: Symbol('FAILED'),\n  UPLOADING: Symbol('UPLOADING'),\n  IDLE: Symbol('IDLE'),\n});\n\nexport class FileItem extends FileItemConfig {\n  couldBeCtxOwner = true;\n  pauseRender = true;\n\n  /** @private */\n  _renderedOnce = false;\n\n  constructor() {\n    super();\n\n    this.init$ = {\n      ...this.init$,\n      uid: '',\n      itemName: '',\n      errorText: '',\n      hint: '',\n      thumbUrl: '',\n      progressValue: 0,\n      progressVisible: false,\n      badgeIcon: '',\n      isFinished: false,\n      isFailed: false,\n      isUploading: false,\n      isFocused: false,\n      isEditable: false,\n      showFileNames: false,\n      state: FileItemState.IDLE,\n      ariaLabelStatusFile: '',\n      onEdit: this._withEntry((entry) => {\n        this.$['*currentActivityParams'] = {\n          internalId: entry.uid,\n        };\n        this.modalManager.open(ActivityBlock.activities.CLOUD_IMG_EDIT);\n        this.$['*currentActivity'] = ActivityBlock.activities.CLOUD_IMG_EDIT;\n      }),\n      onRemove: () => {\n        this.uploadCollection.remove(this.$.uid);\n      },\n      onUpload: () => {\n        this.upload();\n      },\n    };\n  }\n\n  _reset() {\n    super._reset();\n    this._debouncedCalculateState.cancel();\n  }\n\n  /**\n   * @private\n   * @param {IntersectionObserverEntry[]} entries\n   */\n  _observerCallback(entries) {\n    let [entry] = entries;\n\n    this._isIntersecting = entry.isIntersecting;\n    this._thumbRect = entry.boundingClientRect;\n\n    if (entry.isIntersecting && !this._renderedOnce) {\n      this.render();\n      this._renderedOnce = true;\n    }\n  }\n\n  /** @private */\n  _calculateState = this._withEntry((entry) => {\n    let state = FileItemState.IDLE;\n\n    if (entry.getValue('errors').length > 0) {\n      state = FileItemState.FAILED;\n    } else if (entry.getValue('isUploading')) {\n      state = FileItemState.UPLOADING;\n    } else if (entry.getValue('fileInfo')) {\n      state = FileItemState.FINISHED;\n    }\n\n    this.$.state = state;\n  });\n\n  /** @private */\n  _debouncedCalculateState = debounce(this._calculateState.bind(this), 100);\n\n  _updateHint = this._withEntry(\n    throttle((entry) => {\n      const source = entry.getValue('source');\n      const externalUrl = entry.getValue('externalUrl');\n      const noErrors = entry.getValue('errors').length === 0;\n      const noProgress = this.$.progressValue === 0;\n      const isUploading = this.$.state === FileItemState.UPLOADING;\n      const isQueued = entry.getValue('isQueued');\n\n      if (!noErrors || !isUploading || !noProgress) {\n        this.$.hint = '';\n        return;\n      }\n\n      if (isQueued) {\n        const hint = this.l10n('queued');\n        this.$.hint = hint;\n        return;\n      }\n\n      if (externalUrl && source && Object.values(ExternalUploadSource).includes(source)) {\n        const hint = this.l10n('waiting-for', { source: this.l10n(`src-type-${source}`) });\n        this.$.hint = hint;\n        return;\n      }\n\n      this.$.hint = '';\n    }, 100),\n  );\n\n  /**\n   * @private\n   * @param {String} id\n   */\n  _handleEntryId(id) {\n    this._reset();\n\n    let entry = this.uploadCollection?.read(id);\n    this._entry = entry;\n\n    if (!entry) {\n      return;\n    }\n\n    this._subEntry('uploadProgress', (uploadProgress) => {\n      this.$.progressValue = uploadProgress;\n      this._updateHint();\n    });\n\n    this._subEntry('isQueued', () => {\n      this._updateHint();\n    });\n\n    this._subEntry('fileName', (name) => {\n      this.$.itemName = name || entry.getValue('externalUrl') || this.l10n('file-no-name');\n      this._debouncedCalculateState();\n    });\n\n    this._subEntry('externalUrl', (externalUrl) => {\n      this.$.itemName = entry.getValue('fileName') || externalUrl || this.l10n('file-no-name');\n    });\n\n    this._subEntry('fileInfo', () => {\n      this._debouncedCalculateState();\n    });\n\n    this._subEntry('errors', () => this._debouncedCalculateState());\n    this._subEntry('isUploading', () => this._debouncedCalculateState());\n    this._subEntry('fileSize', () => this._debouncedCalculateState());\n    this._subEntry('mimeType', () => this._debouncedCalculateState());\n    this._subEntry('isImage', () => this._debouncedCalculateState());\n  }\n\n  /** @param {boolean} value */\n  _updateShowFileNames(value) {\n    const isListMode = this.cfg.filesViewMode === 'list';\n    if (isListMode) {\n      this.$.showFileNames = true;\n      return;\n    }\n\n    this.$.showFileNames = value;\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this.sub('uid', (uid) => {\n      this._handleEntryId(uid);\n    });\n\n    this.sub('state', (state) => {\n      this._handleState(state);\n    });\n\n    this.subConfigValue('useCloudImageEditor', () => this._debouncedCalculateState());\n\n    this.subConfigValue('filesViewMode', (mode) => {\n      this._updateShowFileNames(this.cfg.gridShowFileNames);\n\n      this.setAttribute('mode', mode);\n    });\n\n    this.subConfigValue('gridShowFileNames', (value) => {\n      this._updateShowFileNames(value);\n    });\n\n    this.onclick = () => {\n      FileItem.activeInstances.forEach((inst) => {\n        if (inst === this) {\n          inst.setAttribute('focused', '');\n        } else {\n          inst.removeAttribute('focused');\n        }\n      });\n    };\n\n    this.sub(\n      '*uploadTrigger',\n      /** @param {Set<string>} itemsToUpload */\n      (itemsToUpload) => {\n        if (this._entry && !itemsToUpload.has(this._entry.uid)) {\n          return;\n        }\n        setTimeout(() => this.isConnected && this.upload());\n      },\n    );\n    FileItem.activeInstances.add(this);\n  }\n\n  _handleState = this._withEntry(\n    /** @param {(typeof FileItemState)[keyof typeof FileItemState]} state */\n    (entry, state) => {\n      if (state === FileItemState.FAILED) {\n        this.$.badgeIcon = 'badge-error';\n      } else if (state === FileItemState.FINISHED) {\n        this.$.badgeIcon = 'badge-success';\n      }\n\n      if (state === FileItemState.UPLOADING) {\n        this.$.isFocused = false;\n      }\n      const fileName = entry.getValue('fileName');\n\n      this.set$({\n        isFailed: state === FileItemState.FAILED,\n        isUploading: state === FileItemState.UPLOADING,\n        isFinished: state === FileItemState.FINISHED,\n        progressVisible: state === FileItemState.UPLOADING,\n        isEditable: this.cfg.useCloudImageEditor && this._entry?.getValue('isImage') && this._entry?.getValue('cdnUrl'),\n        errorText: entry.getValue('errors')?.[0]?.message,\n        ariaLabelStatusFile:\n          fileName &&\n          this.l10n('a11y-file-item-status', {\n            fileName,\n            status: this.l10n(state?.description?.toLocaleLowerCase() ?? '').toLocaleLowerCase(),\n          }),\n      });\n\n      this._updateHint();\n    },\n  );\n\n  destroyCallback() {\n    super.destroyCallback();\n\n    FileItem.activeInstances.delete(this);\n\n    this._reset();\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    /** @private */\n    this._observer = new window.IntersectionObserver(this._observerCallback.bind(this), {\n      threshold: [0, 1],\n    });\n    this._observer.observe(this);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    this._observer?.disconnect();\n  }\n\n  _settingsOfShrink() {\n    return parseShrink(this.cfg.imageShrink);\n  }\n\n  /**\n   * @private\n   * @param {File} file\n   */\n  _processShrink(file) {\n    return shrinkFile(file, this._settingsOfShrink());\n  }\n\n  upload = this._withEntry(async (entry) => {\n    if (!this.uploadCollection.read(entry.uid)) {\n      return;\n    }\n\n    if (entry.getValue('fileInfo') || entry.getValue('isUploading') || entry.getValue('errors').length > 0) {\n      return;\n    }\n    const multipleMax = this.cfg.multiple ? this.cfg.multipleMax : 1;\n    if (multipleMax && this.uploadCollection.size > multipleMax) {\n      return;\n    }\n\n    this._debouncedCalculateState();\n\n    entry.setMultipleValues({\n      isUploading: true,\n      errors: [],\n      isQueued: true,\n    });\n\n    try {\n      let abortController = new AbortController();\n      entry.setValue('abortController', abortController);\n\n      const uploadTask = async () => {\n        entry.setValue('isQueued', false);\n        /** @type {Blob | File | null} */\n        let file = entry.getValue('file');\n        if (file && this.cfg.imageShrink) {\n          file = await this._processShrink(/** @type {File} */ (file)).catch(() => file);\n        }\n\n        const fileInput = file || entry.getValue('externalUrl') || entry.getValue('uuid');\n        if (!fileInput) {\n          throw new Error('No file input');\n        }\n        const baseUploadClientOptions = await this.getUploadClientOptions();\n        /** @type {import('@uploadcare/upload-client').FileFromOptions} */\n        const uploadClientOptions = {\n          ...baseUploadClientOptions,\n          fileName: entry.getValue('fileName') ?? undefined,\n          source: entry.getValue('source') ?? undefined,\n          onProgress: (progress) => {\n            if (progress.isComputable) {\n              let percentage = progress.value * 100;\n              entry.setValue('uploadProgress', percentage);\n            }\n          },\n          signal: abortController.signal,\n          metadata: await this.getMetadataFor(entry.uid),\n        };\n        this.debugPrint('upload options', fileInput, uploadClientOptions);\n        return uploadFile(fileInput, uploadClientOptions);\n      };\n\n      /** @type {import('@uploadcare/upload-client').UploadcareFile} */\n      let fileInfo = await this.$['*uploadQueue'].add(uploadTask);\n      entry.setMultipleValues({\n        fileInfo,\n        isQueued: false,\n        isUploading: false,\n        fileName: fileInfo.originalFilename,\n        fileSize: fileInfo.size,\n        isImage: fileInfo.isImage ?? false,\n        mimeType: fileInfo.contentInfo?.mime?.mime ?? fileInfo.mimeType,\n        uuid: fileInfo.uuid,\n        cdnUrl: entry.getValue('cdnUrl') ?? fileInfo.cdnUrl,\n        cdnUrlModifiers: entry.getValue('cdnUrlModifiers') ?? '',\n        uploadProgress: 100,\n        source: entry.getValue('source') ?? null,\n      });\n\n      if (entry === this._entry) {\n        this._debouncedCalculateState();\n      }\n    } catch (cause) {\n      if (cause instanceof CancelError && cause.isCancel) {\n        entry.setMultipleValues({\n          isUploading: false,\n          uploadProgress: 0,\n        });\n      } else if (cause instanceof UploadcareError) {\n        entry.setMultipleValues({\n          isUploading: false,\n          uploadProgress: 0,\n          uploadError: cause,\n        });\n      } else {\n        console.error('Unknown upload error', cause);\n        entry.setMultipleValues({\n          isUploading: false,\n          uploadProgress: 0,\n          // TODO: Add translation?\n          uploadError: new Error('Something went wrong', {\n            cause,\n          }),\n        });\n      }\n\n      if (entry === this._entry) {\n        this._debouncedCalculateState();\n      }\n    }\n  });\n}\n\nFileItem.template = /* HTML */ `\n  <div class=\"uc-inner\" set=\"@finished: isFinished; @uploading: isUploading; @failed: isFailed; @focused: isFocused\">\n    <uc-thumb set=\"uid:uid;badgeIcon:badgeIcon\"></uc-thumb>\n\n    <div aria-atomic=\"true\" aria-live=\"polite\" class=\"uc-file-name-wrapper\" set=\"@aria-label:ariaLabelStatusFile;\">\n      <span class=\"uc-file-name\" set=\"@hidden: !showFileNames\">{{itemName}}</span>\n      <span class=\"uc-file-error\" set=\"@hidden: !errorText;\">{{errorText}}</span>\n      <span class=\"uc-file-hint\" set=\"@hidden: !hint\">{{hint}}</span>\n    </div>\n    <div class=\"uc-file-actions\">\n      <button\n        type=\"button\"\n        l10n=\"@title:file-item-edit-button;@aria-label:file-item-edit-button\"\n        class=\"uc-edit-btn uc-mini-btn\"\n        set=\"onclick: onEdit; @hidden: !isEditable\"\n      >\n        <uc-icon name=\"edit-file\"></uc-icon>\n      </button>\n      <button\n        type=\"button\"\n        l10n=\"@title:file-item-remove-button;@aria-label:file-item-remove-button\"\n        class=\"uc-remove-btn uc-mini-btn\"\n        set=\"onclick: onRemove;\"\n      >\n        <uc-icon name=\"remove-file\"></uc-icon>\n      </button>\n      <button type=\"button\" class=\"uc-upload-btn uc-mini-btn\" set=\"onclick: onUpload;\">\n        <uc-icon name=\"upload\"></uc-icon>\n      </button>\n    </div>\n    <uc-progress-bar\n      class=\"uc-progress-bar\"\n      set=\"value: progressValue; visible: progressVisible; @hasFileName: showFileNames;\"\n    >\n    </uc-progress-bar>\n  </div>\n`;\nFileItem.activeInstances = new Set();\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
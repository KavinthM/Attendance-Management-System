{"ast":null,"code":"var _jsxFileName = \"/Users/kavinth/Documents/GitHub/Smart-Alert/Smart-Alert-new/frontend/src/Components/DirectMessages/DirectMessages.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport './DirectMessages.css';\n\n// Demo IDs (replace with real IDs from your app)\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst DEMO_CLASS_ID = '6510e1f1e1f1e1f1e1f1e1f1';\nconst DEMO_PARENT_ID = '6510e1f1e1f1e1f1e1f1e1f2';\nconst DEMO_TEACHER_ID = '6510e1f1e1f1e1f1e1f1e1f3';\nconst DirectMessages = ({\n  userType\n}) => {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [editId, setEditId] = useState(null);\n  const [editText, setEditText] = useState('');\n  const [showActionsId, setShowActionsId] = useState(null);\n  const chatRef = useRef(null);\n\n  // Helper to determine message side based on userType and sender\n  const getMessageSide = senderId => {\n    if (userType === 'parent') {\n      return senderId === DEMO_PARENT_ID ? 'right' : 'left';\n    } else {\n      return senderId === DEMO_TEACHER_ID ? 'right' : 'left';\n    }\n  };\n\n  // Helper to check edit/delete time limits\n  function canEditMessage(msg) {\n    const now = Date.now();\n    const sent = new Date(msg.sentAt || msg.createdAt).getTime();\n    return now - sent <= 10 * 60 * 1000; // 10 minutes\n  }\n  function canDeleteMessage(msg) {\n    const now = Date.now();\n    const sent = new Date(msg.sentAt || msg.createdAt).getTime();\n    return now - sent <= 24 * 60 * 60 * 1000; // 24 hours\n  }\n\n  // Show hover actions/drop menu only within 2 hours of sending\n  function canShowActionsMenu(msg) {\n    const now = Date.now();\n    const sent = new Date(msg.sentAt || msg.createdAt).getTime();\n    return now - sent <= 2 * 60 * 60 * 1000; // 2 hours\n  }\n\n  // Format date for display\n  function formatDate(dateStr) {\n    const d = new Date(dateStr);\n    const today = new Date();\n    if (d.toDateString() === today.toDateString()) {\n      return 'Today';\n    }\n    return d.toLocaleDateString(undefined, {\n      weekday: 'long',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  }\n  // Format time for display\n  function formatTime(dateStr) {\n    const d = new Date(dateStr);\n    return d.toLocaleTimeString(undefined, {\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  }\n\n  // Fetch messages from backend\n  useEffect(() => {\n    const fetchMessages = async () => {\n      try {\n        const res = await axios.get(`/chat/${DEMO_CLASS_ID}/${DEMO_PARENT_ID}/${DEMO_TEACHER_ID}`);\n        setMessages(res.data);\n      } catch (err) {\n        setMessages([]);\n      }\n    };\n    fetchMessages();\n  }, []);\n\n  // Scroll chat to bottom when messages change\n  useEffect(() => {\n    if (chatRef.current) {\n      chatRef.current.scrollTop = chatRef.current.scrollHeight;\n    }\n  }, [messages]);\n\n  // Send message to backend\n  const handleSend = async () => {\n    if (input.trim() === '') return;\n    const fromUserId = userType === 'parent' ? DEMO_PARENT_ID : DEMO_TEACHER_ID;\n    const toUserId = userType === 'parent' ? DEMO_TEACHER_ID : DEMO_PARENT_ID;\n    try {\n      await axios.post('/chat', {\n        fromUserId,\n        toUserId,\n        classId: DEMO_CLASS_ID,\n        messageContent: input\n      });\n      // Refresh messages\n      const res = await axios.get(`/chat/${DEMO_CLASS_ID}/${DEMO_PARENT_ID}/${DEMO_TEACHER_ID}`);\n      setMessages(res.data);\n      setInput('');\n    } catch (err) {\n      // handle error\n    }\n  };\n\n  // Edit message\n  const handleEditSave = async id => {\n    try {\n      await axios.put(`/chat/${id}`, {\n        messageContent: editText\n      });\n      const res = await axios.get(`/chat/${DEMO_CLASS_ID}/${DEMO_PARENT_ID}/${DEMO_TEACHER_ID}`);\n      setMessages(res.data);\n      setEditId(null);\n      setEditText('');\n    } catch (err) {\n      // handle error\n    }\n  };\n\n  // Delete message\n  const handleDelete = async id => {\n    try {\n      await axios.delete(`/chat/${id}`);\n      const res = await axios.get(`/chat/${DEMO_CLASS_ID}/${DEMO_PARENT_ID}/${DEMO_TEACHER_ID}`);\n      setMessages(res.data);\n    } catch (err) {\n      // handle error\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"section-title\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Direct Messages\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Chat securely between teachers and parents\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"dm-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"dm-chat\",\n        ref: chatRef,\n        children: (() => {\n          let lastDate = null;\n          return messages.map((m, i) => {\n            const msgDate = new Date(m.sentAt || m.createdAt).toDateString();\n            const showDate = lastDate !== msgDate;\n            lastDate = msgDate;\n            return /*#__PURE__*/_jsxDEV(React.Fragment, {\n              children: [showDate && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"dm-date-separator\",\n                children: formatDate(m.sentAt || m.createdAt)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 143,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `dm-message-bubble ${getMessageSide(m.fromUserId)}`,\n                style: {\n                  alignSelf: getMessageSide(m.fromUserId) === 'right' ? 'flex-end' : 'flex-start'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"dm-message-meta\",\n                  style: {\n                    position: 'relative',\n                    display: 'flex',\n                    flexDirection: 'row',\n                    alignItems: 'center',\n                    gap: '6px'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"dm-sender\",\n                    children: getMessageSide(m.fromUserId) === 'right' ? 'You' : userType === 'parent' ? 'Teacher' : 'Parent'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 150,\n                    columnNumber: 23\n                  }, this), (userType === 'parent' && m.fromUserId === DEMO_PARENT_ID || userType === 'teacher' && m.fromUserId === DEMO_TEACHER_ID) && canShowActionsMenu(m) && /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"dm-more-btn\",\n                    style: {\n                      background: 'none',\n                      border: 'none',\n                      color: '#1976d2',\n                      fontSize: '1em',\n                      cursor: 'pointer',\n                      padding: 0,\n                      display: 'none',\n                      verticalAlign: 'middle'\n                    },\n                    onClick: () => setShowActionsId(showActionsId === m._id ? null : m._id),\n                    \"aria-label\": \"Show actions\",\n                    children: \"\\u02C5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 156,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 149,\n                  columnNumber: 21\n                }, this), editId === m._id ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    value: editText,\n                    onChange: e => setEditText(e.target.value)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 166,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"btn-primary\",\n                    onClick: () => handleEditSave(m._id),\n                    children: \"Save\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 167,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"btn-primary\",\n                    onClick: () => setEditId(null),\n                    children: \"Cancel\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 168,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"dm-text\",\n                    children: m.messageContent\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 172,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"dm-time\",\n                    style: {\n                      display: 'block',\n                      marginTop: 2,\n                      textAlign: 'right',\n                      color: '#888',\n                      fontSize: '0.95em'\n                    },\n                    children: formatTime(m.sentAt || m.createdAt)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 173,\n                    columnNumber: 25\n                  }, this), (userType === 'parent' && m.fromUserId === DEMO_PARENT_ID || userType === 'teacher' && m.fromUserId === DEMO_TEACHER_ID) && canShowActionsMenu(m) && showActionsId === m._id && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"dm-actions-hover\",\n                    style: {\n                      width: '100%',\n                      display: 'flex',\n                      flexDirection: 'row',\n                      justifyContent: 'center',\n                      gap: '8px',\n                      marginTop: 8\n                    },\n                    children: [canEditMessage(m) && /*#__PURE__*/_jsxDEV(\"button\", {\n                      className: \"btn-primary dm-edit\",\n                      onClick: () => {\n                        setEditId(m._id);\n                        setEditText(m.messageContent);\n                        setShowActionsId(null);\n                      },\n                      children: \"Edit\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 179,\n                      columnNumber: 51\n                    }, this), canDeleteMessage(m) && /*#__PURE__*/_jsxDEV(\"button\", {\n                      className: \"btn-primary dm-delete\",\n                      onClick: () => {\n                        handleDelete(m._id);\n                        setShowActionsId(null);\n                      },\n                      children: \"Delete\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 180,\n                      columnNumber: 53\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 175,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 145,\n                columnNumber: 19\n              }, this)]\n            }, m._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 141,\n              columnNumber: 17\n            }, this);\n          });\n        })()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"dm-input-row\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: input,\n          onChange: e => setInput(e.target.value),\n          placeholder: \"Type your message...\",\n          onKeyDown: e => {\n            if (e.key === 'Enter') handleSend();\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-primary\",\n          onClick: handleSend,\n          children: \"Send\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 127,\n    columnNumber: 5\n  }, this);\n};\n_s(DirectMessages, \"y4opJyvg6AEd3rWshx+bTSkBFBc=\");\n_c = DirectMessages;\nexport default DirectMessages;\nvar _c;\n$RefreshReg$(_c, \"DirectMessages\");","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","jsxDEV","_jsxDEV","Fragment","_Fragment","DEMO_CLASS_ID","DEMO_PARENT_ID","DEMO_TEACHER_ID","DirectMessages","userType","_s","messages","setMessages","input","setInput","editId","setEditId","editText","setEditText","showActionsId","setShowActionsId","chatRef","getMessageSide","senderId","canEditMessage","msg","now","Date","sent","sentAt","createdAt","getTime","canDeleteMessage","canShowActionsMenu","formatDate","dateStr","d","today","toDateString","toLocaleDateString","undefined","weekday","year","month","day","formatTime","toLocaleTimeString","hour","minute","fetchMessages","res","get","data","err","current","scrollTop","scrollHeight","handleSend","trim","fromUserId","toUserId","post","classId","messageContent","handleEditSave","id","put","handleDelete","delete","className","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","lastDate","map","m","i","msgDate","showDate","style","alignSelf","position","display","flexDirection","alignItems","gap","background","border","color","fontSize","cursor","padding","verticalAlign","onClick","_id","value","onChange","e","target","marginTop","textAlign","width","justifyContent","type","placeholder","onKeyDown","key","_c","$RefreshReg$"],"sources":["/Users/kavinth/Documents/GitHub/Smart-Alert/Smart-Alert-new/frontend/src/Components/DirectMessages/DirectMessages.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport './DirectMessages.css';\n\n// Demo IDs (replace with real IDs from your app)\nconst DEMO_CLASS_ID = '6510e1f1e1f1e1f1e1f1e1f1';\nconst DEMO_PARENT_ID = '6510e1f1e1f1e1f1e1f1e1f2';\nconst DEMO_TEACHER_ID = '6510e1f1e1f1e1f1e1f1e1f3';\n\nconst DirectMessages = ({ userType }) => {\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [editId, setEditId] = useState(null);\n  const [editText, setEditText] = useState('');\n  const [showActionsId, setShowActionsId] = useState(null);\n  const chatRef = useRef(null);\n\n  // Helper to determine message side based on userType and sender\n  const getMessageSide = (senderId) => {\n    if (userType === 'parent') {\n      return senderId === DEMO_PARENT_ID ? 'right' : 'left';\n    } else {\n      return senderId === DEMO_TEACHER_ID ? 'right' : 'left';\n    }\n  };\n\n  // Helper to check edit/delete time limits\n  function canEditMessage(msg) {\n    const now = Date.now();\n    const sent = new Date(msg.sentAt || msg.createdAt).getTime();\n    return (now - sent) <= 10 * 60 * 1000; // 10 minutes\n  }\n  function canDeleteMessage(msg) {\n    const now = Date.now();\n    const sent = new Date(msg.sentAt || msg.createdAt).getTime();\n    return (now - sent) <= 24 * 60 * 60 * 1000; // 24 hours\n  }\n\n  // Show hover actions/drop menu only within 2 hours of sending\n  function canShowActionsMenu(msg) {\n    const now = Date.now();\n    const sent = new Date(msg.sentAt || msg.createdAt).getTime();\n    return (now - sent) <= 2 * 60 * 60 * 1000; // 2 hours\n  }\n\n  // Format date for display\n  function formatDate(dateStr) {\n    const d = new Date(dateStr);\n    const today = new Date();\n    if (d.toDateString() === today.toDateString()) {\n      return 'Today';\n    }\n    return d.toLocaleDateString(undefined, { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });\n  }\n  // Format time for display\n  function formatTime(dateStr) {\n    const d = new Date(dateStr);\n    return d.toLocaleTimeString(undefined, { hour: '2-digit', minute: '2-digit' });\n  }\n\n  // Fetch messages from backend\n  useEffect(() => {\n    const fetchMessages = async () => {\n      try {\n        const res = await axios.get(`/chat/${DEMO_CLASS_ID}/${DEMO_PARENT_ID}/${DEMO_TEACHER_ID}`);\n        setMessages(res.data);\n      } catch (err) {\n        setMessages([]);\n      }\n    };\n    fetchMessages();\n  }, []);\n\n  // Scroll chat to bottom when messages change\n  useEffect(() => {\n    if (chatRef.current) {\n      chatRef.current.scrollTop = chatRef.current.scrollHeight;\n    }\n  }, [messages]);\n\n  // Send message to backend\n  const handleSend = async () => {\n    if (input.trim() === '') return;\n    const fromUserId = userType === 'parent' ? DEMO_PARENT_ID : DEMO_TEACHER_ID;\n    const toUserId = userType === 'parent' ? DEMO_TEACHER_ID : DEMO_PARENT_ID;\n    try {\n      await axios.post('/chat', {\n        fromUserId,\n        toUserId,\n        classId: DEMO_CLASS_ID,\n        messageContent: input\n      });\n      // Refresh messages\n      const res = await axios.get(`/chat/${DEMO_CLASS_ID}/${DEMO_PARENT_ID}/${DEMO_TEACHER_ID}`);\n      setMessages(res.data);\n      setInput('');\n    } catch (err) {\n      // handle error\n    }\n  };\n\n  // Edit message\n  const handleEditSave = async (id) => {\n    try {\n      await axios.put(`/chat/${id}`, { messageContent: editText });\n      const res = await axios.get(`/chat/${DEMO_CLASS_ID}/${DEMO_PARENT_ID}/${DEMO_TEACHER_ID}`);\n      setMessages(res.data);\n      setEditId(null);\n      setEditText('');\n    } catch (err) {\n      // handle error\n    }\n  };\n\n  // Delete message\n  const handleDelete = async (id) => {\n    try {\n      await axios.delete(`/chat/${id}`);\n      const res = await axios.get(`/chat/${DEMO_CLASS_ID}/${DEMO_PARENT_ID}/${DEMO_TEACHER_ID}`);\n      setMessages(res.data);\n    } catch (err) {\n      // handle error\n    }\n  };\n\n  return (\n    <div className=\"container\">\n      <div className=\"section-title\">\n        <h2>Direct Messages</h2>\n        <p>Chat securely between teachers and parents</p>\n      </div>\n      <div className=\"dm-container\">\n    <div className=\"dm-chat\" ref={chatRef}>\n          {(() => {\n            let lastDate = null;\n            return messages.map((m, i) => {\n              const msgDate = new Date(m.sentAt || m.createdAt).toDateString();\n              const showDate = lastDate !== msgDate;\n              lastDate = msgDate;\n              return (\n                <React.Fragment key={m._id}>\n                  {showDate && (\n                    <div className=\"dm-date-separator\">{formatDate(m.sentAt || m.createdAt)}</div>\n                  )}\n                  <div\n                    className={`dm-message-bubble ${getMessageSide(m.fromUserId)}`}\n                    style={{ alignSelf: getMessageSide(m.fromUserId) === 'right' ? 'flex-end' : 'flex-start' }}\n                  >\n                    <div className=\"dm-message-meta\" style={{ position: 'relative', display: 'flex', flexDirection: 'row', alignItems: 'center', gap: '6px' }}>\n                      <span className=\"dm-sender\">\n                        {getMessageSide(m.fromUserId) === 'right'\n                          ? 'You'\n                          : (userType === 'parent' ? 'Teacher' : 'Parent')}\n                      </span>\n                      {((userType === 'parent' && m.fromUserId === DEMO_PARENT_ID) || (userType === 'teacher' && m.fromUserId === DEMO_TEACHER_ID)) && canShowActionsMenu(m) && (\n                        <button\n                          className=\"dm-more-btn\"\n                          style={{ background: 'none', border: 'none', color: '#1976d2', fontSize: '1em', cursor: 'pointer', padding: 0, display: 'none', verticalAlign: 'middle' }}\n                          onClick={() => setShowActionsId(showActionsId === m._id ? null : m._id)}\n                          aria-label=\"Show actions\"\n                        >&#709;</button>\n                      )}\n                    </div>\n                    {editId === m._id ? (\n                      <>\n                        <input value={editText} onChange={e => setEditText(e.target.value)} />\n                        <button className=\"btn-primary\" onClick={() => handleEditSave(m._id)}>Save</button>\n                        <button className=\"btn-primary\" onClick={() => setEditId(null)}>Cancel</button>\n                      </>\n                    ) : (\n                      <>\n                        <span className=\"dm-text\">{m.messageContent}</span>\n                        <span className=\"dm-time\" style={{ display: 'block', marginTop: 2, textAlign: 'right', color: '#888', fontSize: '0.95em' }}>{formatTime(m.sentAt || m.createdAt)}</span>\n                        {((userType === 'parent' && m.fromUserId === DEMO_PARENT_ID) || (userType === 'teacher' && m.fromUserId === DEMO_TEACHER_ID)) && canShowActionsMenu(m) && showActionsId === m._id && (\n                          <div\n                            className=\"dm-actions-hover\"\n                            style={{ width: '100%', display: 'flex', flexDirection: 'row', justifyContent: 'center', gap: '8px', marginTop: 8 }}\n                          >\n                            {canEditMessage(m) && <button className=\"btn-primary dm-edit\" onClick={() => { setEditId(m._id); setEditText(m.messageContent); setShowActionsId(null); }}>Edit</button>}\n                            {canDeleteMessage(m) && <button className=\"btn-primary dm-delete\" onClick={() => { handleDelete(m._id); setShowActionsId(null); }}>Delete</button>}\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n                </React.Fragment>\n              );\n            });\n          })()}\n        </div>\n        <div className=\"dm-input-row\">\n          <input\n            type=\"text\"\n            value={input}\n            onChange={e => setInput(e.target.value)}\n            placeholder=\"Type your message...\"\n            onKeyDown={e => { if (e.key === 'Enter') handleSend(); }}\n          />\n          <button className=\"btn-primary\" onClick={handleSend}>Send</button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default DirectMessages;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
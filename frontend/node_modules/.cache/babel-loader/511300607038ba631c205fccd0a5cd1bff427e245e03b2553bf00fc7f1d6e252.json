{"ast":null,"code":"// @ts-check\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { CloudImageEditorBlock } from '../CloudImageEditor/index.js';\n\n/** @typedef {{ internalId: string }} ActivityParams */\n\nexport class CloudImageEditorActivity extends UploaderBlock {\n  couldBeCtxOwner = true;\n  activityType = ActivityBlock.activities.CLOUD_IMG_EDIT;\n\n  /**\n   * @private\n   * @type {import('../../abstract/TypedData.js').TypedData<\n   *       import('../../abstract/uploadEntrySchema.js').uploadEntrySchema\n   *     >\n   *   | undefined}\n   */\n  _entry;\n\n  /**\n   * @private\n   * @type {CloudImageEditorBlock | undefined}\n   */\n  _instance;\n\n  /** @type {ActivityParams} */\n  get activityParams() {\n    const params = super.activityParams;\n    if ('internalId' in params) {\n      return params;\n    }\n    throw new Error(`Cloud Image Editor activity params not found`);\n  }\n  initCallback() {\n    super.initCallback();\n    this.registerActivity(this.activityType, {\n      onActivate: () => this.mountEditor(),\n      onDeactivate: () => this.unmountEditor()\n    });\n    this.subConfigValue('cropPreset', cropPreset => {\n      if (this._instance && this._instance.getAttribute('crop-preset') !== cropPreset) {\n        this._instance.setAttribute('crop-preset', cropPreset);\n      }\n    });\n    this.subConfigValue('cloudImageEditorTabs', tabs => {\n      if (this._instance && this._instance.getAttribute('tabs') !== tabs) {\n        this._instance.setAttribute('tabs', tabs);\n      }\n    });\n  }\n\n  /** @param {CustomEvent<import('../CloudImageEditor/src/types.js').ApplyResult>} e */\n  handleApply(e) {\n    if (!this._entry) {\n      return;\n    }\n    let result = e.detail;\n    this._entry.setMultipleValues({\n      cdnUrl: result.cdnUrl,\n      cdnUrlModifiers: result.cdnUrlModifiers\n    });\n    this.modalManager.close(ActivityBlock.activities.CLOUD_IMG_EDIT);\n    this.historyBack();\n  }\n  handleCancel() {\n    this.modalManager.close(ActivityBlock.activities.CLOUD_IMG_EDIT);\n    this.historyBack();\n  }\n  mountEditor() {\n    const {\n      internalId\n    } = this.activityParams;\n    const entry = this.uploadCollection.read(internalId);\n    if (!entry) {\n      throw new Error(`Entry with internalId \"${internalId}\" not found`);\n    }\n    this._entry = entry;\n    const cdnUrl = this._entry.getValue('cdnUrl');\n    if (!cdnUrl) {\n      throw new Error(`Entry with internalId \"${internalId}\" hasn't uploaded yet`);\n    }\n    const instance = new CloudImageEditorBlock();\n    const cropPreset = this.cfg.cropPreset;\n    const tabs = this.cfg.cloudImageEditorTabs;\n    instance.setAttribute('ctx-name', this.ctxName);\n    instance.setAttribute('cdn-url', cdnUrl);\n    if (cropPreset) {\n      instance.setAttribute('crop-preset', cropPreset);\n    }\n    if (tabs) {\n      instance.setAttribute('tabs', tabs);\n    }\n    instance.addEventListener('apply', e => {\n      const customEvent = /** @type {CustomEvent<import('../CloudImageEditor/src/types.js').ApplyResult>} */e;\n      this.handleApply(customEvent);\n      this.debugPrint(`editor event \"apply\"`, customEvent.detail);\n    });\n    instance.addEventListener('cancel', e => {\n      const customEvent = /** @type {CustomEvent<void>} */e;\n      this.handleCancel();\n      this.debugPrint(`editor event \"cancel\"`, customEvent.detail);\n    });\n    instance.addEventListener('change', e => {\n      const customEvent = /** @type {CustomEvent<import('../CloudImageEditor/src/types.js').ChangeResult>} */e;\n      this.debugPrint(`editor event \"change\"`, customEvent.detail);\n    });\n    this.innerHTML = '';\n    this.appendChild(instance);\n    this._instance = instance;\n  }\n  unmountEditor() {\n    this._instance = undefined;\n    this._entry = undefined;\n    this.innerHTML = '';\n  }\n}","map":{"version":3,"names":["ActivityBlock","UploaderBlock","CloudImageEditorBlock","CloudImageEditorActivity","couldBeCtxOwner","activityType","activities","CLOUD_IMG_EDIT","_entry","_instance","activityParams","params","Error","initCallback","registerActivity","onActivate","mountEditor","onDeactivate","unmountEditor","subConfigValue","cropPreset","getAttribute","setAttribute","tabs","handleApply","e","result","detail","setMultipleValues","cdnUrl","cdnUrlModifiers","modalManager","close","historyBack","handleCancel","internalId","entry","uploadCollection","read","getValue","instance","cfg","cloudImageEditorTabs","ctxName","addEventListener","customEvent","debugPrint","innerHTML","appendChild","undefined"],"sources":["/Users/kavinth/Documents/GitHub/Smart-Alert/Smart-Alert-new/frontend/node_modules/@uploadcare/file-uploader/blocks/CloudImageEditorActivity/CloudImageEditorActivity.js"],"sourcesContent":["// @ts-check\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { CloudImageEditorBlock } from '../CloudImageEditor/index.js';\n\n/** @typedef {{ internalId: string }} ActivityParams */\n\nexport class CloudImageEditorActivity extends UploaderBlock {\n  couldBeCtxOwner = true;\n  activityType = ActivityBlock.activities.CLOUD_IMG_EDIT;\n\n  /**\n   * @private\n   * @type {import('../../abstract/TypedData.js').TypedData<\n   *       import('../../abstract/uploadEntrySchema.js').uploadEntrySchema\n   *     >\n   *   | undefined}\n   */\n  _entry;\n\n  /**\n   * @private\n   * @type {CloudImageEditorBlock | undefined}\n   */\n  _instance;\n\n  /** @type {ActivityParams} */\n  get activityParams() {\n    const params = super.activityParams;\n    if ('internalId' in params) {\n      return params;\n    }\n    throw new Error(`Cloud Image Editor activity params not found`);\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this.registerActivity(this.activityType, {\n      onActivate: () => this.mountEditor(),\n      onDeactivate: () => this.unmountEditor(),\n    });\n\n    this.subConfigValue('cropPreset', (cropPreset) => {\n      if (this._instance && this._instance.getAttribute('crop-preset') !== cropPreset) {\n        this._instance.setAttribute('crop-preset', cropPreset);\n      }\n    });\n\n    this.subConfigValue('cloudImageEditorTabs', (tabs) => {\n      if (this._instance && this._instance.getAttribute('tabs') !== tabs) {\n        this._instance.setAttribute('tabs', tabs);\n      }\n    });\n  }\n\n  /** @param {CustomEvent<import('../CloudImageEditor/src/types.js').ApplyResult>} e */\n  handleApply(e) {\n    if (!this._entry) {\n      return;\n    }\n    let result = e.detail;\n    this._entry.setMultipleValues({\n      cdnUrl: result.cdnUrl,\n      cdnUrlModifiers: result.cdnUrlModifiers,\n    });\n    this.modalManager.close(ActivityBlock.activities.CLOUD_IMG_EDIT);\n    this.historyBack();\n  }\n\n  handleCancel() {\n    this.modalManager.close(ActivityBlock.activities.CLOUD_IMG_EDIT);\n    this.historyBack();\n  }\n\n  mountEditor() {\n    const { internalId } = this.activityParams;\n    const entry = this.uploadCollection.read(internalId);\n    if (!entry) {\n      throw new Error(`Entry with internalId \"${internalId}\" not found`);\n    }\n    this._entry = entry;\n    const cdnUrl = this._entry.getValue('cdnUrl');\n    if (!cdnUrl) {\n      throw new Error(`Entry with internalId \"${internalId}\" hasn't uploaded yet`);\n    }\n\n    const instance = new CloudImageEditorBlock();\n    const cropPreset = this.cfg.cropPreset;\n    const tabs = this.cfg.cloudImageEditorTabs;\n\n    instance.setAttribute('ctx-name', this.ctxName);\n    instance.setAttribute('cdn-url', cdnUrl);\n\n    if (cropPreset) {\n      instance.setAttribute('crop-preset', cropPreset);\n    }\n    if (tabs) {\n      instance.setAttribute('tabs', tabs);\n    }\n\n    instance.addEventListener('apply', (e) => {\n      const customEvent = /** @type {CustomEvent<import('../CloudImageEditor/src/types.js').ApplyResult>} */ (e);\n      this.handleApply(customEvent);\n      this.debugPrint(`editor event \"apply\"`, customEvent.detail);\n    });\n    instance.addEventListener('cancel', (e) => {\n      const customEvent = /** @type {CustomEvent<void>} */ (e);\n      this.handleCancel();\n      this.debugPrint(`editor event \"cancel\"`, customEvent.detail);\n    });\n    instance.addEventListener('change', (e) => {\n      const customEvent = /** @type {CustomEvent<import('../CloudImageEditor/src/types.js').ChangeResult>} */ (e);\n      this.debugPrint(`editor event \"change\"`, customEvent.detail);\n    });\n\n    this.innerHTML = '';\n    this.appendChild(instance);\n\n    this._instance = instance;\n  }\n\n  unmountEditor() {\n    this._instance = undefined;\n    this._entry = undefined;\n    this.innerHTML = '';\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
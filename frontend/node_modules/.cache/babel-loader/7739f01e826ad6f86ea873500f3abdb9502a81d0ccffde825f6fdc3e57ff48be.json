{"ast":null,"code":"//@ts-check\n\nexport const ModalEvents = Object.freeze({\n  ADD: 'modal:add',\n  DELETE: 'modal:delete',\n  OPEN: 'modal:open',\n  CLOSE: 'modal:close',\n  CLOSE_ALL: 'modal:closeAll',\n  DESTROY: 'modal:destroy'\n});\n\n/** @typedef {import('../abstract/ActivityBlock').ActivityType} ModalId */\n\n/** @typedef {import('../blocks/Modal/Modal.js').Modal} ModalNode */\n\n/** @typedef {(data: { id: ModalId; modal: ModalNode }) => void} ModalCb */\n\n/** @typedef {(typeof ModalEvents)[keyof ModalEvents]} ModalEventType */\n\nexport class ModalManager {\n  /**\n   * @private\n   * @type {Map<ModalId, ModalNode>}\n   */\n  _modals = new Map();\n\n  /**\n   * @private\n   * @type {Set<ModalId>}\n   */\n  _activeModals = new Set();\n\n  /**\n   * @private\n   * @type {Map<ModalEventType, Set<ModalCb>>}\n   */\n  _subscribers = new Map();\n\n  /** @param {import('./Block.js').Block} block */\n  constructor(block) {\n    this._block = block;\n  }\n\n  /**\n   * @private\n   * @param {unknown[]} args\n   */\n  _debugPrint(...args) {\n    this._block.debugPrint('[modal-manager]', ...args);\n  }\n\n  /**\n   * Register a modal with the manager\n   *\n   * @param {ModalId} id - Unique identifier for the modal\n   * @param {ModalNode} modal - Modal component instance\n   */\n  registerModal(id, modal) {\n    this._modals.set(id, modal);\n    this._notify(ModalEvents.ADD, {\n      id,\n      modal\n    });\n  }\n\n  /** @param {ModalId} id - Unique identifier for the modal */\n  deleteModal(id) {\n    if (!this._modals.has(id)) return false;\n    const modal = this._modals.get(id);\n    this._modals.delete(id);\n    this._activeModals.delete(id);\n    this._notify(ModalEvents.DELETE, {\n      id,\n      modal\n    });\n    return true;\n  }\n\n  /**\n   * Open a modal by its ID\n   *\n   * @param {ModalId} id - The ID of the modal to open\n   * @returns {boolean} - Success status\n   */\n  open(id) {\n    if (!this._modals.has(id)) {\n      this._debugPrint(`Modal with ID \"${id}\" not found`);\n      return false;\n    }\n    const modal = this._modals.get(id);\n    this._activeModals.add(id);\n    this._notify(ModalEvents.OPEN, {\n      modal,\n      id\n    });\n    return true;\n  }\n\n  /**\n   * Close a specific modal by ID\n   *\n   * @param {ModalId} id - The ID of the modal to close\n   * @returns {boolean} - Success status\n   */\n  close(id) {\n    if (!this._modals.has(id) || !this._activeModals.has(id)) {\n      this._debugPrint(`Modal with ID \"${id}\" not found or not active`);\n      return false;\n    }\n    const modal = this._modals.get(id);\n    this._activeModals.delete(id);\n    this._notify(ModalEvents.CLOSE, {\n      id,\n      modal\n    });\n    return true;\n  }\n\n  /**\n   * Toggle a modal - open if closed, close if open\n   *\n   * @param {ModalId} id - The ID of the modal to toggle\n   * @returns {boolean} - Success status\n   */\n  toggle(id) {\n    if (!this._modals.has(id)) {\n      this._debugPrint(`Modal with ID \"${id}\" not found`);\n      return false;\n    }\n    if (this._activeModals.has(id)) {\n      return this.close(id);\n    } else {\n      return this.open(id);\n    }\n  }\n\n  /**\n   * Check if any modals are currently active/open\n   *\n   * @returns {boolean} - True if there are any active modals\n   */\n  get hasActiveModals() {\n    return this._activeModals.size > 0;\n  }\n\n  /**\n   * Close the most recently opened modal and return to the previous one\n   *\n   * @returns {boolean} - Success status\n   */\n  back() {\n    if (this._activeModals.size === 0) {\n      this._debugPrint('No active modals to go back from');\n      return false;\n    }\n\n    // Get the last opened modal\n    const lastModalId = Array.from(this._activeModals).pop();\n    return this.close(/** @type {string} */lastModalId);\n  }\n\n  /**\n   * Close all open modals\n   *\n   * @returns {number} - Number of modals closed\n   */\n  closeAll() {\n    const count = this._activeModals.size;\n    this._activeModals.clear();\n    this._notify(ModalEvents.CLOSE_ALL, {});\n    return count;\n  }\n\n  /**\n   * Subscribe to modal events\n   *\n   * @param {ModalEventType} event\n   * @param {ModalCb} callback\n   * @returns {() => void}\n   */\n  subscribe(event, callback) {\n    if (!this._subscribers.has(event)) {\n      this._subscribers.set(event, new Set());\n    }\n    this._subscribers.get(event)?.add(callback);\n    return () => this.unsubscribe(event, callback);\n  }\n\n  /**\n   * Unsubscribe from modal events\n   *\n   * @param {ModalEventType} event\n   * @param {ModalCb | undefined} callback\n   */\n  unsubscribe(event, callback) {\n    if (this._subscribers.has(event)) {\n      this._subscribers.get(event)?.delete(/** @type {ModalCb} */callback);\n    }\n  }\n\n  /**\n   * Notify all subscribers of a modal event\n   *\n   * @private\n   * @param {ModalEventType} event - Event name\n   * @param {{\n   *       id: ModalId;\n   *       modal: ModalNode;\n   *     }\n   *   | object} data\n   */\n  _notify(event, data) {\n    if (this._subscribers.has(event)) {\n      for (const callback of this._subscribers.get(event) ?? new Set()) {\n        try {\n          callback(\n          /**\n           * @type{{\n           * id: ModalId;\n           * modal: ModalNode;\n           * }}\n           */\n          data);\n        } catch (error) {\n          this._debugPrint('Error in modal subscriber:', error);\n        }\n      }\n    }\n  }\n\n  /** Destroy the modal manager, clean up resources */\n  destroy() {\n    this.closeAll();\n    this._modals.clear();\n    this._subscribers.clear();\n    this._notify(ModalEvents.DESTROY, {});\n  }\n}","map":{"version":3,"names":["ModalEvents","Object","freeze","ADD","DELETE","OPEN","CLOSE","CLOSE_ALL","DESTROY","ModalManager","_modals","Map","_activeModals","Set","_subscribers","constructor","block","_block","_debugPrint","args","debugPrint","registerModal","id","modal","set","_notify","deleteModal","has","get","delete","open","add","close","toggle","hasActiveModals","size","back","lastModalId","Array","from","pop","closeAll","count","clear","subscribe","event","callback","unsubscribe","data","error","destroy"],"sources":["/Users/kavinth/Documents/GitHub/Smart-Alert/Smart-Alert-new/frontend/node_modules/@uploadcare/file-uploader/abstract/ModalManager.js"],"sourcesContent":["//@ts-check\n\nexport const ModalEvents = Object.freeze({\n  ADD: 'modal:add',\n  DELETE: 'modal:delete',\n  OPEN: 'modal:open',\n  CLOSE: 'modal:close',\n  CLOSE_ALL: 'modal:closeAll',\n  DESTROY: 'modal:destroy',\n});\n\n/** @typedef {import('../abstract/ActivityBlock').ActivityType} ModalId */\n\n/** @typedef {import('../blocks/Modal/Modal.js').Modal} ModalNode */\n\n/** @typedef {(data: { id: ModalId; modal: ModalNode }) => void} ModalCb */\n\n/** @typedef {(typeof ModalEvents)[keyof ModalEvents]} ModalEventType */\n\nexport class ModalManager {\n  /**\n   * @private\n   * @type {Map<ModalId, ModalNode>}\n   */\n  _modals = new Map();\n\n  /**\n   * @private\n   * @type {Set<ModalId>}\n   */\n  _activeModals = new Set();\n\n  /**\n   * @private\n   * @type {Map<ModalEventType, Set<ModalCb>>}\n   */\n  _subscribers = new Map();\n\n  /** @param {import('./Block.js').Block} block */\n  constructor(block) {\n    this._block = block;\n  }\n\n  /**\n   * @private\n   * @param {unknown[]} args\n   */\n  _debugPrint(...args) {\n    this._block.debugPrint('[modal-manager]', ...args);\n  }\n\n  /**\n   * Register a modal with the manager\n   *\n   * @param {ModalId} id - Unique identifier for the modal\n   * @param {ModalNode} modal - Modal component instance\n   */\n  registerModal(id, modal) {\n    this._modals.set(id, modal);\n    this._notify(ModalEvents.ADD, { id, modal });\n  }\n\n  /** @param {ModalId} id - Unique identifier for the modal */\n  deleteModal(id) {\n    if (!this._modals.has(id)) return false;\n\n    const modal = this._modals.get(id);\n    this._modals.delete(id);\n    this._activeModals.delete(id);\n    this._notify(ModalEvents.DELETE, { id, modal });\n    return true;\n  }\n\n  /**\n   * Open a modal by its ID\n   *\n   * @param {ModalId} id - The ID of the modal to open\n   * @returns {boolean} - Success status\n   */\n  open(id) {\n    if (!this._modals.has(id)) {\n      this._debugPrint(`Modal with ID \"${id}\" not found`);\n      return false;\n    }\n\n    const modal = this._modals.get(id);\n\n    this._activeModals.add(id);\n    this._notify(ModalEvents.OPEN, { modal, id });\n    return true;\n  }\n\n  /**\n   * Close a specific modal by ID\n   *\n   * @param {ModalId} id - The ID of the modal to close\n   * @returns {boolean} - Success status\n   */\n  close(id) {\n    if (!this._modals.has(id) || !this._activeModals.has(id)) {\n      this._debugPrint(`Modal with ID \"${id}\" not found or not active`);\n      return false;\n    }\n\n    const modal = this._modals.get(id);\n\n    this._activeModals.delete(id);\n    this._notify(ModalEvents.CLOSE, { id, modal });\n    return true;\n  }\n\n  /**\n   * Toggle a modal - open if closed, close if open\n   *\n   * @param {ModalId} id - The ID of the modal to toggle\n   * @returns {boolean} - Success status\n   */\n  toggle(id) {\n    if (!this._modals.has(id)) {\n      this._debugPrint(`Modal with ID \"${id}\" not found`);\n      return false;\n    }\n\n    if (this._activeModals.has(id)) {\n      return this.close(id);\n    } else {\n      return this.open(id);\n    }\n  }\n\n  /**\n   * Check if any modals are currently active/open\n   *\n   * @returns {boolean} - True if there are any active modals\n   */\n  get hasActiveModals() {\n    return this._activeModals.size > 0;\n  }\n\n  /**\n   * Close the most recently opened modal and return to the previous one\n   *\n   * @returns {boolean} - Success status\n   */\n  back() {\n    if (this._activeModals.size === 0) {\n      this._debugPrint('No active modals to go back from');\n      return false;\n    }\n\n    // Get the last opened modal\n    const lastModalId = Array.from(this._activeModals).pop();\n    return this.close(/** @type {string} */ (lastModalId));\n  }\n\n  /**\n   * Close all open modals\n   *\n   * @returns {number} - Number of modals closed\n   */\n  closeAll() {\n    const count = this._activeModals.size;\n\n    this._activeModals.clear();\n    this._notify(ModalEvents.CLOSE_ALL, {});\n    return count;\n  }\n\n  /**\n   * Subscribe to modal events\n   *\n   * @param {ModalEventType} event\n   * @param {ModalCb} callback\n   * @returns {() => void}\n   */\n  subscribe(event, callback) {\n    if (!this._subscribers.has(event)) {\n      this._subscribers.set(event, new Set());\n    }\n    this._subscribers.get(event)?.add(callback);\n\n    return () => this.unsubscribe(event, callback);\n  }\n\n  /**\n   * Unsubscribe from modal events\n   *\n   * @param {ModalEventType} event\n   * @param {ModalCb | undefined} callback\n   */\n  unsubscribe(event, callback) {\n    if (this._subscribers.has(event)) {\n      this._subscribers.get(event)?.delete(/** @type {ModalCb} */ (callback));\n    }\n  }\n\n  /**\n   * Notify all subscribers of a modal event\n   *\n   * @private\n   * @param {ModalEventType} event - Event name\n   * @param {{\n   *       id: ModalId;\n   *       modal: ModalNode;\n   *     }\n   *   | object} data\n   */\n  _notify(event, data) {\n    if (this._subscribers.has(event)) {\n      for (const callback of this._subscribers.get(event) ?? new Set()) {\n        try {\n          callback(\n            /**\n             * @type{{\n             * id: ModalId;\n             * modal: ModalNode;\n             * }}\n             */ (data),\n          );\n        } catch (error) {\n          this._debugPrint('Error in modal subscriber:', error);\n        }\n      }\n    }\n  }\n\n  /** Destroy the modal manager, clean up resources */\n  destroy() {\n    this.closeAll();\n    this._modals.clear();\n    this._subscribers.clear();\n    this._notify(ModalEvents.DESTROY, {});\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
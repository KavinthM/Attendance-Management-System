{"ast":null,"code":"var _jsxFileName = \"/Users/kavinth/Documents/GitHub/Smart-Alert/Smart-Alert-new/frontend/src/pages/AddStudent.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport Layout from \"../Components/Layout\";\nimport StudentForm from \"../Components/StudentForm\";\nimport { addStudent, getNextStudentIndex } from \"../api/client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AddStudent = () => {\n  _s();\n  const navigate = useNavigate();\n  const [adding, setAdding] = useState(false);\n  const [nextIndex, setNextIndex] = useState(\"\");\n  const userRole = localStorage.getItem(\"userRole\");\n  React.useEffect(() => {\n    if (userRole === \"Teacher\") {\n      navigate(\"/students\");\n    } else if (userRole === \"Parent\") {\n      navigate(\"/parent-view\");\n    }\n  }, [userRole, navigate]);\n  React.useEffect(() => {\n    getNextStudentIndex().then(({\n      data\n    }) => setNextIndex(data.nextIndex)).catch(console.error);\n  }, []);\n  const handleAdd = async (payload, reset) => {\n    setAdding(true);\n    try {\n      await addStudent(payload);\n      // Ensure we navigate back to list to see the update\n      navigate(\"/students\");\n      return {\n        status: \"success\"\n      };\n    } catch (e) {\n      var _e$response, _e$response2, _e$response2$data;\n      const status = e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : _e$response.status;\n      const msg = (e === null || e === void 0 ? void 0 : (_e$response2 = e.response) === null || _e$response2 === void 0 ? void 0 : (_e$response2$data = _e$response2.data) === null || _e$response2$data === void 0 ? void 0 : _e$response2$data.message) || \"Failed to add student\";\n      if (status === 409) {\n        if (msg.includes(\"email\")) {\n          return {\n            status: \"error\",\n            code: \"DUPLICATE\",\n            field: \"email\",\n            message: msg\n          };\n        }\n        if (msg.includes(\"phone\")) {\n          return {\n            status: \"error\",\n            code: \"DUPLICATE\",\n            field: \"parentPhoneNum\",\n            message: msg\n          };\n        }\n      }\n      alert(msg);\n      return {\n        status: \"error\",\n        code: \"OTHER\",\n        message: msg\n      };\n    } finally {\n      setAdding(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-4xl mx-auto\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"text-3xl font-bold text-slate-900\",\n            children: \"Register Student\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 58,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-slate-500 mt-1\",\n            children: \"Add a new student to the system\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 59,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/students\",\n          className: \"btn-secondary self-start md:self-auto\",\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fa-solid fa-arrow-left mr-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 62,\n            columnNumber: 25\n          }, this), \" Back to List\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(StudentForm, {\n        onSubmit: handleAdd,\n        submitting: adding,\n        nextIndex: nextIndex\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 9\n  }, this);\n};\n_s(AddStudent, \"uPxk7fFQIRUhsa0Crn53+u8Kdak=\", false, function () {\n  return [useNavigate];\n});\n_c = AddStudent;\nexport default AddStudent;\nvar _c;\n$RefreshReg$(_c, \"AddStudent\");","map":{"version":3,"names":["React","useState","Link","useNavigate","Layout","StudentForm","addStudent","getNextStudentIndex","jsxDEV","_jsxDEV","AddStudent","_s","navigate","adding","setAdding","nextIndex","setNextIndex","userRole","localStorage","getItem","useEffect","then","data","catch","console","error","handleAdd","payload","reset","status","e","_e$response","_e$response2","_e$response2$data","response","msg","message","includes","code","field","alert","children","className","fileName","_jsxFileName","lineNumber","columnNumber","to","onSubmit","submitting","_c","$RefreshReg$"],"sources":["/Users/kavinth/Documents/GitHub/Smart-Alert/Smart-Alert-new/frontend/src/pages/AddStudent.jsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport Layout from \"../Components/Layout\";\nimport StudentForm from \"../Components/StudentForm\";\nimport { addStudent, getNextStudentIndex } from \"../api/client\";\n\nconst AddStudent = () => {\n    const navigate = useNavigate();\n    const [adding, setAdding] = useState(false);\n    const [nextIndex, setNextIndex] = useState(\"\");\n\n    const userRole = localStorage.getItem(\"userRole\");\n\n    React.useEffect(() => {\n        if (userRole === \"Teacher\") {\n            navigate(\"/students\");\n        } else if (userRole === \"Parent\") {\n            navigate(\"/parent-view\");\n        }\n    }, [userRole, navigate]);\n\n    React.useEffect(() => {\n        getNextStudentIndex().then(({ data }) => setNextIndex(data.nextIndex)).catch(console.error);\n    }, []);\n\n    const handleAdd = async (payload, reset) => {\n        setAdding(true);\n        try {\n            await addStudent(payload);\n            // Ensure we navigate back to list to see the update\n            navigate(\"/students\");\n            return { status: \"success\" };\n        } catch (e) {\n            const status = e?.response?.status;\n            const msg = e?.response?.data?.message || \"Failed to add student\";\n\n            if (status === 409) {\n                if (msg.includes(\"email\")) {\n                    return { status: \"error\", code: \"DUPLICATE\", field: \"email\", message: msg };\n                }\n                if (msg.includes(\"phone\")) {\n                    return { status: \"error\", code: \"DUPLICATE\", field: \"parentPhoneNum\", message: msg };\n                }\n            }\n\n            alert(msg);\n            return { status: \"error\", code: \"OTHER\", message: msg };\n        } finally {\n            setAdding(false);\n        }\n    };\n\n    return (\n        <Layout>\n            <div className=\"max-w-4xl mx-auto\">\n                <div className=\"mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4\">\n                    <div>\n                        <h1 className=\"text-3xl font-bold text-slate-900\">Register Student</h1>\n                        <p className=\"text-slate-500 mt-1\">Add a new student to the system</p>\n                    </div>\n                    <Link to=\"/students\" className=\"btn-secondary self-start md:self-auto\">\n                        <i className=\"fa-solid fa-arrow-left mr-2\"></i> Back to List\n                    </Link>\n                </div>\n\n                <StudentForm onSubmit={handleAdd} submitting={adding} nextIndex={nextIndex} />\n            </div>\n        </Layout>\n    );\n};\n\nexport default AddStudent;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
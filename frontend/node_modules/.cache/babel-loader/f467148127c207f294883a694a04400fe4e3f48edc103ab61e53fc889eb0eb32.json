{"ast":null,"code":"// @ts-check\n\nimport { createCdnUrl, createCdnUrlModifiers } from '../../../utils/cdn-utils.js';\nimport { TRANSPARENT_PIXEL_SRC } from '../../../utils/transparentPixelSrc.js';\nimport { serializeCsv } from '../../utils/comma-separated.js';\nimport { transformationsToOperations } from './lib/transformationUtils.js';\nimport { ALL_TABS, TabId } from './toolbar-constants.js';\n\n/** @param {import('./CloudImageEditorBlock.js').CloudImageEditorBlock} fnCtx */\nexport function initState(fnCtx) {\n  return {\n    '*originalUrl': null,\n    '*faderEl': null,\n    '*cropperEl': null,\n    '*imgEl': null,\n    '*imgContainerEl': null,\n    '*networkProblems': false,\n    '*imageSize': null,\n    /** @type {import('./types.js').Transformations} */\n    '*editorTransformations': {},\n    /** @type {import('./types.js').CropPresetList} */\n    '*cropPresetList': [],\n    '*tabList': ALL_TABS,\n    '*tabId': TabId.CROP,\n    entry: null,\n    extension: null,\n    editorMode: false,\n    modalCaption: '',\n    isImage: false,\n    msg: '',\n    src: TRANSPARENT_PIXEL_SRC,\n    fileType: '',\n    showLoader: false,\n    // options\n    uuid: null,\n    cdnUrl: null,\n    cropPreset: '',\n    tabs: serializeCsv(ALL_TABS),\n    'presence.networkProblems': false,\n    'presence.modalCaption': true,\n    'presence.editorToolbar': false,\n    'presence.viewerToolbar': true,\n    // TODO: beware of wrong ctx in case of element re-creation:\n    '*on.retryNetwork': () => {\n      let images = fnCtx.querySelectorAll('img');\n      for (let img of images) {\n        let originalSrc = img.src;\n        img.src = TRANSPARENT_PIXEL_SRC;\n        img.src = originalSrc;\n      }\n      fnCtx.$['*networkProblems'] = false;\n    },\n    /** @param {import('./types.js').Transformations} transformations */\n    '*on.apply': transformations => {\n      if (!transformations) {\n        return;\n      }\n      let originalUrl = fnCtx.$['*originalUrl'];\n      let cdnUrlModifiers = createCdnUrlModifiers(transformationsToOperations(transformations), 'preview');\n      let cdnUrl = createCdnUrl(originalUrl, cdnUrlModifiers);\n\n      /** @type {import('./types.js').ApplyResult} */\n      let eventData = {\n        originalUrl,\n        cdnUrlModifiers,\n        cdnUrl,\n        transformations\n      };\n      fnCtx.dispatchEvent(new CustomEvent('apply', {\n        detail: eventData,\n        bubbles: true,\n        composed: true\n      }));\n      fnCtx.remove();\n    },\n    '*on.cancel': () => {\n      fnCtx.remove();\n      fnCtx.dispatchEvent(new CustomEvent('cancel', {\n        bubbles: true,\n        composed: true\n      }));\n    }\n  };\n}","map":{"version":3,"names":["createCdnUrl","createCdnUrlModifiers","TRANSPARENT_PIXEL_SRC","serializeCsv","transformationsToOperations","ALL_TABS","TabId","initState","fnCtx","CROP","entry","extension","editorMode","modalCaption","isImage","msg","src","fileType","showLoader","uuid","cdnUrl","cropPreset","tabs","*on.retryNetwork","images","querySelectorAll","img","originalSrc","$","transformations","originalUrl","cdnUrlModifiers","eventData","dispatchEvent","CustomEvent","detail","bubbles","composed","remove","*on.cancel"],"sources":["/Users/kavinth/Documents/GitHub/Smart-Alert/Smart-Alert-new/frontend/node_modules/@uploadcare/file-uploader/blocks/CloudImageEditor/src/state.js"],"sourcesContent":["// @ts-check\n\nimport { createCdnUrl, createCdnUrlModifiers } from '../../../utils/cdn-utils.js';\nimport { TRANSPARENT_PIXEL_SRC } from '../../../utils/transparentPixelSrc.js';\nimport { serializeCsv } from '../../utils/comma-separated.js';\nimport { transformationsToOperations } from './lib/transformationUtils.js';\nimport { ALL_TABS, TabId } from './toolbar-constants.js';\n\n/** @param {import('./CloudImageEditorBlock.js').CloudImageEditorBlock} fnCtx */\nexport function initState(fnCtx) {\n  return {\n    '*originalUrl': null,\n    '*faderEl': null,\n    '*cropperEl': null,\n    '*imgEl': null,\n    '*imgContainerEl': null,\n    '*networkProblems': false,\n    '*imageSize': null,\n    /** @type {import('./types.js').Transformations} */\n    '*editorTransformations': {},\n    /** @type {import('./types.js').CropPresetList} */\n    '*cropPresetList': [],\n    '*tabList': ALL_TABS,\n    '*tabId': TabId.CROP,\n\n    entry: null,\n    extension: null,\n    editorMode: false,\n    modalCaption: '',\n    isImage: false,\n    msg: '',\n    src: TRANSPARENT_PIXEL_SRC,\n    fileType: '',\n    showLoader: false,\n\n    // options\n    uuid: null,\n    cdnUrl: null,\n    cropPreset: '',\n    tabs: serializeCsv(ALL_TABS),\n\n    'presence.networkProblems': false,\n    'presence.modalCaption': true,\n    'presence.editorToolbar': false,\n    'presence.viewerToolbar': true,\n    // TODO: beware of wrong ctx in case of element re-creation:\n    '*on.retryNetwork': () => {\n      let images = fnCtx.querySelectorAll('img');\n      for (let img of images) {\n        let originalSrc = img.src;\n        img.src = TRANSPARENT_PIXEL_SRC;\n        img.src = originalSrc;\n      }\n      fnCtx.$['*networkProblems'] = false;\n    },\n    /** @param {import('./types.js').Transformations} transformations */\n    '*on.apply': (transformations) => {\n      if (!transformations) {\n        return;\n      }\n      let originalUrl = fnCtx.$['*originalUrl'];\n      let cdnUrlModifiers = createCdnUrlModifiers(transformationsToOperations(transformations), 'preview');\n      let cdnUrl = createCdnUrl(originalUrl, cdnUrlModifiers);\n\n      /** @type {import('./types.js').ApplyResult} */\n      let eventData = {\n        originalUrl,\n        cdnUrlModifiers,\n        cdnUrl,\n        transformations,\n      };\n      fnCtx.dispatchEvent(\n        new CustomEvent('apply', {\n          detail: eventData,\n          bubbles: true,\n          composed: true,\n        }),\n      );\n      fnCtx.remove();\n    },\n    '*on.cancel': () => {\n      fnCtx.remove();\n\n      fnCtx.dispatchEvent(\n        new CustomEvent('cancel', {\n          bubbles: true,\n          composed: true,\n        }),\n      );\n    },\n  };\n}\n"],"mappings":"AAAA;;AAEA,SAASA,YAAY,EAAEC,qBAAqB,QAAQ,6BAA6B;AACjF,SAASC,qBAAqB,QAAQ,uCAAuC;AAC7E,SAASC,YAAY,QAAQ,gCAAgC;AAC7D,SAASC,2BAA2B,QAAQ,8BAA8B;AAC1E,SAASC,QAAQ,EAAEC,KAAK,QAAQ,wBAAwB;;AAExD;AACA,OAAO,SAASC,SAASA,CAACC,KAAK,EAAE;EAC/B,OAAO;IACL,cAAc,EAAE,IAAI;IACpB,UAAU,EAAE,IAAI;IAChB,YAAY,EAAE,IAAI;IAClB,QAAQ,EAAE,IAAI;IACd,iBAAiB,EAAE,IAAI;IACvB,kBAAkB,EAAE,KAAK;IACzB,YAAY,EAAE,IAAI;IAClB;IACA,wBAAwB,EAAE,CAAC,CAAC;IAC5B;IACA,iBAAiB,EAAE,EAAE;IACrB,UAAU,EAAEH,QAAQ;IACpB,QAAQ,EAAEC,KAAK,CAACG,IAAI;IAEpBC,KAAK,EAAE,IAAI;IACXC,SAAS,EAAE,IAAI;IACfC,UAAU,EAAE,KAAK;IACjBC,YAAY,EAAE,EAAE;IAChBC,OAAO,EAAE,KAAK;IACdC,GAAG,EAAE,EAAE;IACPC,GAAG,EAAEd,qBAAqB;IAC1Be,QAAQ,EAAE,EAAE;IACZC,UAAU,EAAE,KAAK;IAEjB;IACAC,IAAI,EAAE,IAAI;IACVC,MAAM,EAAE,IAAI;IACZC,UAAU,EAAE,EAAE;IACdC,IAAI,EAAEnB,YAAY,CAACE,QAAQ,CAAC;IAE5B,0BAA0B,EAAE,KAAK;IACjC,uBAAuB,EAAE,IAAI;IAC7B,wBAAwB,EAAE,KAAK;IAC/B,wBAAwB,EAAE,IAAI;IAC9B;IACA,kBAAkB,EAAEkB,CAAA,KAAM;MACxB,IAAIC,MAAM,GAAGhB,KAAK,CAACiB,gBAAgB,CAAC,KAAK,CAAC;MAC1C,KAAK,IAAIC,GAAG,IAAIF,MAAM,EAAE;QACtB,IAAIG,WAAW,GAAGD,GAAG,CAACV,GAAG;QACzBU,GAAG,CAACV,GAAG,GAAGd,qBAAqB;QAC/BwB,GAAG,CAACV,GAAG,GAAGW,WAAW;MACvB;MACAnB,KAAK,CAACoB,CAAC,CAAC,kBAAkB,CAAC,GAAG,KAAK;IACrC,CAAC;IACD;IACA,WAAW,EAAGC,eAAe,IAAK;MAChC,IAAI,CAACA,eAAe,EAAE;QACpB;MACF;MACA,IAAIC,WAAW,GAAGtB,KAAK,CAACoB,CAAC,CAAC,cAAc,CAAC;MACzC,IAAIG,eAAe,GAAG9B,qBAAqB,CAACG,2BAA2B,CAACyB,eAAe,CAAC,EAAE,SAAS,CAAC;MACpG,IAAIT,MAAM,GAAGpB,YAAY,CAAC8B,WAAW,EAAEC,eAAe,CAAC;;MAEvD;MACA,IAAIC,SAAS,GAAG;QACdF,WAAW;QACXC,eAAe;QACfX,MAAM;QACNS;MACF,CAAC;MACDrB,KAAK,CAACyB,aAAa,CACjB,IAAIC,WAAW,CAAC,OAAO,EAAE;QACvBC,MAAM,EAAEH,SAAS;QACjBI,OAAO,EAAE,IAAI;QACbC,QAAQ,EAAE;MACZ,CAAC,CACH,CAAC;MACD7B,KAAK,CAAC8B,MAAM,CAAC,CAAC;IAChB,CAAC;IACD,YAAY,EAAEC,CAAA,KAAM;MAClB/B,KAAK,CAAC8B,MAAM,CAAC,CAAC;MAEd9B,KAAK,CAACyB,aAAa,CACjB,IAAIC,WAAW,CAAC,QAAQ,EAAE;QACxBE,OAAO,EAAE,IAAI;QACbC,QAAQ,EAAE;MACZ,CAAC,CACH,CAAC;IACH;EACF,CAAC;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}